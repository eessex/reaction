{"remainingRequest":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js??ref--6-1!/Users/eve/development/reaction/src/Components/Publishing/Sections/Video.tsx","dependencies":[{"path":"/Users/eve/development/reaction/src/Components/Publishing/Sections/Video.tsx","mtime":1537795571000},{"path":"/Users/eve/development/reaction/.babelrc","mtime":1537112679000},{"path":"/Users/eve/development/reaction/node_modules/cache-loader/dist/cjs.js","mtime":0},{"path":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["var _dec, _class, _class2, _temp;\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteral([\"\\n  display: \", \";\\n  justify-content: center;\\n  align-items: center;\\n  width: 100%;\\n  height: \", \";\\n  position: absolute;\\n  background: url(\", \") no-repeat center center;\\n  background-size: cover;\\n  cursor: pointer;\\n\"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n          height: 300px;\\n          padding-bottom: 20px;\\n        \"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n          height: 450px;\\n        \"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  position: relative;\\n\\n  \", \"\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: \", \";\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from \"react\";\nimport sizeMe from \"react-sizeme\";\nimport track from \"react-tracking\";\nimport styled from \"styled-components\";\nimport urlParser from \"url\";\nimport Events from \"../../../Utils/Events\";\nimport { resize } from \"../../../Utils/resizer\";\nimport { pMedia as breakpoint } from \"../../Helpers\";\nimport { SIZE_ME_REFRESH_RATE } from \"../Constants\";\nimport { Caption } from \"./Caption\";\nimport { VideoControls } from \"./VideoControls\";\nvar BLACKLIST = [\"gif\", \"jpg\", \"jpeg\", \"png\"];\nvar QUERYSTRING = \"?title=0&portrait=0&badge=0&byline=0&showinfo=0&rel=0&controls=2&modestbranding=1&iv_load_policy=3&color=E5E5E5\";\nexport var VIDEO_RATIO = 0.5625;\nvar VideoComponent = (_dec = track(function (props) {\n  return props.trackingData ? props.trackingData : {};\n}, {\n  dispatch: function dispatch(data) {\n    return Events.postEvent(data);\n  }\n}), _dec(_class = (_temp = _class2 =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(VideoComponent, _React$Component);\n\n  function VideoComponent(props) {\n    var _this;\n\n    _classCallCheck(this, VideoComponent);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(VideoComponent).call(this, props));\n    var url = _this.props.section.url;\n    var isValid = url && isValidVideoUrl(url);\n\n    if (isValid) {\n      var parsedUrl = urlParser.parse(url, true);\n      var playerUrl = getPlayerUrl(parsedUrl);\n      var id = getId(parsedUrl);\n      var playerSrc = playerUrl + id + QUERYSTRING;\n      _this.state = {\n        src: playerSrc,\n        hidden: false\n      };\n    } else {\n      console.error(\"(@artsy/reaction) Video.tsx: A url is required for video.\", _this.props);\n      _this.state = {\n        hidden: true\n      };\n    }\n\n    _this.playVideo = _this.playVideo.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(VideoComponent, [{\n    key: \"trackVideoClick\",\n    value: function trackVideoClick() {\n      this.props.tracking.trackEvent({\n        action: \"Click\",\n        label: \"Play video\"\n      });\n    }\n  }, {\n    key: \"playVideo\",\n    value: function playVideo() {\n      var playerSrc = this.state.src + \"&autoplay=1\";\n      this.setState({\n        src: playerSrc,\n        hidden: true\n      });\n      this.trackVideoClick();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props$section = this.props.section,\n          caption = _this$props$section.caption,\n          cover_image_url = _this$props$section.cover_image_url;\n      var width = this.props.size.width;\n      var src = resize(cover_image_url, {\n        width: 1200\n      });\n      var showCaption = this.props.layout !== \"feature\";\n      return React.createElement(VideoContainer, {\n        layout: this.props.layout,\n        className: \"VideoContainer\"\n      }, cover_image_url && React.createElement(CoverImage, {\n        className: \"VideoCover\",\n        src: src,\n        height: width && width * VIDEO_RATIO,\n        onClick: this.playVideo,\n        hidden: this.state.hidden\n      }, React.createElement(VideoControls, null)), React.createElement(IFrame, {\n        src: this.state.src,\n        frameBorder: \"0\",\n        allowFullScreen: true,\n        height: width && width * VIDEO_RATIO\n      }), showCaption && React.createElement(Caption, {\n        caption: caption,\n        layout: this.props.layout\n      }, this.props.children));\n    }\n  }]);\n\n  return VideoComponent;\n}(React.Component), _defineProperty(_class2, \"defaultProps\", {\n  size: {\n    width: 500\n  },\n  tracking: {\n    trackEvent: function trackEvent(x) {\n      return x;\n    }\n  }\n}), _temp)) || _class); // Utils\n\nexport function isValidVideoUrl(url) {\n  var urlExtension = url && url.split(\".\").pop();\n  var isValid = BLACKLIST.every(function (bad) {\n    return urlExtension !== bad;\n  });\n  return isValid;\n}\nexport function getPlayerUrl(url) {\n  var hostname = url.hostname;\n\n  if (hostname) {\n    if (hostname.indexOf(\"vimeo.com\") > -1) {\n      return \"https://player.vimeo.com/video/\";\n    } else if (hostname.indexOf(\"youtu\") > -1) {\n      return \"https://www.youtube.com/embed/\";\n    }\n  } else {\n    return \"\"; // FIXME: check for errors\n  }\n}\n\nfunction getId(url) {\n  var hostname = url.hostname,\n      pathname = url.pathname;\n\n  if (hostname && pathname) {\n    if (url.hostname.indexOf(\"youtube.com\") > 0) {\n      return url.query.v;\n    } else {\n      return url.pathname.split(\"/\").pop();\n    }\n  } else {\n    return \"\"; // FIXME: error\n  }\n} // Styles\n\n\nvar iframe = styled.iframe;\nexport var IFrame = iframe(_templateObject(), function (props) {\n  return props.height ? \"\".concat(props.height, \"px\") : \"100%\";\n});\nvar Div = styled.div;\nvar VideoContainer = Div(_templateObject2(), function (p) {\n  if (p.layout === \"feature\") {\n    return \"\\n        text-align: center;\\n        padding-bottom: 53px;\\n        max-width: 1200px;\\n        margin: 0 auto;\\n        \".concat(breakpoint.md(_templateObject3()), \"\\n\\n        \").concat(breakpoint.xs(_templateObject4()), \"\\n      \");\n  }\n});\nexport var CoverImage = Div(_templateObject5(), function (props) {\n  return props.hidden || !props.src ? \"none\" : \"flex\";\n}, function (props) {\n  return props.height ? \"\".concat(props.height, \"px\") : \"100%\";\n}, function (props) {\n  return props.src || \"\";\n});\nvar sizeMeOptions = {\n  refreshRate: SIZE_ME_REFRESH_RATE,\n  noPlaceholder: true\n};\nexport var Video = sizeMe(sizeMeOptions)(VideoComponent);",{"version":3,"sources":["/Users/eve/development/reaction/src/Components/Publishing/Sections/Video.tsx"],"names":["React","sizeMe","track","styled","urlParser","Events","resize","pMedia","breakpoint","SIZE_ME_REFRESH_RATE","Caption","VideoControls","BLACKLIST","QUERYSTRING","VIDEO_RATIO","VideoComponent","props","trackingData","dispatch","data","postEvent","url","section","isValid","isValidVideoUrl","parsedUrl","parse","playerUrl","getPlayerUrl","id","getId","playerSrc","state","src","hidden","console","error","playVideo","bind","tracking","trackEvent","action","label","setState","trackVideoClick","caption","cover_image_url","width","size","showCaption","layout","children","Component","x","urlExtension","split","pop","every","bad","hostname","indexOf","pathname","query","v","iframe","IFrame","height","Div","div","VideoContainer","p","md","xs","CoverImage","sizeMeOptions","refreshRate","noPlaceholder","Video"],"mappings":"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","sourcesContent":["import React from \"react\"\nimport sizeMe from \"react-sizeme\"\nimport track from \"react-tracking\"\nimport styled, { StyledFunction } from \"styled-components\"\nimport urlParser from \"url\"\nimport Events from \"../../../Utils/Events\"\nimport { resize } from \"../../../Utils/resizer\"\nimport { pMedia as breakpoint } from \"../../Helpers\"\nimport { SIZE_ME_REFRESH_RATE } from \"../Constants\"\nimport { ArticleLayout } from \"../Typings\"\nimport { Caption } from \"./Caption\"\nimport { VideoControls } from \"./VideoControls\"\n\nconst BLACKLIST = [\"gif\", \"jpg\", \"jpeg\", \"png\"]\nconst QUERYSTRING =\n  \"?title=0&portrait=0&badge=0&byline=0&showinfo=0&rel=0&controls=2&modestbranding=1&iv_load_policy=3&color=E5E5E5\"\nexport const VIDEO_RATIO = 0.5625\n\ninterface VideoProps {\n  section: {\n    url: string\n    caption?: string\n    cover_image_url?: string\n  }\n  size?: any\n  tracking?: any\n  trackingData?: any\n  layout?: ArticleLayout\n}\n\ninterface VideoState {\n  src?: string // FIXME: Coming from Positron, this can be empty / invalid\n  hidden: boolean\n}\n\n@track(\n  props => {\n    return props.trackingData ? props.trackingData : {}\n  },\n  {\n    dispatch: data => Events.postEvent(data),\n  }\n)\nclass VideoComponent extends React.Component<VideoProps, VideoState> {\n  static defaultProps = {\n    size: {\n      width: 500,\n    },\n    tracking: {\n      trackEvent: x => x,\n    },\n  }\n\n  constructor(props) {\n    super(props)\n\n    const { url } = this.props.section\n    const isValid = url && isValidVideoUrl(url)\n\n    if (isValid) {\n      const parsedUrl = urlParser.parse(url, true)\n      const playerUrl = getPlayerUrl(parsedUrl)\n      const id = getId(parsedUrl)\n      const playerSrc = playerUrl + id + QUERYSTRING\n\n      this.state = {\n        src: playerSrc,\n        hidden: false,\n      }\n    } else {\n      console.error(\n        \"(@artsy/reaction) Video.tsx: A url is required for video.\",\n        this.props\n      )\n\n      this.state = {\n        hidden: true,\n      }\n    }\n    this.playVideo = this.playVideo.bind(this)\n  }\n\n  trackVideoClick() {\n    this.props.tracking.trackEvent({\n      action: \"Click\",\n      label: \"Play video\",\n    })\n  }\n\n  playVideo() {\n    const playerSrc = this.state.src + \"&autoplay=1\"\n    this.setState({ src: playerSrc, hidden: true })\n    this.trackVideoClick()\n  }\n\n  render() {\n    const { caption, cover_image_url } = this.props.section\n    const { width } = this.props.size\n    const src = resize(cover_image_url, { width: 1200 })\n    const showCaption = this.props.layout !== \"feature\"\n\n    return (\n      <VideoContainer layout={this.props.layout} className=\"VideoContainer\">\n        {cover_image_url && (\n          <CoverImage\n            className=\"VideoCover\"\n            src={src}\n            height={width && width * VIDEO_RATIO}\n            onClick={this.playVideo}\n            hidden={this.state.hidden}\n          >\n            <VideoControls />\n          </CoverImage>\n        )}\n\n        <IFrame\n          src={this.state.src}\n          frameBorder=\"0\"\n          allowFullScreen\n          height={width && width * VIDEO_RATIO}\n        />\n\n        {showCaption && (\n          <Caption caption={caption} layout={this.props.layout}>\n            {this.props.children}\n          </Caption>\n        )}\n      </VideoContainer>\n    )\n  }\n}\n\n// Utils\nexport function isValidVideoUrl(url: string) {\n  const urlExtension = url && url.split(\".\").pop()\n  const isValid = BLACKLIST.every(bad => urlExtension !== bad)\n  return isValid\n}\n\nexport function getPlayerUrl(url) {\n  const { hostname } = url\n\n  if (hostname) {\n    if (hostname.indexOf(\"vimeo.com\") > -1) {\n      return \"https://player.vimeo.com/video/\"\n    } else if (hostname.indexOf(\"youtu\") > -1) {\n      return \"https://www.youtube.com/embed/\"\n    }\n  } else {\n    return \"\" // FIXME: check for errors\n  }\n}\n\nfunction getId(url) {\n  const { hostname, pathname } = url\n\n  if (hostname && pathname) {\n    if (url.hostname.indexOf(\"youtube.com\") > 0) {\n      return url.query.v\n    } else {\n      return url.pathname.split(\"/\").pop()\n    }\n  } else {\n    return \"\" // FIXME: error\n  }\n}\n\n// Styles\n\nconst iframe: StyledFunction<React.HTMLProps<HTMLIFrameElement>> = styled.iframe\n\nexport const IFrame = iframe`\n  width: 100%;\n  height: ${props => (props.height ? `${props.height}px` : \"100%\")};\n`\n\ninterface CoverImageProps {\n  src?: string\n  height?: number\n  layout?: ArticleLayout\n}\n\nconst Div: StyledFunction<CoverImageProps & React.HTMLProps<HTMLDivElement>> =\n  styled.div\n\nconst VideoContainer = Div`\n  width: 100%;\n  position: relative;\n\n  ${p => {\n    if (p.layout === \"feature\") {\n      return `\n        text-align: center;\n        padding-bottom: 53px;\n        max-width: 1200px;\n        margin: 0 auto;\n        ${breakpoint.md`\n          height: 450px;\n        `}\n\n        ${breakpoint.xs`\n          height: 300px;\n          padding-bottom: 20px;\n        `}\n      `\n    }\n  }}\n`\n\nexport const CoverImage = Div`\n  display: ${props => (props.hidden || !props.src ? \"none\" : \"flex\")};\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: ${props => (props.height ? `${props.height}px` : \"100%\")};\n  position: absolute;\n  background: url(${props => props.src || \"\"}) no-repeat center center;\n  background-size: cover;\n  cursor: pointer;\n`\n\nconst sizeMeOptions = {\n  refreshRate: SIZE_ME_REFRESH_RATE,\n  noPlaceholder: true,\n}\n\nexport const Video = sizeMe(sizeMeOptions)(VideoComponent)\n"]}]}