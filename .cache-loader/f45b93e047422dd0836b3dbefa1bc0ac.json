{"remainingRequest":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js??ref--6-1!/Users/eve/development/reaction/src/Apps/Artist/Routes/Overview/state.ts","dependencies":[{"path":"/Users/eve/development/reaction/src/Apps/Artist/Routes/Overview/state.ts","mtime":1535727457000},{"path":"/Users/eve/development/reaction/.babelrc","mtime":1537112679000},{"path":"/Users/eve/development/reaction/node_modules/cache-loader/dist/cjs.js","mtime":0},{"path":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _without from \"lodash/without\";\nimport _uniq from \"lodash/uniq\";\nimport _omit from \"lodash/omit\";\nimport _cloneDeep from \"lodash/cloneDeep\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { Container } from \"unstated\";\nvar initialState = {\n  medium: \"*\",\n  for_sale: null,\n  page: 1,\n  major_periods: [],\n  partner_id: null,\n  sort: \"-partner_updated_at\",\n  acquireable: null,\n  at_auction: null,\n  inquireable_only: null,\n  selectedFilters: [],\n  showActionSheet: false\n};\nexport var FilterState =\n/*#__PURE__*/\nfunction (_Container) {\n  _inherits(FilterState, _Container);\n\n  function FilterState(props) {\n    var _this;\n\n    _classCallCheck(this, FilterState);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(FilterState).call(this));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", _cloneDeep(initialState));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"setSort\", function (sort, mediator) {\n      _this.setState({\n        sort: sort\n      }, function () {\n        mediator.trigger(\"artist:filter:changed\", _this.state);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"showActionSheet\", function (show) {\n      if (show) {\n        // TODO: Manage this side-effect in a more react-like fashion\n        document.body.style.overflowY = \"hidden\";\n      } else {\n        document.body.style.overflowY = \"auto\";\n      }\n\n      _this.setState({\n        showActionSheet: show\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"resetFilters\", function () {\n      _this.setState(_objectSpread({}, initialState, {\n        showActionSheet: true\n      }));\n    });\n\n    if (props) {\n      Object.keys(_this.state).forEach(function (filter) {\n        if (props[filter]) {\n          if (filter === \"major_periods\") {\n            _this.state[filter] = [props[filter]];\n          } else if ([\"for_sale\", \"acquireable\", \"at_auction\", \"inquireable_only\"].includes(filter)) {\n            _this.state[filter] = props[filter] ? true : null;\n          } else {\n            _this.state[filter] = props[filter];\n          }\n        }\n      });\n    }\n\n    return _this;\n  }\n\n  _createClass(FilterState, [{\n    key: \"setPage\",\n    value: function setPage(page, mediator) {\n      var _this2 = this;\n\n      this.setState({\n        page: page\n      }, function () {\n        mediator.trigger(\"artist:filter:changed\", _this2.state);\n      });\n    }\n  }, {\n    key: \"unsetFilter\",\n    value: function unsetFilter(filter, mediator) {\n      var _this3 = this;\n\n      var selectedFilters = this.state.selectedFilters;\n      var newPartialState = {};\n\n      if (filter === \"major_periods\") {\n        newPartialState = {\n          major_periods: []\n        };\n      }\n\n      if ([\"for_sale\", \"acquireable\", \"at_auction\", \"partner_id\", \"inquireable_only\"].includes(filter)) {\n        newPartialState[filter] = null;\n      }\n\n      if (filter === \"medium\") {\n        newPartialState = {\n          medium: \"*\"\n        };\n      }\n\n      selectedFilters = _without(selectedFilters, \"radio\");\n      this.setState(_objectSpread({\n        page: 1,\n        selectedFilters: selectedFilters\n      }, newPartialState), function () {\n        var filterState = _omit(_this3.state, [\"selectedFilterCount\", \"showActionSheet\"]);\n\n        mediator.trigger(\"artist:filter:changed\", filterState);\n      });\n    }\n  }, {\n    key: \"setFilter\",\n    value: function setFilter(filter, value, mediator) {\n      var _this4 = this;\n\n      var selectedFilters = this.state.selectedFilters;\n      var newPartialState = {};\n\n      if (filter === \"major_periods\") {\n        newPartialState = {\n          partner_id: null,\n          major_periods: [value],\n          medium: \"*\"\n        };\n      } else if (filter === \"partner_id\") {\n        newPartialState = {\n          major_periods: [],\n          partner_id: value,\n          medium: \"*\"\n        };\n      } else if (filter === \"medium\") {\n        newPartialState = {\n          medium: value,\n          partner_id: null,\n          major_periods: []\n        };\n      } else if ([\"for_sale\", \"acquireable\", \"at_auction\", \"inquireable_only\"].includes(filter)) {\n        if (value) {\n          selectedFilters = selectedFilters.concat([filter]);\n          newPartialState[filter] = true;\n        } else {\n          selectedFilters = _without(selectedFilters, filter);\n          newPartialState[filter] = null;\n        }\n      }\n\n      if ([\"major_periods\", \"partner_id\", \"medium\"].includes(filter)) {\n        selectedFilters = selectedFilters.concat([\"radio\"]);\n      }\n\n      selectedFilters = _uniq(selectedFilters);\n      this.setState(_objectSpread({\n        page: 1,\n        selectedFilters: selectedFilters\n      }, newPartialState), function () {\n        var filterState = _omit(_this4.state, [\"selectedFilters\", \"showActionSheet\"]);\n\n        mediator.trigger(\"artist:filter:changed\", filterState);\n      });\n    }\n  }]);\n\n  return FilterState;\n}(Container);",{"version":3,"sources":["/Users/eve/development/reaction/src/Apps/Artist/Routes/Overview/state.ts"],"names":["Container","initialState","medium","for_sale","page","major_periods","partner_id","sort","acquireable","at_auction","inquireable_only","selectedFilters","showActionSheet","FilterState","props","mediator","setState","trigger","state","show","document","body","style","overflowY","Object","keys","forEach","filter","includes","newPartialState","filterState","value","concat"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,SAASA,SAAT,QAA0B,UAA1B;AAmBA,IAAMC,YAAY,GAAG;AACnBC,EAAAA,MAAM,EAAE,GADW;AAEnBC,EAAAA,QAAQ,EAAE,IAFS;AAGnBC,EAAAA,IAAI,EAAE,CAHa;AAInBC,EAAAA,aAAa,EAAE,EAJI;AAKnBC,EAAAA,UAAU,EAAE,IALO;AAMnBC,EAAAA,IAAI,EAAE,qBANa;AAOnBC,EAAAA,WAAW,EAAE,IAPM;AAQnBC,EAAAA,UAAU,EAAE,IARO;AASnBC,EAAAA,gBAAgB,EAAE,IATC;AAUnBC,EAAAA,eAAe,EAAE,EAVE;AAWnBC,EAAAA,eAAe,EAAE;AAXE,CAArB;AAcA,WAAaC,WAAb;AAAA;AAAA;AAAA;;AAGE,uBAAYC,KAAZ,EAA0B;AAAA;;AAAA;;AACxB;;AADwB,oFAFlB,WAAUb,YAAV,CAEkB;;AAAA,sFA8BhB,UAACM,IAAD,EAAOQ,QAAP,EAAoB;AAC5B,YAAKC,QAAL,CAAc;AAAET,QAAAA,IAAI,EAAJA;AAAF,OAAd,EAAwB,YAAM;AAC5BQ,QAAAA,QAAQ,CAACE,OAAT,CAAiB,uBAAjB,EAA0C,MAAKC,KAA/C;AACD,OAFD;AAGD,KAlCyB;;AAAA,8FAoCR,UAAAC,IAAI,EAAI;AACxB,UAAIA,IAAJ,EAAU;AACR;AACAC,QAAAA,QAAQ,CAACC,IAAT,CAAcC,KAAd,CAAoBC,SAApB,GAAgC,QAAhC;AACD,OAHD,MAGO;AACLH,QAAAA,QAAQ,CAACC,IAAT,CAAcC,KAAd,CAAoBC,SAApB,GAAgC,MAAhC;AACD;;AAED,YAAKP,QAAL,CAAc;AAAEJ,QAAAA,eAAe,EAAEO;AAAnB,OAAd;AACD,KA7CyB;;AAAA,2FA+CX,YAAM;AACnB,YAAKH,QAAL,mBACKf,YADL;AAEEW,QAAAA,eAAe,EAAE;AAFnB;AAID,KApDyB;;AAExB,QAAIE,KAAJ,EAAW;AACTU,MAAAA,MAAM,CAACC,IAAP,CAAY,MAAKP,KAAjB,EAAwBQ,OAAxB,CAAgC,UAAAC,MAAM,EAAI;AACxC,YAAIb,KAAK,CAACa,MAAD,CAAT,EAAmB;AACjB,cAAIA,MAAM,KAAK,eAAf,EAAgC;AAC9B,kBAAKT,KAAL,CAAWS,MAAX,IAAqB,CAACb,KAAK,CAACa,MAAD,CAAN,CAArB;AACD,WAFD,MAEO,IACL,CACE,UADF,EAEE,aAFF,EAGE,YAHF,EAIE,kBAJF,EAKEC,QALF,CAKWD,MALX,CADK,EAOL;AACA,kBAAKT,KAAL,CAAWS,MAAX,IAAqBb,KAAK,CAACa,MAAD,CAAL,GAAgB,IAAhB,GAAuB,IAA5C;AACD,WATM,MASA;AACL,kBAAKT,KAAL,CAAWS,MAAX,IAAqBb,KAAK,CAACa,MAAD,CAA1B;AACD;AACF;AACF,OAjBD;AAkBD;;AArBuB;AAsBzB;;AAzBH;AAAA;AAAA,4BA2BUvB,IA3BV,EA2BgBW,QA3BhB,EA2B0B;AAAA;;AACtB,WAAKC,QAAL,CAAc;AAAEZ,QAAAA,IAAI,EAAJA;AAAF,OAAd,EAAwB,YAAM;AAC5BW,QAAAA,QAAQ,CAACE,OAAT,CAAiB,uBAAjB,EAA0C,MAAI,CAACC,KAA/C;AACD,OAFD;AAGD;AA/BH;AAAA;AAAA,gCAyDcS,MAzDd,EAyDsBZ,QAzDtB,EAyDgC;AAAA;;AAAA,UACtBJ,eADsB,GACF,KAAKO,KADH,CACtBP,eADsB;AAE5B,UAAIkB,eAAe,GAAG,EAAtB;;AACA,UAAIF,MAAM,KAAK,eAAf,EAAgC;AAC9BE,QAAAA,eAAe,GAAG;AAAExB,UAAAA,aAAa,EAAE;AAAjB,SAAlB;AACD;;AACD,UACE,CACE,UADF,EAEE,aAFF,EAGE,YAHF,EAIE,YAJF,EAKE,kBALF,EAMEuB,QANF,CAMWD,MANX,CADF,EAQE;AACAE,QAAAA,eAAe,CAACF,MAAD,CAAf,GAA0B,IAA1B;AACD;;AACD,UAAIA,MAAM,KAAK,QAAf,EAAyB;AACvBE,QAAAA,eAAe,GAAG;AAAE3B,UAAAA,MAAM,EAAE;AAAV,SAAlB;AACD;;AAEDS,MAAAA,eAAe,GAAG,SAAQA,eAAR,EAAyB,OAAzB,CAAlB;AAEA,WAAKK,QAAL;AAAgBZ,QAAAA,IAAI,EAAE,CAAtB;AAAyBO,QAAAA,eAAe,EAAfA;AAAzB,SAA6CkB,eAA7C,GAAgE,YAAM;AACpE,YAAMC,WAAW,GAAG,MAAK,MAAI,CAACZ,KAAV,EAAiB,CACnC,qBADmC,EAEnC,iBAFmC,CAAjB,CAApB;;AAIAH,QAAAA,QAAQ,CAACE,OAAT,CAAiB,uBAAjB,EAA0Ca,WAA1C;AACD,OAND;AAOD;AAvFH;AAAA;AAAA,8BAyFYH,MAzFZ,EAyFoBI,KAzFpB,EAyF2BhB,QAzF3B,EAyFqC;AAAA;;AAAA,UAC3BJ,eAD2B,GACP,KAAKO,KADE,CAC3BP,eAD2B;AAGjC,UAAIkB,eAAe,GAAG,EAAtB;;AACA,UAAIF,MAAM,KAAK,eAAf,EAAgC;AAC9BE,QAAAA,eAAe,GAAG;AAChBvB,UAAAA,UAAU,EAAE,IADI;AAEhBD,UAAAA,aAAa,EAAE,CAAC0B,KAAD,CAFC;AAGhB7B,UAAAA,MAAM,EAAE;AAHQ,SAAlB;AAKD,OAND,MAMO,IAAIyB,MAAM,KAAK,YAAf,EAA6B;AAClCE,QAAAA,eAAe,GAAG;AAAExB,UAAAA,aAAa,EAAE,EAAjB;AAAqBC,UAAAA,UAAU,EAAEyB,KAAjC;AAAwC7B,UAAAA,MAAM,EAAE;AAAhD,SAAlB;AACD,OAFM,MAEA,IAAIyB,MAAM,KAAK,QAAf,EAAyB;AAC9BE,QAAAA,eAAe,GAAG;AAAE3B,UAAAA,MAAM,EAAE6B,KAAV;AAAiBzB,UAAAA,UAAU,EAAE,IAA7B;AAAmCD,UAAAA,aAAa,EAAE;AAAlD,SAAlB;AACD,OAFM,MAEA,IACL,CAAC,UAAD,EAAa,aAAb,EAA4B,YAA5B,EAA0C,kBAA1C,EAA8DuB,QAA9D,CACED,MADF,CADK,EAIL;AACA,YAAII,KAAJ,EAAW;AACTpB,UAAAA,eAAe,GAAGA,eAAe,CAACqB,MAAhB,CAAuB,CAACL,MAAD,CAAvB,CAAlB;AACAE,UAAAA,eAAe,CAACF,MAAD,CAAf,GAA0B,IAA1B;AACD,SAHD,MAGO;AACLhB,UAAAA,eAAe,GAAG,SAAQA,eAAR,EAAyBgB,MAAzB,CAAlB;AACAE,UAAAA,eAAe,CAACF,MAAD,CAAf,GAA0B,IAA1B;AACD;AACF;;AAED,UAAI,CAAC,eAAD,EAAkB,YAAlB,EAAgC,QAAhC,EAA0CC,QAA1C,CAAmDD,MAAnD,CAAJ,EAAgE;AAC9DhB,QAAAA,eAAe,GAAGA,eAAe,CAACqB,MAAhB,CAAuB,CAAC,OAAD,CAAvB,CAAlB;AACD;;AAEDrB,MAAAA,eAAe,GAAG,MAAKA,eAAL,CAAlB;AAEA,WAAKK,QAAL;AAAgBZ,QAAAA,IAAI,EAAE,CAAtB;AAAyBO,QAAAA,eAAe,EAAfA;AAAzB,SAA6CkB,eAA7C,GAAgE,YAAM;AACpE,YAAMC,WAAW,GAAG,MAAK,MAAI,CAACZ,KAAV,EAAiB,CACnC,iBADmC,EAEnC,iBAFmC,CAAjB,CAApB;;AAKAH,QAAAA,QAAQ,CAACE,OAAT,CAAiB,uBAAjB,EAA0Ca,WAA1C;AACD,OAPD;AAQD;AAnIH;;AAAA;AAAA,EAAiC9B,SAAjC","sourcesContent":["import { cloneDeep, omit, uniq, without } from \"lodash\"\nimport { Container } from \"unstated\"\n\ninterface State {\n  // Search filters\n  medium: string\n  major_periods?: string[]\n  partner_id?: string\n  for_sale?: boolean\n  page?: number\n  sort?: string\n  acquireable?: boolean\n  at_auction?: boolean\n  inquireable_only?: boolean\n\n  // UI\n  selectedFilters: string[]\n  showActionSheet: boolean\n}\n\nconst initialState = {\n  medium: \"*\",\n  for_sale: null,\n  page: 1,\n  major_periods: [],\n  partner_id: null,\n  sort: \"-partner_updated_at\",\n  acquireable: null,\n  at_auction: null,\n  inquireable_only: null,\n  selectedFilters: [],\n  showActionSheet: false,\n}\n\nexport class FilterState extends Container<State> {\n  state = cloneDeep(initialState)\n\n  constructor(props: State) {\n    super()\n    if (props) {\n      Object.keys(this.state).forEach(filter => {\n        if (props[filter]) {\n          if (filter === \"major_periods\") {\n            this.state[filter] = [props[filter]]\n          } else if (\n            [\n              \"for_sale\",\n              \"acquireable\",\n              \"at_auction\",\n              \"inquireable_only\",\n            ].includes(filter)\n          ) {\n            this.state[filter] = props[filter] ? true : null\n          } else {\n            this.state[filter] = props[filter]\n          }\n        }\n      })\n    }\n  }\n\n  setPage(page, mediator) {\n    this.setState({ page }, () => {\n      mediator.trigger(\"artist:filter:changed\", this.state)\n    })\n  }\n\n  setSort = (sort, mediator) => {\n    this.setState({ sort }, () => {\n      mediator.trigger(\"artist:filter:changed\", this.state)\n    })\n  }\n\n  showActionSheet = show => {\n    if (show) {\n      // TODO: Manage this side-effect in a more react-like fashion\n      document.body.style.overflowY = \"hidden\"\n    } else {\n      document.body.style.overflowY = \"auto\"\n    }\n\n    this.setState({ showActionSheet: show })\n  }\n\n  resetFilters = () => {\n    this.setState({\n      ...initialState,\n      showActionSheet: true,\n    })\n  }\n\n  unsetFilter(filter, mediator) {\n    let { selectedFilters } = this.state\n    let newPartialState = {}\n    if (filter === \"major_periods\") {\n      newPartialState = { major_periods: [] }\n    }\n    if (\n      [\n        \"for_sale\",\n        \"acquireable\",\n        \"at_auction\",\n        \"partner_id\",\n        \"inquireable_only\",\n      ].includes(filter)\n    ) {\n      newPartialState[filter] = null\n    }\n    if (filter === \"medium\") {\n      newPartialState = { medium: \"*\" }\n    }\n\n    selectedFilters = without(selectedFilters, \"radio\")\n\n    this.setState({ page: 1, selectedFilters, ...newPartialState }, () => {\n      const filterState = omit(this.state, [\n        \"selectedFilterCount\",\n        \"showActionSheet\",\n      ])\n      mediator.trigger(\"artist:filter:changed\", filterState)\n    })\n  }\n\n  setFilter(filter, value, mediator) {\n    let { selectedFilters } = this.state\n\n    let newPartialState = {}\n    if (filter === \"major_periods\") {\n      newPartialState = {\n        partner_id: null,\n        major_periods: [value],\n        medium: \"*\",\n      }\n    } else if (filter === \"partner_id\") {\n      newPartialState = { major_periods: [], partner_id: value, medium: \"*\" }\n    } else if (filter === \"medium\") {\n      newPartialState = { medium: value, partner_id: null, major_periods: [] }\n    } else if (\n      [\"for_sale\", \"acquireable\", \"at_auction\", \"inquireable_only\"].includes(\n        filter\n      )\n    ) {\n      if (value) {\n        selectedFilters = selectedFilters.concat([filter])\n        newPartialState[filter] = true\n      } else {\n        selectedFilters = without(selectedFilters, filter)\n        newPartialState[filter] = null\n      }\n    }\n\n    if ([\"major_periods\", \"partner_id\", \"medium\"].includes(filter)) {\n      selectedFilters = selectedFilters.concat([\"radio\"])\n    }\n\n    selectedFilters = uniq(selectedFilters)\n\n    this.setState({ page: 1, selectedFilters, ...newPartialState }, () => {\n      const filterState = omit(this.state, [\n        \"selectedFilters\",\n        \"showActionSheet\",\n      ])\n\n      mediator.trigger(\"artist:filter:changed\", filterState)\n    })\n  }\n}\n"]}]}