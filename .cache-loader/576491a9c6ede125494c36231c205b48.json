{"remainingRequest":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js??ref--6-1!/Users/eve/development/reaction/src/Styleguide/Pages/Artist/Routes/AuctionResults/AuctionResultsRefetchContainer.tsx","dependencies":[{"path":"/Users/eve/development/reaction/src/Styleguide/Pages/Artist/Routes/AuctionResults/AuctionResultsRefetchContainer.tsx","mtime":1530290903000},{"path":"/Users/eve/development/reaction/.babelrc","mtime":1529423546000},{"path":"/Users/eve/development/reaction/node_modules/cache-loader/dist/cjs.js","mtime":0},{"path":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js","mtime":1509489566000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AuctionResultsRefetchContainer = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _reactRelay = require(\"react-relay\");\n\nvar _Pagination = require(\"../../../../Components/Pagination\");\n\nvar _Box = require(\"../../../../Elements/Box\");\n\nvar _Flex = require(\"../../../../Elements/Flex\");\n\nvar _Grid = require(\"../../../../Elements/Grid\");\n\nvar _Separator = require(\"../../../../Elements/Separator\");\n\nvar _unstated = require(\"unstated\");\n\nvar _AuctionDetailsModal = require(\"./AuctionDetailsModal\");\n\nvar _AuctionResultItem = require(\"./AuctionResultItem\");\n\nvar _AuctionResultsState = require(\"./AuctionResultsState\");\n\nvar _TableColumns = require(\"./TableColumns\");\n\nvar _TableSidebar = require(\"./TableSidebar\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nvar PAGE_SIZE = 10;\n\nvar AuctionResultsContainer =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(AuctionResultsContainer, _React$Component);\n\n  function AuctionResultsContainer() {\n    var _ref;\n\n    var _temp, _this;\n\n    _classCallCheck(this, AuctionResultsContainer);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _possibleConstructorReturn(_this, (_temp = _this = _possibleConstructorReturn(this, (_ref = AuctionResultsContainer.__proto__ || Object.getPrototypeOf(AuctionResultsContainer)).call.apply(_ref, [this].concat(args))), Object.defineProperty(_assertThisInitialized(_this), \"loadNext\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: function value() {\n        var _this$props$artist$au = _this.props.artist.auctionResults.pageInfo,\n            hasNextPage = _this$props$artist$au.hasNextPage,\n            endCursor = _this$props$artist$au.endCursor;\n\n        if (hasNextPage) {\n          _this.loadAfter(endCursor);\n        }\n      }\n    }), Object.defineProperty(_assertThisInitialized(_this), \"resort\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: function value() {\n        _this.props.relay.refetch({\n          first: PAGE_SIZE,\n          after: null,\n          artistID: _this.props.artist.id,\n          before: null,\n          last: null,\n          sort: _this.props.sort\n        }, null, function (error) {\n          if (error) {\n            console.error(error);\n          }\n        });\n      }\n    }), Object.defineProperty(_assertThisInitialized(_this), \"loadAfter\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: function value(cursor) {\n        _this.props.relay.refetch({\n          first: PAGE_SIZE,\n          after: cursor,\n          artistID: _this.props.artist.id,\n          before: null,\n          last: null,\n          sort: _this.props.sort\n        }, null, function (error) {\n          if (error) {\n            console.error(error);\n          }\n        });\n      }\n    }), _temp));\n  }\n\n  _createClass(AuctionResultsContainer, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.sort !== this.props.sort) {\n        this.resort();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return _react.default.createElement(_unstated.Subscribe, {\n        to: [_AuctionResultsState.AuctionResultsStateContainer]\n      }, function (_ref2) {\n        var state = _ref2.state;\n        return _react.default.createElement(_react.default.Fragment, null, _react.default.createElement(_Grid.Row, null, _react.default.createElement(_TableSidebar.TableSidebar, null), _react.default.createElement(_Grid.Col, {\n          sm: 10\n        }, _react.default.createElement(_Grid.Row, null, _react.default.createElement(_TableColumns.TableColumns, null)), _react.default.createElement(_Box.Box, {\n          pt: 0.5\n        }, _react.default.createElement(_Separator.Separator, null)), _react.default.createElement(_AuctionDetailsModal.AuctionDetailsModal, {\n          auctionResult: state.selectedAuction\n        }), _this2.props.artist.auctionResults.edges.map(function (_ref3, index) {\n          var node = _ref3.node;\n          return _react.default.createElement(_react.default.Fragment, {\n            key: index\n          }, _react.default.createElement(_AuctionResultItem.AuctionResultItemFragmentContainer, {\n            auctionResult: node\n          }));\n        }))), _react.default.createElement(_Grid.Row, null, _react.default.createElement(_Grid.Col, null, _react.default.createElement(_Flex.Flex, {\n          justifyContent: \"flex-end\"\n        }, _react.default.createElement(_Pagination.PaginationFragmentContainer, {\n          pageCursors: _this2.props.artist.auctionResults.pageCursors,\n          onClick: _this2.loadAfter,\n          onNext: _this2.loadNext,\n          scrollTo: \"#jumpto-RouteTabs\"\n        })))));\n      });\n    }\n  }]);\n\n  return AuctionResultsContainer;\n}(_react.default.Component);\n\nvar AuctionResultsRefetchContainer = (0, _reactRelay.createRefetchContainer)(function (props) {\n  return _react.default.createElement(_unstated.Subscribe, {\n    to: [_AuctionResultsState.AuctionResultsStateContainer]\n  }, function (_ref4) {\n    var state = _ref4.state;\n    return _react.default.createElement(AuctionResultsContainer, _extends({}, props, {\n      sort: state.sort\n    }));\n  });\n}, {\n  artist: function artist() {\n    var node = require(\"../../../../../__generated__/AuctionResultsRefetchContainer_artist.graphql\");\n\n    if (node.hash && node.hash !== \"61d336b4a3513e35911de8afd24c4eeb\") {\n      console.error(\"The definition of 'AuctionResultsRefetchContainer_artist' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data.\");\n    }\n\n    return require(\"../../../../../__generated__/AuctionResultsRefetchContainer_artist.graphql\");\n  }\n}, function () {\n  var node = require(\"../../../../../__generated__/AuctionResultsRefetchContainerQuery.graphql\");\n\n  if (node.hash && node.hash !== \"048b9ae9176c6bee3588849b7378268a\") {\n    console.error(\"The definition of 'AuctionResultsRefetchContainerQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data.\");\n  }\n\n  return require(\"../../../../../__generated__/AuctionResultsRefetchContainerQuery.graphql\");\n});\nexports.AuctionResultsRefetchContainer = AuctionResultsRefetchContainer;",{"version":3,"sources":["src/Styleguide/Pages/Artist/Routes/AuctionResults/AuctionResultsRefetchContainer.tsx"],"names":["PAGE_SIZE","AuctionResultsContainer","props","artist","auctionResults","pageInfo","hasNextPage","endCursor","loadAfter","relay","refetch","first","after","artistID","id","before","last","sort","error","console","cursor","prevProps","resort","state","selectedAuction","edges","map","index","node","pageCursors","loadNext","Component","AuctionResultsRefetchContainer"],"mappings":";;;;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;AAEA,IAAMA,YAAY,EAAlB;;IAQMC,uB;;;;;;;;;;;;;;;;;;;;aACO,iBAAM;AAAA,oCACoB,MAAKC,KAAL,CAAWC,MAAX,CAAkBC,cAAlB,CAAiCC,QADrD;AAAA,YACPC,WADO,yBACPA,WADO;AAAA,YACMC,SADN,yBACMA,SADN;;AAGf,YAAID,WAAJ,EAAiB;AACf,gBAAKE,SAAL,CAAeD,SAAf;AACD;AACF;;;;;aAQQ,iBAAM;AACb,cAAKL,KAAL,CAAWO,KAAX,CAAiBC,OAAjB,CACE;AACEC,iBAAOX,SADT;AAEEY,iBAAO,IAFT;AAGEC,oBAAU,MAAKX,KAAL,CAAWC,MAAX,CAAkBW,EAH9B;AAIEC,kBAAQ,IAJV;AAKEC,gBAAM,IALR;AAMEC,gBAAM,MAAKf,KAAL,CAAWe;AANnB,SADF,EASE,IATF,EAUE,iBAAS;AACP,cAAIC,KAAJ,EAAW;AACTC,oBAAQD,KAAR,CAAcA,KAAd;AACD;AACF,SAdH;AAgBD;;;;;aAEW,uBAAU;AACpB,cAAKhB,KAAL,CAAWO,KAAX,CAAiBC,OAAjB,CACE;AACEC,iBAAOX,SADT;AAEEY,iBAAOQ,MAFT;AAGEP,oBAAU,MAAKX,KAAL,CAAWC,MAAX,CAAkBW,EAH9B;AAIEC,kBAAQ,IAJV;AAKEC,gBAAM,IALR;AAMEC,gBAAM,MAAKf,KAAL,CAAWe;AANnB,SADF,EASE,IATF,EAUE,iBAAS;AACP,cAAIC,KAAJ,EAAW;AACTC,oBAAQD,KAAR,CAAcA,KAAd;AACD;AACF,SAdH;AAgBD;;;;;;uCA1CkBG,S,EAAW;AAC5B,UAAIA,UAAUJ,IAAV,KAAmB,KAAKf,KAAL,CAAWe,IAAlC,EAAwC;AACtC,aAAKK,MAAL;AACD;AACF;;;6BAwCQ;AAAA;;AACP,aACE;AAAW,YAAI;AAAf,SACG,iBAA6C;AAAA,YAA1CC,KAA0C,SAA1CA,KAA0C;AAC5C,eACE,4CAAO,QAAP,QACE,8CACE,8DADF,EAGE;AAAK,cAAI;AAAT,WACE,8CACE,8DADF,CADF,EAKE;AAAK,cAAI;AAAT,WACE,wDADF,CALF,EASE;AAAqB,yBAAeA,MAAMC;AAA1C,UATF,EAWG,OAAKtB,KAAL,CAAWC,MAAX,CAAkBC,cAAlB,CAAiCqB,KAAjC,CAAuCC,GAAvC,CACC,iBAAWC,KAAX,EAAqB;AAAA,cAAlBC,IAAkB,SAAlBA,IAAkB;AACnB,iBACE,4CAAO,QAAP;AAAgB,iBAAKD;AAArB,aACE;AACE,2BAAeC;AADjB,YADF,CADF;AAOD,SATF,CAXH,CAHF,CADF,EA6BE,8CACE,8CACE;AAAM,0BAAe;AAArB,WACE;AACE,uBACE,OAAK1B,KAAL,CAAWC,MAAX,CAAkBC,cAAlB,CAAiCyB,WAFrC;AAIE,mBAAS,OAAKrB,SAJhB;AAKE,kBAAQ,OAAKsB,QALf;AAME,oBAAS;AANX,UADF,CADF,CADF,CA7BF,CADF;AA8CD,OAhDH,CADF;AAoDD;;;;EA1GmC,eAAMC,S;;AA6GrC,IAAMC,iCAAiC,wCAC5C,UAAC9B,KAAD,EAAgC;AAC9B,SACE;AAAW,QAAI;AAAf,KACG,iBAA6C;AAAA,QAA1CqB,KAA0C,SAA1CA,KAA0C;AAC5C,WAAO,6BAAC,uBAAD,eAA6BrB,KAA7B;AAAoC,YAAMqB,MAAMN;AAAhD,OAAP;AACD,GAHH,CADF;AAOD,CAT2C,EAU5C;AACEd;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AADF,CAV4C;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA,EAAvC","file":"/Users/eve/development/reaction/src/Styleguide/Pages/Artist/Routes/AuctionResults/AuctionResultsRefetchContainer.tsx","sourceRoot":"/Users/eve/development/reaction","sourcesContent":["import { AuctionResultsRefetchContainer_artist } from \"__generated__/AuctionResultsRefetchContainer_artist.graphql\"\nimport React from \"react\"\nimport { createRefetchContainer, graphql, RelayRefetchProp } from \"react-relay\"\nimport { PaginationFragmentContainer } from \"Styleguide/Components/Pagination\"\nimport { Box } from \"Styleguide/Elements/Box\"\nimport { Flex } from \"Styleguide/Elements/Flex\"\nimport { Col, Row } from \"Styleguide/Elements/Grid\"\nimport { Separator } from \"Styleguide/Elements/Separator\"\nimport { Subscribe } from \"unstated\"\nimport { AuctionDetailsModal } from \"./AuctionDetailsModal\"\nimport { AuctionResultItemFragmentContainer } from \"./AuctionResultItem\"\nimport { AuctionResultsStateContainer } from \"./AuctionResultsState\"\nimport { TableColumns } from \"./TableColumns\"\nimport { TableSidebar } from \"./TableSidebar\"\n\nconst PAGE_SIZE = 10\n\ninterface AuctionResultsProps {\n  relay: RelayRefetchProp\n  artist: AuctionResultsRefetchContainer_artist\n  sort: string\n}\n\nclass AuctionResultsContainer extends React.Component<AuctionResultsProps> {\n  loadNext = () => {\n    const { hasNextPage, endCursor } = this.props.artist.auctionResults.pageInfo\n\n    if (hasNextPage) {\n      this.loadAfter(endCursor)\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.sort !== this.props.sort) {\n      this.resort()\n    }\n  }\n\n  resort = () => {\n    this.props.relay.refetch(\n      {\n        first: PAGE_SIZE,\n        after: null,\n        artistID: this.props.artist.id,\n        before: null,\n        last: null,\n        sort: this.props.sort,\n      },\n      null,\n      error => {\n        if (error) {\n          console.error(error)\n        }\n      }\n    )\n  }\n\n  loadAfter = cursor => {\n    this.props.relay.refetch(\n      {\n        first: PAGE_SIZE,\n        after: cursor,\n        artistID: this.props.artist.id,\n        before: null,\n        last: null,\n        sort: this.props.sort,\n      },\n      null,\n      error => {\n        if (error) {\n          console.error(error)\n        }\n      }\n    )\n  }\n\n  render() {\n    return (\n      <Subscribe to={[AuctionResultsStateContainer]}>\n        {({ state }: AuctionResultsStateContainer) => {\n          return (\n            <React.Fragment>\n              <Row>\n                <TableSidebar />\n\n                <Col sm={10}>\n                  <Row>\n                    <TableColumns />\n                  </Row>\n\n                  <Box pt={0.5}>\n                    <Separator />\n                  </Box>\n\n                  <AuctionDetailsModal auctionResult={state.selectedAuction} />\n\n                  {this.props.artist.auctionResults.edges.map(\n                    ({ node }, index) => {\n                      return (\n                        <React.Fragment key={index}>\n                          <AuctionResultItemFragmentContainer\n                            auctionResult={node as any}\n                          />\n                        </React.Fragment>\n                      )\n                    }\n                  )}\n                </Col>\n              </Row>\n\n              <Row>\n                <Col>\n                  <Flex justifyContent=\"flex-end\">\n                    <PaginationFragmentContainer\n                      pageCursors={\n                        this.props.artist.auctionResults.pageCursors as any\n                      }\n                      onClick={this.loadAfter}\n                      onNext={this.loadNext}\n                      scrollTo=\"#jumpto-RouteTabs\"\n                    />\n                  </Flex>\n                </Col>\n              </Row>\n            </React.Fragment>\n          )\n        }}\n      </Subscribe>\n    )\n  }\n}\n\nexport const AuctionResultsRefetchContainer = createRefetchContainer(\n  (props: AuctionResultsProps) => {\n    return (\n      <Subscribe to={[AuctionResultsStateContainer]}>\n        {({ state }: AuctionResultsStateContainer) => {\n          return <AuctionResultsContainer {...props} sort={state.sort} />\n        }}\n      </Subscribe>\n    )\n  },\n  {\n    artist: graphql`\n      fragment AuctionResultsRefetchContainer_artist on Artist\n        @argumentDefinitions(\n          sort: {\n            type: \"AuctionResultSorts\"\n            defaultValue: \"PRICE_AND_DATE_DESC\"\n          }\n          first: { type: \"Int\", defaultValue: 10 }\n          last: { type: \"Int\" }\n          after: { type: \"String\" }\n          before: { type: \"String\" }\n        ) {\n        id\n        auctionResults(\n          first: $first\n          after: $after\n          before: $before\n          last: $last\n          sort: $sort\n        ) {\n          pageInfo {\n            hasNextPage\n            endCursor\n          }\n          pageCursors {\n            ...Pagination_pageCursors\n          }\n          edges {\n            node {\n              ...AuctionResultItem_auctionResult\n            }\n          }\n        }\n      }\n    `,\n  },\n  graphql`\n    query AuctionResultsRefetchContainerQuery(\n      $first: Int\n      $last: Int\n      $after: String\n      $before: String\n      $sort: AuctionResultSorts\n      $artistID: String!\n    ) {\n      artist(id: $artistID) {\n        ...AuctionResultsRefetchContainer_artist\n          @arguments(\n            first: $first\n            last: $last\n            after: $after\n            before: $before\n            sort: $sort\n          )\n      }\n    }\n  `\n)\n"]}]}