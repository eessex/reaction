{"remainingRequest":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js??ref--6-1!/Users/eve/development/reaction/src/Components/Publishing/Sections/Text.tsx","dependencies":[{"path":"/Users/eve/development/reaction/src/Components/Publishing/Sections/Text.tsx","mtime":1531343334000},{"path":"/Users/eve/development/reaction/.babelrc","mtime":1537112679000},{"path":"/Users/eve/development/reaction/node_modules/cache-loader/dist/cjs.js","mtime":0},{"path":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _startsWith from \"lodash/startsWith\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { Component } from \"react\";\nimport ReactHtmlParser, { convertNodeToElement } from \"react-html-parser\";\nimport { StyledText } from \"./StyledText\";\nexport var Text =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Text, _Component);\n\n  function Text() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Text);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Text)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      html: _this.props.html || \"\"\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"htmlMaybeWithContentEnd\", function () {\n      var html = _this.state.html;\n      var isContentEnd = _this.props.isContentEnd; // Remove existing spans - TODO: Backfill out of articles\n\n      var cleanedHtml = html.replace(\"<span class='content-end'> </span>\", \"\");\n\n      if (isContentEnd) {\n        var doc = document.createElement(\"div\");\n        doc.innerHTML = cleanedHtml;\n        var paragraphs = doc.getElementsByTagName(\"P\");\n        var lastParagraph = paragraphs.length && paragraphs[paragraphs.length - 1];\n\n        if (lastParagraph) {\n          // insert content-end in last paragraph\n          lastParagraph.innerHTML = lastParagraph.innerHTML + \"<span class='content-end'> </span>\";\n        }\n\n        return doc.innerHTML;\n      }\n\n      return cleanedHtml;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"shouldShowTooltipForURL\", function (node) {\n      var urlBase = \"https://www.artsy.net/\";\n      var types = [\"artist/\", \"gene/\"];\n\n      for (var _i = 0; _i < types.length; _i++) {\n        var type = types[_i];\n\n        if (_startsWith(node.attribs.href, urlBase + type)) {\n          return true;\n        }\n      }\n\n      return false;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"transformNode\", function (node, index) {\n      // Dont include relay components unless necessary\n      // To avoid 'regeneratorRuntime' error\n      var LinkWithTooltip = require(\"../ToolTip/LinkWithTooltip\").default;\n\n      if (node.name === \"p\") {\n        node.name = \"div\";\n        node.attribs.class = \"paragraph\";\n        return convertNodeToElement(node, index, _this.transformNode);\n      }\n\n      if (node.name === \"a\" && _this.shouldShowTooltipForURL(node)) {\n        var href = node.attribs.href;\n        var text = node.children[0] && node.children[0].data;\n\n        if (text) {\n          return React.createElement(LinkWithTooltip, {\n            key: href + index,\n            url: href\n          }, text);\n        }\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(Text, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var html = this.htmlMaybeWithContentEnd();\n      this.setState({\n        html: html\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          children = _this$props.children,\n          color = _this$props.color,\n          isContentStart = _this$props.isContentStart,\n          layout = _this$props.layout,\n          postscript = _this$props.postscript,\n          showTooltips = _this$props.showTooltips;\n      var html = this.state.html;\n      return React.createElement(StyledText, {\n        className: \"article__text-section\",\n        color: color,\n        isContentStart: isContentStart,\n        layout: layout,\n        postscript: postscript,\n        showTooltips: showTooltips\n      }, html.length ? showTooltips ? React.createElement(\"div\", null, ReactHtmlParser(html, {\n        transform: this.transformNode\n      })) : React.createElement(\"div\", {\n        dangerouslySetInnerHTML: {\n          __html: html\n        }\n      }) : children);\n    }\n  }]);\n\n  return Text;\n}(Component);\n\n_defineProperty(Text, \"defaultProps\", {\n  color: \"black\",\n  showToolTip: false\n});",{"version":3,"sources":["/Users/eve/development/reaction/src/Components/Publishing/Sections/Text.tsx"],"names":["React","Component","ReactHtmlParser","convertNodeToElement","StyledText","Text","html","props","state","isContentEnd","cleanedHtml","replace","doc","document","createElement","innerHTML","paragraphs","getElementsByTagName","lastParagraph","length","node","urlBase","types","type","attribs","href","index","LinkWithTooltip","require","default","name","class","transformNode","shouldShowTooltipForURL","text","children","data","htmlMaybeWithContentEnd","setState","color","isContentStart","layout","postscript","showTooltips","transform","__html","showToolTip"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AACA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,eAAP,IAA0BC,oBAA1B,QAAsD,mBAAtD;AAEA,SAASC,UAAT;AAgBA,WAAaC,IAAb;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;;AAAA,oFAMU;AACNC,MAAAA,IAAI,EAAE,MAAKC,KAAL,CAAWD,IAAX,IAAmB;AADnB,KANV;;AAAA,sGAgB4B,YAAM;AAAA,UACtBA,IADsB,GACb,MAAKE,KADQ,CACtBF,IADsB;AAAA,UAEtBG,YAFsB,GAEL,MAAKF,KAFA,CAEtBE,YAFsB,EAG9B;;AACA,UAAMC,WAAW,GAAGJ,IAAI,CAACK,OAAL,CAAa,oCAAb,EAAmD,EAAnD,CAApB;;AAEA,UAAIF,YAAJ,EAAkB;AAChB,YAAMG,GAAG,GAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAZ;AACAF,QAAAA,GAAG,CAACG,SAAJ,GAAgBL,WAAhB;AAEA,YAAMM,UAAU,GAAGJ,GAAG,CAACK,oBAAJ,CAAyB,GAAzB,CAAnB;AACA,YAAMC,aAAa,GACjBF,UAAU,CAACG,MAAX,IAAqBH,UAAU,CAACA,UAAU,CAACG,MAAX,GAAoB,CAArB,CADjC;;AAGA,YAAID,aAAJ,EAAmB;AACjB;AACAA,UAAAA,aAAa,CAACH,SAAd,GACEG,aAAa,CAACH,SAAd,GAA0B,oCAD5B;AAED;;AACD,eAAOH,GAAG,CAACG,SAAX;AACD;;AACD,aAAOL,WAAP;AACD,KAtCH;;AAAA,sGAwC4B,UAAAU,IAAI,EAAI;AAChC,UAAMC,OAAO,GAAG,wBAAhB;AACA,UAAMC,KAAK,GAAG,CAAC,SAAD,EAAY,OAAZ,CAAd;;AAEA,4BAAmBA,KAAnB,eAA0B;AAArB,YAAMC,IAAI,GAAID,KAAJ,IAAV;;AACH,YAAI,YAAWF,IAAI,CAACI,OAAL,CAAaC,IAAxB,EAA8BJ,OAAO,GAAGE,IAAxC,CAAJ,EAAmD;AACjD,iBAAO,IAAP;AACD;AACF;;AAED,aAAO,KAAP;AACD,KAnDH;;AAAA,4FAqDkB,UAACH,IAAD,EAAOM,KAAP,EAAiB;AAC/B;AACA;AACA,UAAMC,eAAe,GAAGC,OAAO,8BAAP,CAAsCC,OAA9D;;AAEA,UAAIT,IAAI,CAACU,IAAL,KAAc,GAAlB,EAAuB;AACrBV,QAAAA,IAAI,CAACU,IAAL,GAAY,KAAZ;AACAV,QAAAA,IAAI,CAACI,OAAL,CAAaO,KAAb,GAAqB,WAArB;AACA,eAAO5B,oBAAoB,CAACiB,IAAD,EAAOM,KAAP,EAAc,MAAKM,aAAnB,CAA3B;AACD;;AAED,UAAIZ,IAAI,CAACU,IAAL,KAAc,GAAd,IAAqB,MAAKG,uBAAL,CAA6Bb,IAA7B,CAAzB,EAA6D;AAC3D,YAAMK,IAAI,GAAGL,IAAI,CAACI,OAAL,CAAaC,IAA1B;AACA,YAAMS,IAAI,GAAGd,IAAI,CAACe,QAAL,CAAc,CAAd,KAAoBf,IAAI,CAACe,QAAL,CAAc,CAAd,EAAiBC,IAAlD;;AAEA,YAAIF,IAAJ,EAAU;AACR,iBACE,oBAAC,eAAD;AAAiB,YAAA,GAAG,EAAET,IAAI,GAAGC,KAA7B;AAAoC,YAAA,GAAG,EAAED;AAAzC,aACGS,IADH,CADF;AAKD;AACF;AACF,KA5EH;;AAAA;AAAA;;AAAA;AAAA;AAAA,wCAUsB;AAClB,UAAM5B,IAAI,GAAG,KAAK+B,uBAAL,EAAb;AAEA,WAAKC,QAAL,CAAc;AAAEhC,QAAAA,IAAI,EAAJA;AAAF,OAAd;AACD;AAdH;AAAA;AAAA,6BA8EW;AAAA,wBAQH,KAAKC,KARF;AAAA,UAEL4B,QAFK,eAELA,QAFK;AAAA,UAGLI,KAHK,eAGLA,KAHK;AAAA,UAILC,cAJK,eAILA,cAJK;AAAA,UAKLC,MALK,eAKLA,MALK;AAAA,UAMLC,UANK,eAMLA,UANK;AAAA,UAOLC,YAPK,eAOLA,YAPK;AAAA,UASCrC,IATD,GASU,KAAKE,KATf,CASCF,IATD;AAWP,aACE,oBAAC,UAAD;AACE,QAAA,SAAS,EAAC,uBADZ;AAEE,QAAA,KAAK,EAAEiC,KAFT;AAGE,QAAA,cAAc,EAAEC,cAHlB;AAIE,QAAA,MAAM,EAAEC,MAJV;AAKE,QAAA,UAAU,EAAEC,UALd;AAME,QAAA,YAAY,EAAEC;AANhB,SAQGrC,IAAI,CAACa,MAAL,GACCwB,YAAY,GACV,iCACGzC,eAAe,CAACI,IAAD,EAAO;AAAEsC,QAAAA,SAAS,EAAE,KAAKZ;AAAlB,OAAP,CADlB,CADU,GAKV;AAAK,QAAA,uBAAuB,EAAE;AAAEa,UAAAA,MAAM,EAAEvC;AAAV;AAA9B,QANH,GASC6B,QAjBJ,CADF;AAsBD;AA/GH;;AAAA;AAAA,EAA0BlC,SAA1B;;gBAAaI,I,kBACW;AACpBkC,EAAAA,KAAK,EAAE,OADa;AAEpBO,EAAAA,WAAW,EAAE;AAFO,C","sourcesContent":["import { startsWith } from \"lodash\"\nimport React, { Component } from \"react\"\nimport ReactHtmlParser, { convertNodeToElement } from \"react-html-parser\"\nimport { ArticleLayout } from \"../Typings\"\nimport { StyledText } from \"./StyledText\"\n\ninterface Props extends React.HTMLProps<HTMLDivElement> {\n  color?: string\n  html?: string\n  isContentEnd?: boolean\n  isContentStart?: boolean\n  layout: ArticleLayout\n  postscript?: boolean\n  showTooltips?: boolean\n}\n\ninterface State {\n  html: string\n}\n\nexport class Text extends Component<Props, State> {\n  static defaultProps = {\n    color: \"black\",\n    showToolTip: false,\n  }\n\n  state = {\n    html: this.props.html || \"\",\n  }\n\n  componentDidMount() {\n    const html = this.htmlMaybeWithContentEnd()\n\n    this.setState({ html })\n  }\n\n  htmlMaybeWithContentEnd = () => {\n    const { html } = this.state\n    const { isContentEnd } = this.props\n    // Remove existing spans - TODO: Backfill out of articles\n    const cleanedHtml = html.replace(\"<span class='content-end'> </span>\", \"\")\n\n    if (isContentEnd) {\n      const doc = document.createElement(\"div\")\n      doc.innerHTML = cleanedHtml\n\n      const paragraphs = doc.getElementsByTagName(\"P\")\n      const lastParagraph =\n        paragraphs.length && paragraphs[paragraphs.length - 1]\n\n      if (lastParagraph) {\n        // insert content-end in last paragraph\n        lastParagraph.innerHTML =\n          lastParagraph.innerHTML + \"<span class='content-end'> </span>\"\n      }\n      return doc.innerHTML\n    }\n    return cleanedHtml\n  }\n\n  shouldShowTooltipForURL = node => {\n    const urlBase = \"https://www.artsy.net/\"\n    const types = [\"artist/\", \"gene/\"]\n\n    for (const type of types) {\n      if (startsWith(node.attribs.href, urlBase + type)) {\n        return true\n      }\n    }\n\n    return false\n  }\n\n  transformNode = (node, index) => {\n    // Dont include relay components unless necessary\n    // To avoid 'regeneratorRuntime' error\n    const LinkWithTooltip = require(\"../ToolTip/LinkWithTooltip\").default\n\n    if (node.name === \"p\") {\n      node.name = \"div\"\n      node.attribs.class = \"paragraph\"\n      return convertNodeToElement(node, index, this.transformNode)\n    }\n\n    if (node.name === \"a\" && this.shouldShowTooltipForURL(node)) {\n      const href = node.attribs.href\n      const text = node.children[0] && node.children[0].data\n\n      if (text) {\n        return (\n          <LinkWithTooltip key={href + index} url={href}>\n            {text}\n          </LinkWithTooltip>\n        )\n      }\n    }\n  }\n\n  render() {\n    const {\n      children,\n      color,\n      isContentStart,\n      layout,\n      postscript,\n      showTooltips,\n    } = this.props\n    const { html } = this.state\n\n    return (\n      <StyledText\n        className=\"article__text-section\"\n        color={color}\n        isContentStart={isContentStart}\n        layout={layout}\n        postscript={postscript}\n        showTooltips={showTooltips}\n      >\n        {html.length ? (\n          showTooltips ? (\n            <div>\n              {ReactHtmlParser(html, { transform: this.transformNode })}\n            </div>\n          ) : (\n            <div dangerouslySetInnerHTML={{ __html: html }} />\n          )\n        ) : (\n          children\n        )}\n      </StyledText>\n    )\n  }\n}\n"]}]}