{"remainingRequest":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js??ref--5-1!/Users/eve/development/reaction/src/Components/Artsy.tsx","dependencies":[{"path":"/Users/eve/development/reaction/src/Components/Artsy.tsx","mtime":1524585020000},{"path":"/Users/eve/development/reaction/.babelrc","mtime":1527877289000},{"path":"/Users/eve/development/reaction/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js","mtime":1509489566000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ContextConsumer = ContextConsumer;\nexports.ContextProvider = void 0;\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createEnvironment = require(\"../Relay/createEnvironment\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nvar ContextTypes = {\n  _isNestedInProvider: _propTypes.default.bool,\n  currentUser: _propTypes.default.object,\n  relayEnvironment: _propTypes.default.object\n  /**\n   * This component provides Artsy specific context props to components down the tree. Components that wish to consume\n   * these props should be wrapped with the `ContextConsumer` higher-order component.\n   *\n   * @see {@link ContextConsumer}\n   */\n\n};\n\nvar ContextProvider =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ContextProvider, _React$Component);\n\n  function ContextProvider(props) {\n    var _this;\n\n    _classCallCheck(this, ContextProvider);\n\n    if (_react.default.Children.count(props.children) > 1) {\n      throw new Error(\"A ContextProvider expects a single child.\");\n    }\n\n    _this = _possibleConstructorReturn(this, (ContextProvider.__proto__ || Object.getPrototypeOf(ContextProvider)).call(this, props));\n    Object.defineProperty(_assertThisInitialized(_this), \"currentUser\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_assertThisInitialized(_this), \"relayEnvironment\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: void 0\n    });\n\n    if (props.currentUser) {\n      _this.currentUser = props.currentUser;\n    } else if (props.currentUser === undefined) {\n      var id = process.env.USER_ID;\n      var accessToken = process.env.USER_ACCESS_TOKEN;\n\n      if (id && accessToken) {\n        _this.currentUser = {\n          id: id,\n          accessToken: accessToken\n        };\n      }\n    }\n\n    _this.relayEnvironment = props.relayEnvironment || (0, _createEnvironment.createEnvironment)(_this.currentUser);\n    return _this;\n  }\n\n  _createClass(ContextProvider, [{\n    key: \"getChildContext\",\n    value: function getChildContext() {\n      return {\n        _isNestedInProvider: true,\n        currentUser: this.currentUser,\n        relayEnvironment: this.relayEnvironment\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return this.props.children;\n    }\n  }]);\n\n  return ContextProvider;\n}(_react.default.Component);\n/**\n * Wraps a component in a higher-order component that injects the Artsy specific context props into the given component.\n * Wrapped components are expected to be rendered in a tree that contains a `ContextProvider` component.\n *\n * The injected props are described in `ContextProps`.\n *\n * @see {@link ContextProvider}\n * @see {@link ContextProps}\n *\n * @param Component The component that needs Artsy specific context props.\n */\n\n\nexports.ContextProvider = ContextProvider;\nObject.defineProperty(ContextProvider, \"childContextTypes\", {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  value: ContextTypes\n});\n\nfunction ContextConsumer(Component) {\n  var _class, _temp;\n\n  var name = Component.displayName || Component.name;\n  return _temp = _class =\n  /*#__PURE__*/\n  function (_React$Component2) {\n    _inherits(_class, _React$Component2);\n\n    function _class(props, context) {\n      _classCallCheck(this, _class);\n\n      if (!context._isNestedInProvider) {\n        var start = name || \"A component\";\n        throw new Error(\"\".concat(start, \", which needs Artsy props, was not wrapped inside a ContextProvider component.\"));\n      }\n\n      return _possibleConstructorReturn(this, (_class.__proto__ || Object.getPrototypeOf(_class)).call(this, props, context));\n    }\n\n    _createClass(_class, [{\n      key: \"render\",\n      value: function render() {\n        var _context = this.context,\n            currentUser = _context.currentUser,\n            relayEnvironment = _context.relayEnvironment;\n        var props = Object.assign({\n          currentUser: currentUser,\n          relayEnvironment: relayEnvironment\n        }, this.props);\n        return _react.default.createElement(Component, props);\n      }\n    }]);\n\n    return _class;\n  }(_react.default.Component), Object.defineProperty(_class, \"contextTypes\", {\n    configurable: true,\n    enumerable: true,\n    writable: true,\n    value: ContextTypes\n  }), Object.defineProperty(_class, \"displayName\", {\n    configurable: true,\n    enumerable: true,\n    writable: true,\n    value: \"Artsy(\".concat(name, \")\")\n  }), _temp;\n}",{"version":3,"sources":["src/Components/Artsy.tsx"],"names":["ContextTypes","_isNestedInProvider","bool","currentUser","object","relayEnvironment","ContextProvider","props","Children","count","children","Error","undefined","id","process","env","USER_ID","accessToken","USER_ACCESS_TOKEN","Component","ContextConsumer","name","displayName","context","start","Object","assign"],"mappings":";;;;;;;;AAAA;;AACA;;AAEA;;;;;;;;;;;;;;;;;;AAqCA,IAAMA,eAAyD;AAC7DC,uBAAqB,mBAAUC,IAD8B;AAE7DC,eAAa,mBAAUC,MAFsC;AAG7DC,oBAAkB,mBAAUD;AAG9B;;;;;;;AAN+D,CAA/D;;IAYaE,e;;;;;AAOX,2BAAYC,KAAZ,EAAkE;AAAA;;AAAA;;AAChE,QAAI,eAAMC,QAAN,CAAeC,KAAf,CAAqBF,MAAMG,QAA3B,IAAuC,CAA3C,EAA8C;AAC5C,YAAM,IAAIC,KAAJ,CAAU,2CAAV,CAAN;AACD;;AACD,8HAAMJ,KAAN;AAJgE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAMhE,QAAIA,MAAMJ,WAAV,EAAuB;AACrB,YAAKA,WAAL,GAAmBI,MAAMJ,WAAzB;AACD,KAFD,MAEO,IAAII,MAAMJ,WAAN,KAAsBS,SAA1B,EAAqC;AAC1C,UAAMC,KAAKC,QAAQC,GAAR,CAAYC,OAAvB;AACA,UAAMC,cAAcH,QAAQC,GAAR,CAAYG,iBAAhC;;AACA,UAAIL,MAAMI,WAAV,EAAuB;AACrB,cAAKd,WAAL,GAAmB;AAAEU,gBAAF;AAAMI;AAAN,SAAnB;AACD;AACF;;AAED,UAAKZ,gBAAL,GACEE,MAAMF,gBAAN,IAA0B,0CAAkB,MAAKF,WAAvB,CAD5B;AAhBgE;AAkBjE;;;;sCAEiB;AAChB,aAAO;AACLF,6BAAqB,IADhB;AAELE,qBAAa,KAAKA,WAFb;AAGLE,0BAAkB,KAAKA;AAHlB,OAAP;AAKD;;;6BAEQ;AACP,aAAO,KAAKE,KAAL,CAAWG,QAAlB;AACD;;;;EArCkC,eAAMS,S;AAwC3C;;;;;;;;;;;;;;sBAxCab,e;;;;SAEgBN;;;AAiDtB,SAASoB,eAAT,CACLD,SADK,EAEoB;AAAA;;AACzB,MAAME,OAAOF,UAAUG,WAAV,IAAyBH,UAAUE,IAAhD;AACA;AAAA;AAAA;AAAA;;AAIE,oBAAYd,KAAZ,EAAsBgB,OAAtB,EAAoD;AAAA;;AAClD,UAAI,CAACA,QAAQtB,mBAAb,EAAkC;AAChC,YAAMuB,QAAQH,QAAQ,aAAtB;AACA,cAAM,IAAIV,KAAJ,WACDa,KADC,oFAAN;AAGD;;AANiD,6GAO5CjB,KAP4C,EAOrCgB,OAPqC;AAQnD;;AAZH;AAAA;AAAA,+BAcW;AAAA,uBACmC,KAAKA,OADxC;AAAA,YACCpB,WADD,YACCA,WADD;AAAA,YACcE,gBADd,YACcA,gBADd;AAEP,YAAME,QAAQkB,OAAOC,MAAP,CAAc;AAAEvB,kCAAF;AAAeE;AAAf,SAAd,EAAiD,KAAKE,KAAtD,CAAd;AACA,eAAO,6BAAC,SAAD,EAAeA,KAAf,CAAP;AACD;AAlBH;;AAAA;AAAA,IAAqB,eAAMY,SAA3B;AAAA;AAAA;AAAA;AAAA,WACwBnB;AADxB;AAAA;AAAA;AAAA;AAAA,2BAEgCqB,IAFhC;AAAA;AAoBD","file":"/Users/eve/development/reaction/src/Components/Artsy.tsx","sourceRoot":"/Users/eve/development/reaction","sourcesContent":["import PropTypes from \"prop-types\"\nimport React from \"react\"\nimport { Environment } from \"relay-runtime\"\nimport { createEnvironment } from \"../Relay/createEnvironment\"\n\n// TODO: Once this PR for `rest` https://github.com/Microsoft/TypeScript/pull/13470 lands\n// weâ€™ll be able to not make this optional and simply remove it from the props that a\n// component wrapped with the `ContextConsumer` HOC accepts.\n\n/**\n * The Artsy specific props injected by the higher-order component produced by `ContextConsumer`.\n *\n * @see {@link ContextProvider}\n * @see {@link ContextConsumer}\n *\n */\nexport interface ContextProps {\n  /**\n   * The currently signed-in user.\n   *\n   * Unless explicitely set to `null`, this will default to use the `USER_ID` and `USER_ACCESS_TOKEN` environment\n   * variables if available.\n   */\n  currentUser?: User | null\n\n  /**\n   * A configured environment object that can be used for any Relay operations  that need an environment object.\n   *\n   * If none is provided to the `ContextProvider` then one is created, using the `currentUser` if available.\n   */\n  relayEnvironment?: Environment\n}\n\ninterface PrivateContextProps extends ContextProps {\n  /**\n   * This prop solely exists to verify that a consumer is nested inside a provider.\n   */\n  _isNestedInProvider: boolean\n}\n\nconst ContextTypes: React.ValidationMap<PrivateContextProps> = {\n  _isNestedInProvider: PropTypes.bool,\n  currentUser: PropTypes.object,\n  relayEnvironment: PropTypes.object,\n}\n\n/**\n * This component provides Artsy specific context props to components down the tree. Components that wish to consume\n * these props should be wrapped with the `ContextConsumer` higher-order component.\n *\n * @see {@link ContextConsumer}\n */\nexport class ContextProvider extends React.Component<ContextProps, null>\n  implements React.ChildContextProvider<PrivateContextProps> {\n  static childContextTypes = ContextTypes\n\n  private currentUser: User | null\n  private relayEnvironment: Environment\n\n  constructor(props: ContextProps & { children?: React.ReactNode }) {\n    if (React.Children.count(props.children) > 1) {\n      throw new Error(\"A ContextProvider expects a single child.\")\n    }\n    super(props)\n\n    if (props.currentUser) {\n      this.currentUser = props.currentUser\n    } else if (props.currentUser === undefined) {\n      const id = process.env.USER_ID\n      const accessToken = process.env.USER_ACCESS_TOKEN\n      if (id && accessToken) {\n        this.currentUser = { id, accessToken }\n      }\n    }\n\n    this.relayEnvironment =\n      props.relayEnvironment || createEnvironment(this.currentUser)\n  }\n\n  getChildContext() {\n    return {\n      _isNestedInProvider: true,\n      currentUser: this.currentUser,\n      relayEnvironment: this.relayEnvironment,\n    }\n  }\n\n  render() {\n    return this.props.children as any\n  }\n}\n\n/**\n * Wraps a component in a higher-order component that injects the Artsy specific context props into the given component.\n * Wrapped components are expected to be rendered in a tree that contains a `ContextProvider` component.\n *\n * The injected props are described in `ContextProps`.\n *\n * @see {@link ContextProvider}\n * @see {@link ContextProps}\n *\n * @param Component The component that needs Artsy specific context props.\n */\nexport function ContextConsumer<P>(\n  Component: React.ComponentClass<P> | React.StatelessComponent<P>\n): React.ComponentClass<P> {\n  const name = Component.displayName || Component.name\n  return class extends React.Component<P, null> {\n    static contextTypes = ContextTypes\n    static displayName = `Artsy(${name})`\n\n    constructor(props: P, context: PrivateContextProps) {\n      if (!context._isNestedInProvider) {\n        const start = name || \"A component\"\n        throw new Error(\n          `${start}, which needs Artsy props, was not wrapped inside a ContextProvider component.`\n        )\n      }\n      super(props, context)\n    }\n\n    render() {\n      const { currentUser, relayEnvironment } = this.context\n      const props = Object.assign({ currentUser, relayEnvironment }, this.props)\n      return <Component {...props} />\n    }\n  }\n}\n"]}]}