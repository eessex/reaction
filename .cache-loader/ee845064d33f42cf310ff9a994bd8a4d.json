{"remainingRequest":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js??ref--6-1!/Users/eve/development/reaction/src/Styleguide/Components/ReadMore.tsx","dependencies":[{"path":"/Users/eve/development/reaction/src/Styleguide/Components/ReadMore.tsx","mtime":1535727457000},{"path":"/Users/eve/development/reaction/.babelrc","mtime":1537112679000},{"path":"/Users/eve/development/reaction/node_modules/cache-loader/dist/cjs.js","mtime":0},{"path":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _isString from \"lodash/isString\";\n\nvar _dec, _dec2, _class, _class2, _class3, _temp;\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object['ke' + 'ys'](descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object['define' + 'Property'](target, property, desc); desc = null; } return desc; }\n\nimport { track } from \"../../Artsy/Analytics\";\nimport * as Schema from \"../../Artsy/Analytics/Schema\";\nimport React, { Component } from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport styled from \"styled-components\";\nimport truncate from \"trunc-html\";\nexport var ReadMore = (_dec = track(), _dec2 = track({\n  action_type: Schema.ActionType.Click,\n  subject: \"Read more\"\n}), _dec(_class = (_class2 = (_temp = _class3 =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ReadMore, _Component);\n\n  function ReadMore(props) {\n    var _this;\n\n    _classCallCheck(this, ReadMore);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ReadMore).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"html\", void 0);\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      isExpanded: true\n    });\n\n    _this.html = _isString(props.content) ? props.content : renderToStaticMarkup(React.createElement(React.Fragment, null, props.content));\n    var RE = /(<([^>]+)>)/gi; // Strip HTML tags to get innerText char count\n\n    var _this$html$replace = _this.html.replace(RE, \"\"),\n        length = _this$html$replace.length; //\n\n\n    var isExpanded = props.isExpanded || length < props.maxChars;\n    _this.state = {\n      isExpanded: isExpanded\n    };\n    return _this;\n  }\n\n  _createClass(ReadMore, [{\n    key: \"expandText\",\n    value: function expandText() {\n      var _this2 = this;\n\n      this.setState({\n        isExpanded: true\n      }, function () {\n        _this2.props.onReadMoreClicked && _this2.props.onReadMoreClicked();\n      });\n    }\n  }, {\n    key: \"getContent\",\n    value: function getContent() {\n      if (this.state.isExpanded) {\n        return this.html;\n      } else {\n        return truncate(this.html, this.props.maxChars).html;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var content = this.getContent();\n      return React.createElement(Container, {\n        onClick: this.expandText.bind(this),\n        isExpanded: true\n      }, React.createElement(\"span\", {\n        dangerouslySetInnerHTML: {\n          __html: content\n        }\n      }), !this.state.isExpanded && React.createElement(ReadMoreLink, null, \"Read more\"));\n    }\n  }]);\n\n  return ReadMore;\n}(Component), _defineProperty(_class3, \"defaultProps\", {\n  isExpanded: false,\n  maxChars: Infinity\n}), _temp), (_applyDecoratedDescriptor(_class2.prototype, \"expandText\", [_dec2], Object.getOwnPropertyDescriptor(_class2.prototype, \"expandText\"), _class2.prototype)), _class2)) || _class);\n\nvar ReadMoreLink = function ReadMoreLink(_ref) {\n  var children = _ref.children;\n  return React.createElement(\"span\", null, \" \", React.createElement(ReadMoreLinkContainer, null, React.createElement(ReadMoreLinkText, null, children)));\n};\n\nvar ReadMoreLinkContainer = styled.span.withConfig({\n  displayName: \"ReadMore__ReadMoreLinkContainer\",\n  componentId: \"s178fy9-0\"\n})([\"cursor:pointer;text-decoration:underline;display:inline-block;\"]); // NOTE: Couldn't use @artsy/palette / Sans due to root element being a `div`;\n// as html content from CMS comes through as a p tag, markup is rendered invalid.\n\nvar ReadMoreLinkText = styled.span.withConfig({\n  displayName: \"ReadMore__ReadMoreLinkText\",\n  componentId: \"s178fy9-1\"\n})([\"display:inline;font-family:Unica77LLWebMedium,\\\"Helvetica Neue\\\",Helvetica,Arial,sans-serif;font-weight:500;font-size:12px;line-height:16px;\"]);\nvar Container = styled.div.attrs({}).withConfig({\n  displayName: \"ReadMore__Container\",\n  componentId: \"s178fy9-2\"\n})([\"cursor:\", \";> span > *{display:inline;}\"], function (p) {\n  return p.isExpanded ? \"auto\" : \"pointer\";\n});\nContainer.displayName = \"Container\";",{"version":3,"sources":["/Users/eve/development/reaction/src/Styleguide/Components/ReadMore.tsx"],"names":["track","Schema","React","Component","renderToStaticMarkup","styled","truncate","ReadMore","action_type","ActionType","Click","subject","props","isExpanded","html","content","RE","replace","length","maxChars","state","setState","onReadMoreClicked","getContent","expandText","bind","__html","Infinity","ReadMoreLink","children","ReadMoreLinkContainer","span","ReadMoreLinkText","Container","div","attrs","p","displayName"],"mappings":"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","sourcesContent":["import { track } from \"Artsy/Analytics\"\nimport * as Schema from \"Artsy/Analytics/Schema\"\nimport { isString } from \"lodash\"\nimport React, { Component } from \"react\"\nimport { renderToStaticMarkup } from \"react-dom/server\"\nimport styled from \"styled-components\"\nimport { DisplayProps } from \"styled-system\"\nimport truncate from \"trunc-html\"\n\nexport interface ReadMoreProps extends DisplayProps {\n  isExpanded?: boolean\n  maxChars?: number\n  onReadMoreClicked?: () => void\n  content: string | JSX.Element\n}\n\nexport interface ReadMoreState {\n  isExpanded: boolean\n}\n\n@track()\nexport class ReadMore extends Component<ReadMoreProps, ReadMoreState> {\n  private html: string\n\n  state = {\n    isExpanded: true,\n  }\n\n  static defaultProps = {\n    isExpanded: false,\n    maxChars: Infinity,\n  }\n\n  constructor(props) {\n    super(props)\n\n    this.html = isString(props.content)\n      ? props.content\n      : renderToStaticMarkup(<>{props.content}</>)\n\n    const RE = /(<([^>]+)>)/gi // Strip HTML tags to get innerText char count\n    const { length } = this.html.replace(RE, \"\") //\n    const isExpanded = props.isExpanded || length < props.maxChars\n\n    this.state = {\n      isExpanded,\n    }\n  }\n\n  @track({\n    action_type: Schema.ActionType.Click,\n    subject: \"Read more\",\n  })\n  expandText() {\n    this.setState(\n      {\n        isExpanded: true,\n      },\n      () => {\n        this.props.onReadMoreClicked && this.props.onReadMoreClicked()\n      }\n    )\n  }\n\n  getContent() {\n    if (this.state.isExpanded) {\n      return this.html\n    } else {\n      return truncate(this.html, this.props.maxChars).html\n    }\n  }\n\n  render() {\n    const content = this.getContent()\n\n    return (\n      <Container onClick={this.expandText.bind(this)} isExpanded>\n        <span\n          dangerouslySetInnerHTML={{\n            __html: content,\n          }}\n        />\n\n        {!this.state.isExpanded && <ReadMoreLink>Read more</ReadMoreLink>}\n      </Container>\n    )\n  }\n}\n\nconst ReadMoreLink = ({ children }) => {\n  return (\n    <span>\n      {\" \"}\n      <ReadMoreLinkContainer>\n        <ReadMoreLinkText>{children}</ReadMoreLinkText>\n      </ReadMoreLinkContainer>\n    </span>\n  )\n}\n\nconst ReadMoreLinkContainer = styled.span`\n  cursor: pointer;\n  text-decoration: underline;\n  display: inline-block;\n`\n\n// NOTE: Couldn't use @artsy/palette / Sans due to root element being a `div`;\n// as html content from CMS comes through as a p tag, markup is rendered invalid.\nconst ReadMoreLinkText = styled.span`\n  display: inline;\n  font-family: Unica77LLWebMedium, \"Helvetica Neue\", Helvetica, Arial,\n    sans-serif;\n  font-weight: 500;\n  font-size: 12px;\n  line-height: 16px;\n`\n\nconst Container = styled.div.attrs<ReadMoreState>({})`\n  cursor: ${p => (p.isExpanded ? \"auto\" : \"pointer\")};\n\n  > span > * {\n    display: inline;\n  }\n`\n\nContainer.displayName = \"Container\"\n"]}]}