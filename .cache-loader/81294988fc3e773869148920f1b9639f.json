{"remainingRequest":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js??ref--5-1!/Users/eve/development/reaction/src/Components/Publishing/ToolTip/ToolTipsDataLoader.tsx","dependencies":[{"path":"/Users/eve/development/reaction/src/Components/Publishing/ToolTip/ToolTipsDataLoader.tsx","mtime":1527882126000},{"path":"/Users/eve/development/reaction/.babelrc","mtime":1527877289000},{"path":"/Users/eve/development/reaction/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js","mtime":1509489566000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ToolTipsData = exports.ToolTipsDataLoader = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactRelay = require(\"react-relay\");\n\nvar _Constants = require(\"../Constants\");\n\nvar _lodash = require(\"lodash\");\n\nvar Artsy = _interopRequireWildcard(require(\"../../Artsy\"));\n\nvar _graphql;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ToolTipsDataLoader =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ToolTipsDataLoader, _Component);\n\n  function ToolTipsDataLoader() {\n    _classCallCheck(this, ToolTipsDataLoader);\n\n    return _possibleConstructorReturn(this, (ToolTipsDataLoader.__proto__ || Object.getPrototypeOf(ToolTipsDataLoader)).apply(this, arguments));\n  }\n\n  _createClass(ToolTipsDataLoader, [{\n    key: \"render\",\n    value: function render() {\n      var _props = this.props,\n          article = _props.article,\n          children = _props.children,\n          currentUser = _props.currentUser,\n          relayEnvironment = _props.relayEnvironment,\n          shouldFetchData = _props.shouldFetchData,\n          onOpenAuthModal = _props.onOpenAuthModal;\n\n      var _getArtsySlugsFromArt = (0, _Constants.getArtsySlugsFromArticle)(article),\n          artistSlugs = _getArtsySlugsFromArt.artists,\n          geneSlugs = _getArtsySlugsFromArt.genes;\n\n      if (!shouldFetchData) {\n        return children;\n      }\n\n      return _react.default.createElement(_reactRelay.QueryRenderer, {\n        environment: relayEnvironment,\n        query: _graphql || (_graphql = function _graphql() {\n          var node = require(\"../../../__generated__/ToolTipsDataLoaderQuery.graphql\");\n\n          if (node.hash && node.hash !== \"3b83310a87e2c55b16654234edd413aa\") {\n            console.error(\"The definition of 'ToolTipsDataLoaderQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data.\");\n          }\n\n          return require(\"../../../__generated__/ToolTipsDataLoaderQuery.graphql\");\n        }),\n        variables: {\n          artistSlugs: artistSlugs,\n          geneSlugs: geneSlugs\n        },\n        render: function render(readyState) {\n          var data = {\n            artists: [],\n            genes: []\n          };\n          Object.keys(readyState.props || {}).forEach(function (key) {\n            var col = readyState.props[key];\n            data[key] = (0, _lodash.keyBy)(col, \"id\");\n          });\n          return _react.default.createElement(ToolTipsContextProvider, _extends({}, data, {\n            currentUser: currentUser,\n            onOpenAuthModal: onOpenAuthModal\n          }), children);\n        }\n      });\n    }\n  }]);\n\n  return ToolTipsDataLoader;\n}(_react.Component);\n\nexports.ToolTipsDataLoader = ToolTipsDataLoader;\nObject.defineProperty(ToolTipsDataLoader, \"defaultProps\", {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  value: {\n    shouldFetchData: true\n  }\n});\n\nvar ToolTipsContextProvider =\n/*#__PURE__*/\nfunction (_Component2) {\n  _inherits(ToolTipsContextProvider, _Component2);\n\n  function ToolTipsContextProvider() {\n    var _ref;\n\n    var _temp, _this;\n\n    _classCallCheck(this, ToolTipsContextProvider);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _possibleConstructorReturn(_this, (_temp = _this = _possibleConstructorReturn(this, (_ref = ToolTipsContextProvider.__proto__ || Object.getPrototypeOf(ToolTipsContextProvider)).call.apply(_ref, [this].concat(args))), Object.defineProperty(_assertThisInitialized(_this), \"state\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: {\n        activeToolTip: null,\n        waitForFade: null\n      }\n    }), Object.defineProperty(_assertThisInitialized(_this), \"onTriggerToolTip\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: function value(activeToolTip) {\n        if (activeToolTip !== _this.state.activeToolTip) {\n          if (activeToolTip === null) {\n            setTimeout(function () {\n              _this.setState({\n                waitForFade: null\n              });\n            }, 250);\n          }\n\n          _this.setState({\n            activeToolTip: activeToolTip,\n            waitForFade: _this.state.activeToolTip\n          });\n        }\n      }\n    }), _temp));\n  }\n\n  _createClass(ToolTipsContextProvider, [{\n    key: \"getChildContext\",\n    value: function getChildContext() {\n      var _props2 = this.props,\n          artists = _props2.artists,\n          currentUser = _props2.currentUser,\n          genes = _props2.genes,\n          onOpenAuthModal = _props2.onOpenAuthModal;\n      var _state = this.state,\n          activeToolTip = _state.activeToolTip,\n          waitForFade = _state.waitForFade;\n      return {\n        activeToolTip: activeToolTip,\n        currentUser: currentUser,\n        onOpenAuthModal: onOpenAuthModal,\n        onTriggerToolTip: this.onTriggerToolTip,\n        toolTipsData: {\n          artists: artists,\n          genes: genes\n        },\n        waitForFade: waitForFade\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return this.props.children;\n    }\n  }]);\n\n  return ToolTipsContextProvider;\n}(_react.Component);\n\nObject.defineProperty(ToolTipsContextProvider, \"childContextTypes\", {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  value: {\n    activeToolTip: _propTypes.default.any,\n    currentUser: _propTypes.default.object,\n    onOpenAuthModal: _propTypes.default.func,\n    onTriggerToolTip: _propTypes.default.func,\n    toolTipsData: _propTypes.default.object,\n    waitForFade: _propTypes.default.string\n  }\n});\nvar ToolTipsData = Artsy.ContextConsumer(ToolTipsDataLoader);\nexports.ToolTipsData = ToolTipsData;",{"version":3,"sources":["src/Components/Publishing/ToolTip/ToolTipsDataLoader.tsx"],"names":["ToolTipsDataLoader","props","article","children","currentUser","relayEnvironment","shouldFetchData","onOpenAuthModal","artistSlugs","artists","geneSlugs","genes","data","Object","keys","readyState","forEach","col","key","ToolTipsContextProvider","activeToolTip","waitForFade","state","setTimeout","setState","onTriggerToolTip","toolTipsData","any","object","func","string","ToolTipsData","Artsy","ContextConsumer"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAGA;;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;IAQaA,kB;;;;;;;;;;;;;6BAKF;AAAA,mBAQH,KAAKC,KARF;AAAA,UAELC,OAFK,UAELA,OAFK;AAAA,UAGLC,QAHK,UAGLA,QAHK;AAAA,UAILC,WAJK,UAILA,WAJK;AAAA,UAKLC,gBALK,UAKLA,gBALK;AAAA,UAMLC,eANK,UAMLA,eANK;AAAA,UAOLC,eAPK,UAOLA,eAPK;;AAAA,kCAU4C,yCACjDL,OADiD,CAV5C;AAAA,UAUUM,WAVV,yBAUCC,OAVD;AAAA,UAU8BC,SAV9B,yBAUuBC,KAVvB;;AAcP,UAAI,CAACL,eAAL,EAAsB;AACpB,eAAOH,QAAP;AACD;;AAED,aACE;AACE,qBAAaE,gBADf;AAEE;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA,UAFF;AAsBE,mBAAW;AACTG,kCADS;AAETE;AAFS,SAtBb;AA0BE,gBAAQ,4BAAc;AACpB,cAAME,OAAwC;AAC5CH,qBAAS,EADmC;AAE5CE,mBAAO;AAFqC,WAA9C;AAIAE,iBAAOC,IAAP,CAAYC,WAAWd,KAAX,IAAoB,EAAhC,EAAoCe,OAApC,CAA4C,eAAO;AACjD,gBAAMC,MAAMF,WAAWd,KAAX,CAAiBiB,GAAjB,CAAZ;AACAN,iBAAKM,GAAL,IAAY,mBAAMD,GAAN,EAAW,IAAX,CAAZ;AACD,WAHD;AAIA,iBACE,6BAAC,uBAAD,eACML,IADN;AAEE,yBAAaR,WAFf;AAGE,6BAAiBG;AAHnB,cAKGJ,QALH,CADF;AASD;AA5CH,QADF;AAgDD;;;;;;;sBAvEUH,kB;;;;SACW;AACpBM,qBAAiB;AADG;;;IAyElBa,uB;;;;;;;;;;;;;;;;;;;;aAUI;AACNC,uBAAe,IADT;AAENC,qBAAa;AAFP;;;;;aAKW,8BAAiB;AAClC,YAAID,kBAAkB,MAAKE,KAAL,CAAWF,aAAjC,EAAgD;AAC9C,cAAIA,kBAAkB,IAAtB,EAA4B;AAC1BG,uBAAW,YAAM;AACf,oBAAKC,QAAL,CAAc;AAAEH,6BAAa;AAAf,eAAd;AACD,aAFD,EAEG,GAFH;AAGD;;AACD,gBAAKG,QAAL,CAAc;AAAEJ,wCAAF;AAAiBC,yBAAa,MAAKC,KAAL,CAAWF;AAAzC,WAAd;AACD;AACF;;;;;;sCAEiB;AAAA,oBACyC,KAAKnB,KAD9C;AAAA,UACRQ,OADQ,WACRA,OADQ;AAAA,UACCL,WADD,WACCA,WADD;AAAA,UACcO,KADd,WACcA,KADd;AAAA,UACqBJ,eADrB,WACqBA,eADrB;AAAA,mBAEuB,KAAKe,KAF5B;AAAA,UAERF,aAFQ,UAERA,aAFQ;AAAA,UAEOC,WAFP,UAEOA,WAFP;AAIhB,aAAO;AACLD,oCADK;AAELhB,gCAFK;AAGLG,wCAHK;AAILkB,0BAAkB,KAAKA,gBAJlB;AAKLC,sBAAc;AACZjB,0BADY;AAEZE;AAFY,SALT;AASLU;AATK,OAAP;AAWD;;;6BAEQ;AACP,aAAO,KAAKpB,KAAL,CAAWE,QAAlB;AACD;;;;;;sBA7CGgB,uB;;;;SACuB;AACzBC,mBAAe,mBAAUO,GADA;AAEzBvB,iBAAa,mBAAUwB,MAFE;AAGzBrB,qBAAiB,mBAAUsB,IAHF;AAIzBJ,sBAAkB,mBAAUI,IAJH;AAKzBH,kBAAc,mBAAUE,MALC;AAMzBP,iBAAa,mBAAUS;AANE;;AA+CtB,IAAMC,eAAeC,MAAMC,eAAN,CAAsBjC,kBAAtB,CAArB","file":"/Users/eve/development/reaction/src/Components/Publishing/ToolTip/ToolTipsDataLoader.tsx","sourceRoot":"/Users/eve/development/reaction","sourcesContent":["import React, { Component } from \"react\"\nimport PropTypes from \"prop-types\"\nimport { QueryRenderer, graphql } from \"react-relay\"\nimport { ArticleProps } from \"../Article\"\nimport { ArticleData } from \"Components/Publishing/Typings\"\nimport { getArtsySlugsFromArticle } from \"Components/Publishing/Constants\"\nimport { keyBy } from \"lodash\"\nimport { ToolTipsDataLoaderQueryResponse } from \"__generated__/ToolTipsDataLoaderQuery.graphql\"\nimport * as Artsy from \"Components/Artsy\"\n\ninterface Props extends Artsy.ContextProps {\n  article: ArticleData\n  shouldFetchData?: boolean\n  onOpenAuthModal?: ArticleProps[\"onOpenAuthModal\"]\n}\n\nexport class ToolTipsDataLoader extends Component<Props> {\n  static defaultProps = {\n    shouldFetchData: true,\n  }\n\n  render() {\n    const {\n      article,\n      children,\n      currentUser,\n      relayEnvironment,\n      shouldFetchData,\n      onOpenAuthModal,\n    } = this.props\n\n    const { artists: artistSlugs, genes: geneSlugs } = getArtsySlugsFromArticle(\n      article\n    )\n\n    if (!shouldFetchData) {\n      return children\n    }\n\n    return (\n      <QueryRenderer\n        environment={relayEnvironment}\n        query={graphql`\n          query ToolTipsDataLoaderQuery(\n            $artistSlugs: [String!]\n            $geneSlugs: [String!]\n          ) {\n            artists(slugs: $artistSlugs) {\n              id\n              _id\n              ...ArtistToolTip_artist\n              ...MarketDataSummary_artist\n              ...FollowArtistButton_artist\n            }\n            genes(slugs: $geneSlugs) {\n              id\n              _id\n              ...GeneToolTip_gene\n              ...FollowGeneButton_gene\n            }\n          }\n        `}\n        variables={{\n          artistSlugs,\n          geneSlugs,\n        }}\n        render={readyState => {\n          const data: ToolTipsDataLoaderQueryResponse = {\n            artists: [],\n            genes: [],\n          }\n          Object.keys(readyState.props || {}).forEach(key => {\n            const col = readyState.props[key]\n            data[key] = keyBy(col, \"id\")\n          })\n          return (\n            <ToolTipsContextProvider\n              {...data}\n              currentUser={currentUser}\n              onOpenAuthModal={onOpenAuthModal}\n            >\n              {children}\n            </ToolTipsContextProvider>\n          )\n        }}\n      />\n    )\n  }\n}\n\nclass ToolTipsContextProvider extends Component<any> {\n  static childContextTypes = {\n    activeToolTip: PropTypes.any,\n    currentUser: PropTypes.object,\n    onOpenAuthModal: PropTypes.func,\n    onTriggerToolTip: PropTypes.func,\n    toolTipsData: PropTypes.object,\n    waitForFade: PropTypes.string,\n  }\n\n  state = {\n    activeToolTip: null,\n    waitForFade: null,\n  }\n\n  onTriggerToolTip = activeToolTip => {\n    if (activeToolTip !== this.state.activeToolTip) {\n      if (activeToolTip === null) {\n        setTimeout(() => {\n          this.setState({ waitForFade: null })\n        }, 250)\n      }\n      this.setState({ activeToolTip, waitForFade: this.state.activeToolTip })\n    }\n  }\n\n  getChildContext() {\n    const { artists, currentUser, genes, onOpenAuthModal } = this.props\n    const { activeToolTip, waitForFade } = this.state\n\n    return {\n      activeToolTip,\n      currentUser,\n      onOpenAuthModal,\n      onTriggerToolTip: this.onTriggerToolTip,\n      toolTipsData: {\n        artists,\n        genes,\n      },\n      waitForFade,\n    }\n  }\n\n  render() {\n    return this.props.children\n  }\n}\n\nexport const ToolTipsData = Artsy.ContextConsumer(ToolTipsDataLoader)\n"]}]}