{"remainingRequest":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js??ref--5-1!/Users/eve/development/reaction/src/Components/Publishing/Sections/ImageWrapper.tsx","dependencies":[{"path":"/Users/eve/development/reaction/src/Components/Publishing/Sections/ImageWrapper.tsx","mtime":1523989907000},{"path":"/Users/eve/development/reaction/.babelrc","mtime":1527877289000},{"path":"/Users/eve/development/reaction/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js","mtime":1509489566000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ImageWrapper = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _reactDom = _interopRequireDefault(require(\"react-dom\"));\n\nvar _styledComponents = _interopRequireDefault(require(\"styled-components\"));\n\nvar _Helpers = require(\"../../Helpers\");\n\nvar _ViewFullscreen = require(\"./ViewFullscreen\");\n\nvar _templateObject = /*#__PURE__*/ _taggedTemplateLiteral([\"\\n    \", \" {\\n      opacity: 1;\\n    }\\n  \"], [\"\\n    \", \" {\\n      opacity: 1;\\n    }\\n  \"]);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _taggedTemplateLiteral(strings, raw) { return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nvar ImageWrapper =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(ImageWrapper, _React$PureComponent);\n\n  function ImageWrapper() {\n    var _ref;\n\n    var _temp, _this;\n\n    _classCallCheck(this, ImageWrapper);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _possibleConstructorReturn(_this, (_temp = _this = _possibleConstructorReturn(this, (_ref = ImageWrapper.__proto__ || Object.getPrototypeOf(ImageWrapper)).call.apply(_ref, [this].concat(args))), Object.defineProperty(_assertThisInitialized(_this), \"image\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: undefined\n    }), Object.defineProperty(_assertThisInitialized(_this), \"mounted\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: false\n    }), Object.defineProperty(_assertThisInitialized(_this), \"state\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: {\n        isLoaded: false\n      }\n    }), Object.defineProperty(_assertThisInitialized(_this), \"onImageLoad\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: function value() {\n        if (_this.mounted) {\n          _this.setState({\n            isLoaded: true\n          });\n        }\n      }\n    }), _temp));\n  }\n\n  _createClass(ImageWrapper, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var img = new Image();\n      /**\n       * TODO: Clean this up\n       * Guard against snapshot tests See: https://reactjs.org/blog/2016/11/16/react-v15.4.0.html#mocking-refs-for-snapshot-testing\n       */\n\n      try {\n        var imgTag = _reactDom.default.findDOMNode(this.image);\n\n        var imgSrc = imgTag.getAttribute(\"src\");\n        img.src = imgSrc;\n      } catch (error) {\n        img.src = \"\";\n      } finally {\n        img.onload = this.onImageLoad;\n        this.mounted = true;\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.mounted = false;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _props = this.props,\n          editing = _props.editing,\n          layout = _props.layout,\n          linked = _props.linked,\n          index = _props.index,\n          imageProps = _objectWithoutProperties(_props, [\"editing\", \"layout\", \"linked\", \"index\"]);\n\n      var className = \"BlockImage__container\";\n\n      if (this.state.isLoaded || editing) {\n        className = className + \" image-loaded\";\n      }\n\n      return _react.default.createElement(StyledImageWrapper, null, _react.default.createElement(BlockImage, _extends({\n        className: className,\n        ref: function ref(_ref2) {\n          return _this2.image = _ref2;\n        }\n      }, imageProps)), layout !== \"classic\" && layout !== \"news\" && linked && _react.default.createElement(Fullscreen, null, _react.default.createElement(_ViewFullscreen.ViewFullscreen, {\n        index: index\n      })));\n    }\n  }]);\n\n  return ImageWrapper;\n}(_react.default.PureComponent);\n\nexports.ImageWrapper = ImageWrapper;\n\nvar Fullscreen =\n/*#__PURE__*/\n_styledComponents.default.div.withConfig({\n  displayName: \"ImageWrapper__Fullscreen\",\n  componentId: \"s87c4qo-0\"\n})([\"opacity:0;transition:opacity 0.3s;\"]);\n\nvar StyledImageWrapper =\n/*#__PURE__*/\n_styledComponents.default.div.withConfig({\n  displayName: \"ImageWrapper__StyledImageWrapper\",\n  componentId: \"s87c4qo-1\"\n})([\"position:relative;&:hover{\", \"{opacity:1;}}\", \" .BlockImage__container{opacity:0;transition:opacity 1s;}.image-loaded{opacity:1;}\"], Fullscreen, _Helpers.pMedia.sm(_templateObject, Fullscreen));\n\nvar BlockImage =\n/*#__PURE__*/\n_styledComponents.default.img.withConfig({\n  displayName: \"ImageWrapper__BlockImage\",\n  componentId: \"s87c4qo-2\"\n})([\"display:block;\"]);",{"version":3,"sources":["src/Components/Publishing/Sections/ImageWrapper.tsx"],"names":["ImageWrapper","undefined","isLoaded","mounted","setState","img","Image","imgTag","findDOMNode","image","imgSrc","getAttribute","src","error","onload","onImageLoad","props","editing","layout","linked","index","imageProps","className","state","ref","PureComponent","Fullscreen","div","StyledImageWrapper","sm","BlockImage"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;IAaaA,Y;;;;;;;;;;;;;;;;;;;;aACHC;;;;;aACE;;;;;aAEF;AACNC,kBAAU;AADJ;;;;;aA2BM,iBAAM;AAClB,YAAI,MAAKC,OAAT,EAAkB;AAChB,gBAAKC,QAAL,CAAc;AACZF,sBAAU;AADE,WAAd;AAGD;AACF;;;;;;wCA7BmB;AAClB,UAAMG,MAAM,IAAIC,KAAJ,EAAZ;AAEA;;;;;AAIA,UAAI;AACF,YAAMC,SAAS,kBAASC,WAAT,CAAqB,KAAKC,KAA1B,CAAf;;AACA,YAAMC,SAASH,OAAOI,YAAP,CAAoB,KAApB,CAAf;AACAN,YAAIO,GAAJ,GAAUF,MAAV;AACD,OAJD,CAIE,OAAOG,KAAP,EAAc;AACdR,YAAIO,GAAJ,GAAU,EAAV;AACD,OAND,SAMU;AACRP,YAAIS,MAAJ,GAAa,KAAKC,WAAlB;AACA,aAAKZ,OAAL,GAAe,IAAf;AACD;AACF;;;2CAEsB;AACrB,WAAKA,OAAL,GAAe,KAAf;AACD;;;6BAUQ;AAAA;;AAAA,mBACwD,KAAKa,KAD7D;AAAA,UACCC,OADD,UACCA,OADD;AAAA,UACUC,MADV,UACUA,MADV;AAAA,UACkBC,MADlB,UACkBA,MADlB;AAAA,UAC0BC,KAD1B,UAC0BA,KAD1B;AAAA,UACoCC,UADpC;;AAEP,UAAIC,YAAY,uBAAhB;;AAEA,UAAI,KAAKC,KAAL,CAAWrB,QAAX,IAAuBe,OAA3B,EAAoC;AAClCK,oBAAYA,YAAY,eAAxB;AACD;;AAED,aACE,6BAAC,kBAAD,QACE,6BAAC,UAAD;AACE,mBAAWA,SADb;AAEE,aAAK;AAAA,iBAAQ,OAAKb,KAAL,GAAae,KAArB;AAAA;AAFP,SAGMH,UAHN,EADF,EAOGH,WAAW,SAAX,IACCA,WAAW,MADZ,IAECC,MAFD,IAGG,6BAAC,UAAD,QACE;AAAgB,eAAOC;AAAvB,QADF,CAVN,CADF;AAiBD;;;;EAhE+B,eAAMK,a;;;;AAmExC,IAAMC;AAAA;AAAa,0BAAOC,GAApB;AAAA;AAAA;AAAA,0CAAN;;AAKA,IAAMC;AAAA;AAAqB,0BAAOD,GAA5B;AAAA;AAAA;AAAA,0IAIAD,UAJA,EASF,gBAAOG,EATL,kBAUAH,UAVA,EAAN;;AAuBA,IAAMI;AAAA;AAAa,0BAAOzB,GAApB;AAAA;AAAA;AAAA,sBAAN","file":"/Users/eve/development/reaction/src/Components/Publishing/Sections/ImageWrapper.tsx","sourceRoot":"/Users/eve/development/reaction","sourcesContent":["import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport styled from \"styled-components\"\nimport { pMedia } from \"../../Helpers\"\nimport { ArticleLayout } from \"../Typings\"\nimport { ViewFullscreen } from \"./ViewFullscreen\"\n\ninterface Props extends React.HTMLProps<HTMLImageElement> {\n  src: string\n  layout?: ArticleLayout\n  linked?: boolean\n  width?: string | number\n  height?: string | number\n  alt?: string\n  editing?: boolean\n  index?: number\n}\n\nexport class ImageWrapper extends React.PureComponent<Props, any> {\n  image = undefined\n  mounted = false\n\n  state = {\n    isLoaded: false,\n  }\n\n  componentDidMount() {\n    const img = new Image()\n\n    /**\n     * TODO: Clean this up\n     * Guard against snapshot tests See: https://reactjs.org/blog/2016/11/16/react-v15.4.0.html#mocking-refs-for-snapshot-testing\n     */\n    try {\n      const imgTag = ReactDOM.findDOMNode(this.image)\n      const imgSrc = imgTag.getAttribute(\"src\")\n      img.src = imgSrc\n    } catch (error) {\n      img.src = \"\"\n    } finally {\n      img.onload = this.onImageLoad\n      this.mounted = true\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false\n  }\n\n  onImageLoad = () => {\n    if (this.mounted) {\n      this.setState({\n        isLoaded: true,\n      })\n    }\n  }\n\n  render() {\n    const { editing, layout, linked, index, ...imageProps }: any = this.props\n    let className = \"BlockImage__container\"\n\n    if (this.state.isLoaded || editing) {\n      className = className + \" image-loaded\"\n    }\n\n    return (\n      <StyledImageWrapper>\n        <BlockImage\n          className={className}\n          ref={ref => (this.image = ref)}\n          {...imageProps}\n        />\n\n        {layout !== \"classic\" &&\n          layout !== \"news\" &&\n          linked && (\n            <Fullscreen>\n              <ViewFullscreen index={index} />\n            </Fullscreen>\n          )}\n      </StyledImageWrapper>\n    )\n  }\n}\n\nconst Fullscreen = styled.div`\n  opacity: 0;\n  transition: opacity 0.3s;\n`\n\nconst StyledImageWrapper = styled.div`\n  position: relative;\n\n  &:hover {\n    ${Fullscreen} {\n      opacity: 1;\n    }\n  }\n\n  ${pMedia.sm`\n    ${Fullscreen} {\n      opacity: 1;\n    }\n  `} .BlockImage__container {\n    opacity: 0;\n    transition: opacity 1s;\n  }\n\n  .image-loaded {\n    opacity: 1;\n  }\n`\n\nconst BlockImage = styled.img`\n  display: block;\n`\n"]}]}