{"remainingRequest":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js??ref--5-1!/Users/eve/development/reaction/src/Components/Publishing/ReadMore/ReadMoreWrapper.tsx","dependencies":[{"path":"/Users/eve/development/reaction/src/Components/Publishing/ReadMore/ReadMoreWrapper.tsx","mtime":1527707686000},{"path":"/Users/eve/development/reaction/.babelrc","mtime":1527877289000},{"path":"/Users/eve/development/reaction/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js","mtime":1509489566000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReadMoreWrapper = void 0;\n\nvar _lodash = require(\"lodash\");\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _reactDom = _interopRequireDefault(require(\"react-dom\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nvar ReadMoreWrapper =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ReadMoreWrapper, _React$Component);\n\n  function ReadMoreWrapper() {\n    var _ref;\n\n    var _temp, _this;\n\n    _classCallCheck(this, ReadMoreWrapper);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _possibleConstructorReturn(_this, (_temp = _this = _possibleConstructorReturn(this, (_ref = ReadMoreWrapper.__proto__ || Object.getPrototypeOf(ReadMoreWrapper)).call.apply(_ref, [this].concat(args))), Object.defineProperty(_assertThisInitialized(_this), \"state\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: {\n        truncationHeight: \"100%\"\n      }\n    }), Object.defineProperty(_assertThisInitialized(_this), \"truncateArticle\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: function value() {\n        if (_this.props.isTruncated) {\n          _this.setState({\n            truncationHeight: _this.calculateTruncationHeight()\n          });\n        }\n      }\n    }), Object.defineProperty(_assertThisInitialized(_this), \"calculateTruncationHeight\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: function value() {\n        var isTruncated = _this.props.isTruncated;\n\n        if (isTruncated) {\n          var height = 0;\n          var charCount = 0;\n\n          var thisNode = _reactDom.default.findDOMNode(_assertThisInitialized(_this)); // Iterate over text sections\n\n\n          (0, _lodash.find)(thisNode.getElementsByClassName(\"article__text-section\"), function (section) {\n            var sectionCharCount = 0; // Iterate over paragraph tags\n\n            var tags = section.getElementsByClassName(\"paragraph\").length ? section.getElementsByClassName(\"paragraph\") : section.getElementsByTagName(\"p\");\n            var foundTag = (0, _lodash.find)(tags, function (tag) {\n              var textContent = tag.textContent;\n              var textLength = textContent.length; // Update counts\n\n              sectionCharCount = sectionCharCount + textLength;\n              charCount = charCount + textLength; // Check if we've exceeded limits\n\n              if (textContent && sectionCharCount > 150 && charCount > 2000) {\n                height = tag.getBoundingClientRect().bottom - thisNode.getBoundingClientRect().top;\n                return true;\n              }\n\n              return false;\n            });\n            return foundTag ? true : false;\n          }); // Return found height or remove truncation if article is too short\n\n          if (height) {\n            return height;\n          } else {\n            _this.props.hideButton();\n\n            return \"100%\";\n          }\n        } else {\n          return \"100%\";\n        }\n      }\n    }), Object.defineProperty(_assertThisInitialized(_this), \"getTruncationHeight\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: function value() {\n        return _this.props.isTruncated ? _this.state.truncationHeight : \"100%\";\n      }\n    }), Object.defineProperty(_assertThisInitialized(_this), \"getOverflow\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: function value() {\n        return _this.props.isTruncated ? \"hidden\" : \"auto\";\n      }\n    }), _temp));\n  }\n\n  _createClass(ReadMoreWrapper, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      setTimeout(this.truncateArticle, 250);\n      window.addEventListener(\"resize\", this.truncateArticle);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener(\"resize\", this.truncateArticle);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return _react.default.createElement(\"div\", {\n        style: {\n          height: this.getTruncationHeight(),\n          overflow: this.getOverflow()\n        }\n      }, this.props.children);\n    }\n  }]);\n\n  return ReadMoreWrapper;\n}(_react.default.Component);\n\nexports.ReadMoreWrapper = ReadMoreWrapper;",{"version":3,"sources":["src/Components/Publishing/ReadMore/ReadMoreWrapper.tsx"],"names":["ReadMoreWrapper","truncationHeight","props","isTruncated","setState","calculateTruncationHeight","height","charCount","thisNode","findDOMNode","getElementsByClassName","sectionCharCount","tags","section","length","getElementsByTagName","foundTag","textContent","tag","textLength","getBoundingClientRect","bottom","top","hideButton","state","setTimeout","truncateArticle","window","addEventListener","removeEventListener","getTruncationHeight","overflow","getOverflow","children","Component"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;;;;;;;;;;;;;IAWaA,e;;;;;;;;;;;;;;;;;;;;aAIH;AACNC,0BAAkB;AADZ;;;;;aAaU,iBAAM;AACtB,YAAI,MAAKC,KAAL,CAAWC,WAAf,EAA4B;AAC1B,gBAAKC,QAAL,CAAc;AAAEH,8BAAkB,MAAKI,yBAAL;AAApB,WAAd;AACD;AACF;;;;;aAE2B,iBAAM;AAAA,YACxBF,WADwB,GACR,MAAKD,KADG,CACxBC,WADwB;;AAGhC,YAAIA,WAAJ,EAAiB;AACf,cAAIG,SAAS,CAAb;AACA,cAAIC,YAAY,CAAhB;;AACA,cAAMC,WAAW,kBAASC,WAAT,+BAAjB,CAHe,CAKf;;;AACA,4BACED,SAASE,sBAAT,CAAgC,uBAAhC,CADF,EAEE,mBAAW;AACT,gBAAIC,mBAAmB,CAAvB,CADS,CAGT;;AACA,gBAAMC,OAAOC,QAAQH,sBAAR,CAA+B,WAA/B,EAA4CI,MAA5C,GACTD,QAAQH,sBAAR,CAA+B,WAA/B,CADS,GAETG,QAAQE,oBAAR,CAA6B,GAA7B,CAFJ;AAIA,gBAAMC,WAAW,kBAAKJ,IAAL,EAAW,eAAO;AACjC,kBAAMK,cAAcC,IAAID,WAAxB;AACA,kBAAME,aAAaF,YAAYH,MAA/B,CAFiC,CAIjC;;AACAH,iCAAmBA,mBAAmBQ,UAAtC;AACAZ,0BAAYA,YAAYY,UAAxB,CANiC,CAQjC;;AACA,kBAAIF,eAAeN,mBAAmB,GAAlC,IAAyCJ,YAAY,IAAzD,EAA+D;AAC7DD,yBACEY,IAAIE,qBAAJ,GAA4BC,MAA5B,GACAb,SAASY,qBAAT,GAAiCE,GAFnC;AAGA,uBAAO,IAAP;AACD;;AACD,qBAAO,KAAP;AACD,aAhBgB,CAAjB;AAiBA,mBAAON,WAAW,IAAX,GAAkB,KAAzB;AACD,WA5BH,EANe,CAqCf;;AACA,cAAIV,MAAJ,EAAY;AACV,mBAAOA,MAAP;AACD,WAFD,MAEO;AACL,kBAAKJ,KAAL,CAAWqB,UAAX;;AACA,mBAAO,MAAP;AACD;AACF,SA5CD,MA4CO;AACL,iBAAO,MAAP;AACD;AACF;;;;;aAEqB,iBAAM;AAC1B,eAAO,MAAKrB,KAAL,CAAWC,WAAX,GAAyB,MAAKqB,KAAL,CAAWvB,gBAApC,GAAuD,MAA9D;AACD;;;;;aAEa,iBAAM;AAClB,eAAO,MAAKC,KAAL,CAAWC,WAAX,GAAyB,QAAzB,GAAoC,MAA3C;AACD;;;;;;wCAzEmB;AAClBsB,iBAAW,KAAKC,eAAhB,EAAiC,GAAjC;AACAC,aAAOC,gBAAP,CAAwB,QAAxB,EAAkC,KAAKF,eAAvC;AACD;;;2CAEsB;AACrBC,aAAOE,mBAAP,CAA2B,QAA3B,EAAqC,KAAKH,eAA1C;AACD;;;6BAoEQ;AACP,aACE;AACE,eAAO;AACLpB,kBAAQ,KAAKwB,mBAAL,EADH;AAELC,oBAAU,KAAKC,WAAL;AAFL;AADT,SAMG,KAAK9B,KAAL,CAAW+B,QANd,CADF;AAUD;;;;EA9FkC,eAAMC,S","file":"/Users/eve/development/reaction/src/Components/Publishing/ReadMore/ReadMoreWrapper.tsx","sourceRoot":"/Users/eve/development/reaction","sourcesContent":["import { find } from \"lodash\"\nimport React from \"react\"\nimport ReactDOM from \"react-dom\"\n\ninterface ReadMoreWrapperProps {\n  isTruncated: boolean\n  hideButton: () => void\n}\n\ninterface ReadMoreWrapperState {\n  truncationHeight: number | string\n}\n\nexport class ReadMoreWrapper extends React.Component<\n  ReadMoreWrapperProps,\n  ReadMoreWrapperState\n> {\n  state = {\n    truncationHeight: \"100%\",\n  }\n\n  componentDidMount() {\n    setTimeout(this.truncateArticle, 250)\n    window.addEventListener(\"resize\", this.truncateArticle)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.truncateArticle)\n  }\n\n  truncateArticle = () => {\n    if (this.props.isTruncated) {\n      this.setState({ truncationHeight: this.calculateTruncationHeight() })\n    }\n  }\n\n  calculateTruncationHeight = () => {\n    const { isTruncated } = this.props\n\n    if (isTruncated) {\n      let height = 0\n      let charCount = 0\n      const thisNode = ReactDOM.findDOMNode(this)\n\n      // Iterate over text sections\n      find(\n        thisNode.getElementsByClassName(\"article__text-section\"),\n        section => {\n          let sectionCharCount = 0\n\n          // Iterate over paragraph tags\n          const tags = section.getElementsByClassName(\"paragraph\").length\n            ? section.getElementsByClassName(\"paragraph\")\n            : section.getElementsByTagName(\"p\")\n\n          const foundTag = find(tags, tag => {\n            const textContent = tag.textContent\n            const textLength = textContent.length\n\n            // Update counts\n            sectionCharCount = sectionCharCount + textLength\n            charCount = charCount + textLength\n\n            // Check if we've exceeded limits\n            if (textContent && sectionCharCount > 150 && charCount > 2000) {\n              height =\n                tag.getBoundingClientRect().bottom -\n                thisNode.getBoundingClientRect().top\n              return true\n            }\n            return false\n          })\n          return foundTag ? true : false\n        }\n      )\n\n      // Return found height or remove truncation if article is too short\n      if (height) {\n        return height\n      } else {\n        this.props.hideButton()\n        return \"100%\"\n      }\n    } else {\n      return \"100%\"\n    }\n  }\n\n  getTruncationHeight = () => {\n    return this.props.isTruncated ? this.state.truncationHeight : \"100%\"\n  }\n\n  getOverflow = () => {\n    return this.props.isTruncated ? \"hidden\" : \"auto\"\n  }\n\n  render() {\n    return (\n      <div\n        style={{\n          height: this.getTruncationHeight(),\n          overflow: this.getOverflow(),\n        }}\n      >\n        {this.props.children}\n      </div>\n    )\n  }\n}\n"]}]}