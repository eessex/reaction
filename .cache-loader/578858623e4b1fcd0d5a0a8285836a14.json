{"remainingRequest":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js??ref--6-1!/Users/eve/development/reaction/src/Apps/Order/OrderApp.tsx","dependencies":[{"path":"/Users/eve/development/reaction/src/Apps/Order/OrderApp.tsx","mtime":1538070271000},{"path":"/Users/eve/development/reaction/.babelrc","mtime":1537112679000},{"path":"/Users/eve/development/reaction/node_modules/cache-loader/dist/cjs.js","mtime":0},{"path":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { ContextConsumer } from \"../../Artsy/SystemContext\";\nimport React from \"react\";\nimport { Meta, Title } from \"react-head\";\nimport { Elements, StripeProvider } from \"react-stripe-elements\";\n\nvar findRoute = function findRoute(routes, routeIndices) {\n  var currentRoute = routes[routeIndices[0]];\n  routeIndices.slice(1).forEach(function (routeIndex) {\n    currentRoute = currentRoute.children[routeIndex];\n  });\n  return currentRoute;\n};\n\nexport var OrderApp =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(OrderApp, _React$Component);\n\n  function OrderApp() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, OrderApp);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(OrderApp)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      stripe: null\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"removeTransitionHook\", void 0);\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onTransition\", function (newLocation) {\n      var _this$props = _this.props,\n          routes = _this$props.routes,\n          routeIndices = _this$props.routeIndices,\n          oldLocation = _this$props.location,\n          router = _this$props.router;\n      var route = findRoute(routes, routeIndices);\n\n      if (route.onTransition) {\n        return route.onTransition(newLocation, oldLocation, router);\n      }\n\n      return true;\n    });\n\n    return _this;\n  }\n\n  _createClass(OrderApp, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      if (!this.removeTransitionHook) {\n        this.removeTransitionHook = this.props.router.addTransitionHook(this.onTransition);\n      }\n\n      if (window.Stripe) {\n        this.setState({\n          stripe: window.Stripe(window.sd.STRIPE_PUBLISHABLE_KEY)\n        });\n      } else {\n        document.querySelector(\"#stripe-js\").addEventListener(\"load\", function () {\n          // Create Stripe instance once Stripe.js loads\n          _this2.setState({\n            stripe: window.Stripe(window.sd.STRIPE_PUBLISHABLE_KEY)\n          });\n        });\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (this.removeTransitionHook) {\n        this.removeTransitionHook();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$props2 = this.props,\n          children = _this$props2.children,\n          location = _this$props2.location,\n          router = _this$props2.router,\n          order = _this$props2.order,\n          params = _this$props2.params;\n\n      if (order && order.state !== \"PENDING\" && !location.pathname.includes(\"status\")) {\n        router.replace(\"/order2/\".concat(params.orderID, \"/status\"));\n      }\n\n      return React.createElement(ContextConsumer, null, function (_ref) {\n        var isEigen = _ref.isEigen;\n        return React.createElement(React.Fragment, null, React.createElement(Title, null, \"Checkout | Artsy\"), isEigen ? React.createElement(Meta, {\n          name: \"viewport\",\n          content: \"width=device-width, user-scalable=no\"\n        }) : null, React.createElement(StripeProvider, {\n          stripe: _this3.state.stripe\n        }, React.createElement(Elements, null, children)));\n      });\n    }\n  }]);\n\n  return OrderApp;\n}(React.Component);",{"version":3,"sources":["/Users/eve/development/reaction/src/Apps/Order/OrderApp.tsx"],"names":["ContextConsumer","React","Meta","Title","Elements","StripeProvider","findRoute","routes","routeIndices","currentRoute","slice","forEach","routeIndex","children","OrderApp","stripe","newLocation","props","oldLocation","location","router","route","onTransition","removeTransitionHook","addTransitionHook","window","Stripe","setState","sd","STRIPE_PUBLISHABLE_KEY","document","querySelector","addEventListener","order","params","state","pathname","includes","replace","orderID","isEigen","Component"],"mappings":"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","sourcesContent":["import { routes_OrderQueryResponse } from \"__generated__/routes_OrderQuery.graphql\"\nimport { ContextConsumer } from \"Artsy/SystemContext\"\nimport { Location, RouteConfig, Router } from \"found\"\nimport React from \"react\"\nimport { Meta, Title } from \"react-head\"\nimport { Elements, StripeProvider } from \"react-stripe-elements\"\n\ndeclare global {\n  interface Window {\n    Stripe?: (key: string) => stripe.Stripe\n    sd: {\n      STRIPE_PUBLISHABLE_KEY: string\n    }\n  }\n}\n\nconst findRoute = (routes, routeIndices) => {\n  let currentRoute = routes[routeIndices[0]]\n  routeIndices.slice(1).forEach(routeIndex => {\n    currentRoute = currentRoute.children[routeIndex]\n  })\n  return currentRoute\n}\n\nexport interface OrderAppProps extends routes_OrderQueryResponse {\n  params: {\n    orderID: string\n  }\n  location: Location\n  routeIndices: number[]\n  routes: RouteConfig[]\n  router: Router\n}\n\ninterface OrderAppState {\n  stripe: stripe.Stripe\n}\n\nexport class OrderApp extends React.Component<OrderAppProps, OrderAppState> {\n  state = { stripe: null }\n  removeTransitionHook: () => void\n\n  componentDidMount() {\n    if (!this.removeTransitionHook) {\n      this.removeTransitionHook = this.props.router.addTransitionHook(\n        this.onTransition\n      )\n    }\n\n    if (window.Stripe) {\n      this.setState({\n        stripe: window.Stripe(window.sd.STRIPE_PUBLISHABLE_KEY),\n      })\n    } else {\n      document.querySelector(\"#stripe-js\").addEventListener(\"load\", () => {\n        // Create Stripe instance once Stripe.js loads\n        this.setState({\n          stripe: window.Stripe(window.sd.STRIPE_PUBLISHABLE_KEY),\n        })\n      })\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.removeTransitionHook) {\n      this.removeTransitionHook()\n    }\n  }\n\n  onTransition = newLocation => {\n    const { routes, routeIndices, location: oldLocation, router } = this.props\n    const route = findRoute(routes, routeIndices)\n\n    if (route.onTransition) {\n      return route.onTransition(newLocation, oldLocation, router)\n    }\n\n    return true\n  }\n\n  render() {\n    const { children, location, router, order, params } = this.props\n\n    if (\n      order &&\n      order.state !== \"PENDING\" &&\n      !location.pathname.includes(\"status\")\n    ) {\n      router.replace(`/order2/${params.orderID}/status`)\n    }\n    return (\n      <ContextConsumer>\n        {({ isEigen }) => (\n          <>\n            <Title>Checkout | Artsy</Title>\n            {isEigen ? (\n              <Meta\n                name=\"viewport\"\n                content=\"width=device-width, user-scalable=no\"\n              />\n            ) : null}\n            <StripeProvider stripe={this.state.stripe}>\n              <Elements>{children}</Elements>\n            </StripeProvider>\n          </>\n        )}\n      </ContextConsumer>\n    )\n  }\n}\n"]}]}