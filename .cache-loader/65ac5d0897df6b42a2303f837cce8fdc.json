{"remainingRequest":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js??ref--6-1!/Users/eve/development/reaction/src/Components/Publishing/ReadMore/ReadMoreWrapper.tsx","dependencies":[{"path":"/Users/eve/development/reaction/src/Components/Publishing/ReadMore/ReadMoreWrapper.tsx","mtime":1532116850000},{"path":"/Users/eve/development/reaction/.babelrc","mtime":1537112679000},{"path":"/Users/eve/development/reaction/node_modules/cache-loader/dist/cjs.js","mtime":0},{"path":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _find from \"lodash/find\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nexport var ReadMoreWrapper =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ReadMoreWrapper, _React$Component);\n\n  function ReadMoreWrapper() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ReadMoreWrapper);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ReadMoreWrapper)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      truncationHeight: \"100%\"\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"truncateArticle\", function () {\n      if (_this.props.isTruncated) {\n        _this.setState({\n          truncationHeight: _this.calculateTruncationHeight()\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"calculateTruncationHeight\", function () {\n      var isTruncated = _this.props.isTruncated;\n\n      if (isTruncated) {\n        var height = 0;\n        var charCount = 0;\n        var thisNode = ReactDOM.findDOMNode(_assertThisInitialized(_assertThisInitialized(_this))); // Iterate over text sections\n\n        _find(thisNode.getElementsByClassName(\"article__text-section\"), function (section) {\n          var sectionCharCount = 0; // Iterate over paragraph tags\n\n          var tags = section.getElementsByClassName(\"paragraph\").length ? section.getElementsByClassName(\"paragraph\") : section.getElementsByTagName(\"p\");\n\n          var foundTag = _find(tags, function (tag) {\n            var textContent = tag.textContent;\n            var textLength = textContent.length; // Update counts\n\n            sectionCharCount = sectionCharCount + textLength;\n            charCount = charCount + textLength; // Check if we've exceeded limits\n\n            if (textContent && sectionCharCount > 150 && charCount > 2000) {\n              height = tag.getBoundingClientRect().bottom - thisNode.getBoundingClientRect().top;\n              return true;\n            }\n\n            return false;\n          });\n\n          return foundTag ? true : false;\n        }); // Return found height or remove truncation if article is too short\n\n\n        if (height) {\n          return height;\n        } else {\n          _this.props.hideButton();\n\n          return \"100%\";\n        }\n      } else {\n        return \"100%\";\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getTruncationHeight\", function () {\n      return _this.props.isTruncated ? _this.state.truncationHeight : \"100%\";\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getOverflow\", function () {\n      return _this.props.isTruncated ? \"hidden\" : \"auto\";\n    });\n\n    return _this;\n  }\n\n  _createClass(ReadMoreWrapper, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      setTimeout(this.truncateArticle, 250);\n      window.addEventListener(\"resize\", this.truncateArticle);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener(\"resize\", this.truncateArticle);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        style: {\n          height: this.getTruncationHeight(),\n          overflow: this.getOverflow()\n        }\n      }, this.props.children);\n    }\n  }]);\n\n  return ReadMoreWrapper;\n}(React.Component);",{"version":3,"sources":["/Users/eve/development/reaction/src/Components/Publishing/ReadMore/ReadMoreWrapper.tsx"],"names":["React","ReactDOM","ReadMoreWrapper","truncationHeight","props","isTruncated","setState","calculateTruncationHeight","height","charCount","thisNode","findDOMNode","getElementsByClassName","section","sectionCharCount","tags","length","getElementsByTagName","foundTag","tag","textContent","textLength","getBoundingClientRect","bottom","top","hideButton","state","setTimeout","truncateArticle","window","addEventListener","removeEventListener","getTruncationHeight","overflow","getOverflow","children","Component"],"mappings":"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","sourcesContent":["import { find } from \"lodash\"\nimport React from \"react\"\nimport ReactDOM from \"react-dom\"\n\ninterface ReadMoreWrapperProps {\n  isTruncated: boolean\n  hideButton: () => void\n}\n\ninterface ReadMoreWrapperState {\n  truncationHeight: number | string\n}\n\nexport class ReadMoreWrapper extends React.Component<\n  ReadMoreWrapperProps,\n  ReadMoreWrapperState\n> {\n  state = {\n    truncationHeight: \"100%\",\n  }\n\n  componentDidMount() {\n    setTimeout(this.truncateArticle, 250)\n    window.addEventListener(\"resize\", this.truncateArticle)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.truncateArticle)\n  }\n\n  truncateArticle = () => {\n    if (this.props.isTruncated) {\n      this.setState({ truncationHeight: this.calculateTruncationHeight() })\n    }\n  }\n\n  calculateTruncationHeight = () => {\n    const { isTruncated } = this.props\n\n    if (isTruncated) {\n      let height = 0\n      let charCount = 0\n      const thisNode = ReactDOM.findDOMNode(this) as Element\n\n      // Iterate over text sections\n      find(\n        thisNode.getElementsByClassName(\"article__text-section\"),\n        section => {\n          let sectionCharCount = 0\n\n          // Iterate over paragraph tags\n          const tags = section.getElementsByClassName(\"paragraph\").length\n            ? section.getElementsByClassName(\"paragraph\")\n            : section.getElementsByTagName(\"p\")\n\n          const foundTag = find(tags, tag => {\n            const textContent = tag.textContent\n            const textLength = textContent.length\n\n            // Update counts\n            sectionCharCount = sectionCharCount + textLength\n            charCount = charCount + textLength\n\n            // Check if we've exceeded limits\n            if (textContent && sectionCharCount > 150 && charCount > 2000) {\n              height =\n                tag.getBoundingClientRect().bottom -\n                thisNode.getBoundingClientRect().top\n              return true\n            }\n            return false\n          })\n          return foundTag ? true : false\n        }\n      )\n\n      // Return found height or remove truncation if article is too short\n      if (height) {\n        return height\n      } else {\n        this.props.hideButton()\n        return \"100%\"\n      }\n    } else {\n      return \"100%\"\n    }\n  }\n\n  getTruncationHeight = () => {\n    return this.props.isTruncated ? this.state.truncationHeight : \"100%\"\n  }\n\n  getOverflow = () => {\n    return this.props.isTruncated ? \"hidden\" : \"auto\"\n  }\n\n  render() {\n    return (\n      <div\n        style={{\n          height: this.getTruncationHeight(),\n          overflow: this.getOverflow(),\n        }}\n      >\n        {this.props.children}\n      </div>\n    )\n  }\n}\n"]}]}