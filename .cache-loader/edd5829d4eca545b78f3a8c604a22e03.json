{"remainingRequest":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js??ref--6-1!/Users/eve/development/reaction/src/Components/Publishing/Display/DisplayPanel.tsx","dependencies":[{"path":"/Users/eve/development/reaction/src/Components/Publishing/Display/DisplayPanel.tsx","mtime":1537275186000},{"path":"/Users/eve/development/reaction/.babelrc","mtime":1537112679000},{"path":"/Users/eve/development/reaction/node_modules/cache-loader/dist/cjs.js","mtime":0},{"path":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _memoize from \"lodash/memoize\";\nimport _get from \"lodash/get\";\n\nvar _dec, _dec2, _class, _class2, _class3, _temp;\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n    margin: auto;\\n  \"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n    margin: auto;\\n  \"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n    margin: auto;\\n  \"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n    margin: 0 auto;\\n  \"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object['ke' + 'ys'](descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object['define' + 'Property'](target, property, desc); desc = null; } return desc; }\n\nimport { avantgarde, garamond, unica } from \"../../../Assets/Fonts\";\nimport React, { Component } from \"react\";\nimport track from \"react-tracking\";\nimport Waypoint from \"react-waypoint\";\nimport styled from \"styled-components\";\nimport Colors from \"../../../Assets/Colors\";\nimport Events from \"../../../Utils/Events\";\nimport { crop, resize } from \"../../../Utils/resizer\";\nimport { ErrorBoundary } from \"../../ErrorBoundary\";\nimport { pMedia as breakpoint } from \"../../Helpers\";\nimport { getCurrentUnixTimestamp } from \"../Constants\";\nimport { VideoControls } from \"../Sections/VideoControls\";\nimport { PixelTracker, replaceWithCacheBuster } from \"./ExternalTrackers\";\nimport { trackImpression } from \"./track-once\";\nexport var DisplayPanel = (_dec = track({\n  page: \"Article\"\n}, {\n  dispatch: function dispatch(data) {\n    return Events.postEvent(data);\n  }\n}), _dec2 = trackImpression(function () {\n  return \"panel\";\n}), _dec(_class = (_class2 = (_temp = _class3 =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(DisplayPanel, _Component);\n\n  function DisplayPanel(props) {\n    var _this;\n\n    _classCallCheck(this, DisplayPanel);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(DisplayPanel).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"video\", void 0);\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      isMuted: true,\n      isPlaying: false,\n      showCoverImage: false\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"trackDuration\", _memoize(function (percentComplete) {\n      _this.props.tracking.trackEvent({\n        action: \"Video duration\",\n        label: \"Display ad video duration\",\n        percent_complete: percentComplete,\n        campaign_name: _this.props.campaign.name,\n        unit_layout: \"panel\"\n      });\n    }));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"trackSeconds\", _memoize(function (secondsComplete) {\n      _this.props.tracking.trackEvent({\n        action: \"Video seconds\",\n        label: \"Display ad video seconds\",\n        seconds_complete: secondsComplete,\n        campaign_name: _this.props.campaign.name,\n        unit_layout: \"panel\"\n      });\n    }));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"toggleMuted\", function (e) {\n      e.stopPropagation();\n\n      _this.setState({\n        isMuted: !_this.state.isMuted\n      });\n    });\n\n    _this.handleClick = _this.handleClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleMouseEnter = _this.handleMouseEnter.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleMouseLeave = _this.handleMouseLeave.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.trackImpression = _this.trackImpression.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(DisplayPanel, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.video) {\n        this.video.onended = this.pauseVideo;\n      }\n    }\n  }, {\n    key: \"componentWillUpdate\",\n    value: function componentWillUpdate() {\n      if (this.video) {\n        this.video.removeEventListener(\"timeupdate\", this.trackProgress.bind(this));\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      if (this.video) {\n        this.video.addEventListener(\"timeupdate\", this.trackProgress.bind(this));\n        this.video.muted = this.state.isMuted;\n      }\n    }\n  }, {\n    key: \"trackImpression\",\n    value: function trackImpression() {} // noop\n    // TODO: This could be shared with <CanvasVideo />\n\n  }, {\n    key: \"trackProgress\",\n    value: function trackProgress() {\n      var secondsComplete = Math.floor(this.video.currentTime);\n      var percentComplete = Math.floor(this.video.currentTime / this.video.duration * 100);\n      var percentCompleteInterval = Math.floor(percentComplete / 25) * 25; // Track 25% duration intervals\n\n      if (percentCompleteInterval > 0) {\n        this.trackDuration(percentCompleteInterval);\n      } // Track 3 & 10 seconds\n\n\n      if (secondsComplete === 3 || secondsComplete === 10) {\n        this.trackSeconds(secondsComplete);\n      }\n    }\n  }, {\n    key: \"isWithinMediaArea\",\n    value: function isWithinMediaArea(event) {\n      var valid = [\"DisplayPanel__Image\", \"VideoContainer\", \"VideoContainer__VideoCover\", \"VideoContainer__VideoControls\", \"VideoContainer__video\", \"PlayButton\", \"PlayButton__PlayButtonCaret\"];\n      var withinMediaArea = valid.some(function (className) {\n        return event.target.className.includes(className);\n      });\n      return withinMediaArea;\n    }\n  }, {\n    key: \"handleClick\",\n    value: function handleClick(event) {\n      event.preventDefault();\n      var alreadyClicked = this.state.showCoverImage;\n      var _this$props = this.props,\n          campaign = _this$props.campaign,\n          isMobile = _this$props.isMobile,\n          tracking = _this$props.tracking,\n          unit = _this$props.unit;\n\n      var url = _get(unit, \"link.url\", false);\n\n      var isVideo = this.isVideo();\n\n      var openUrl = function openUrl() {\n        tracking.trackEvent({\n          action: \"Click\",\n          label: \"Display ad clickthrough\",\n          entity_type: \"display_ad\",\n          campaign_name: campaign.name,\n          unit_layout: \"panel\"\n        });\n        if (url) window.open(replaceWithCacheBuster(url, getCurrentUnixTimestamp()) || \"\", \"_blank\");\n      };\n\n      if (isMobile) {\n        if (isVideo) {\n          if (this.isWithinMediaArea(event)) {\n            this.trackVideoClick();\n            this.toggleVideo();\n          } else {\n            openUrl();\n          } // Image\n\n        } else {\n          if (this.isWithinMediaArea(event)) {\n            if (alreadyClicked) {\n              openUrl();\n              this.toggleCoverImage();\n            } else {\n              this.toggleCoverImage();\n            } // Clicked outside of the media area\n\n          } else {\n            openUrl();\n          }\n        } // Desktop\n\n      } else {\n        if (isVideo) {\n          this.pauseVideo();\n        }\n\n        openUrl();\n      }\n    }\n    /**\n     * Handle MouseEnter, on desktop\n     */\n\n  }, {\n    key: \"handleMouseEnter\",\n    value: function handleMouseEnter() {\n      if (this.props.isMobile) {\n        return false;\n      } else {\n        if (this.isVideo()) {\n          this.playVideo();\n          this.props.tracking.trackEvent({\n            action: \"MouseEnter\",\n            label: \"Display ad play video\",\n            entity_type: \"display_ad\",\n            campaign_name: this.props.campaign.name,\n            unit_layout: \"panel\"\n          });\n        } else {\n          this.toggleCoverImage();\n        }\n      }\n    }\n    /**\n     * Handle MouseLeave, on desktop\n     */\n\n  }, {\n    key: \"handleMouseLeave\",\n    value: function handleMouseLeave() {\n      if (this.props.isMobile) {\n        return false;\n      } else {\n        if (this.isVideo()) {\n          this.pauseVideo();\n        } else {\n          this.toggleCoverImage();\n        }\n      }\n    }\n  }, {\n    key: \"toggleCoverImage\",\n    value: function toggleCoverImage() {\n      if (this.props.unit.logo) {\n        var _showCoverImage = !this.state.showCoverImage;\n\n        this.setState({\n          showCoverImage: _showCoverImage\n        });\n      }\n    }\n  }, {\n    key: \"toggleVideo\",\n    value: function toggleVideo() {\n      if (this.state.isPlaying) {\n        this.pauseVideo();\n      } else {\n        this.playVideo();\n      }\n    }\n  }, {\n    key: \"pauseVideo\",\n    value: function pauseVideo() {\n      if (this.video) {\n        this.video.pause();\n        this.setState({\n          isPlaying: false\n        });\n      }\n    }\n  }, {\n    key: \"playVideo\",\n    value: function playVideo() {\n      if (this.video) {\n        this.video.play();\n        this.setState({\n          isPlaying: true\n        });\n      }\n    }\n    /**\n     * Handle clicks to Video player\n     */\n\n  }, {\n    key: \"trackVideoClick\",\n    value: function trackVideoClick() {\n      this.props.tracking.trackEvent({\n        action: \"Click\",\n        label: \"Display ad play video\",\n        entity_type: \"display_ad\",\n        campaign_name: this.props.campaign.name,\n        unit_layout: \"panel\"\n      });\n    }\n  }, {\n    key: \"isVideo\",\n    value: function isVideo() {\n      var assetUrl = _get(this.props.unit, \"assets.0.url\", \"\");\n\n      var isVideo = assetUrl.includes(\"mp4\");\n      return isVideo;\n    }\n  }, {\n    key: \"renderVideoIcon\",\n    value: function renderVideoIcon() {\n      var _this$state = this.state,\n          isPlaying = _this$state.isPlaying,\n          isMuted = _this$state.isMuted;\n      var isMobile = this.props.isMobile;\n\n      if (isMobile) {\n        return null;\n      } else if (isPlaying && isMuted) {\n        return React.createElement(MutedIcon, {\n          onClick: this.toggleMuted\n        }, React.createElement(\"svg\", {\n          width: \"30\",\n          height: \"30\",\n          xmlns: \"http://www.w3.org/2000/svg\"\n        }, React.createElement(\"g\", {\n          fill: \"#FFF\"\n        }, React.createElement(\"path\", {\n          d: \"M29.514 28L19.13 17.614 9.557 8.043 1.514 0 0 1.514l6.529 6.529H.757V21.47H11.83l7.3 7.286v-8.114L28 29.514zM19.129.757l-7.3 7.286 7.3 7.3z\"\n        }))));\n      } else if (isPlaying && !isMuted) {\n        return React.createElement(UnmutedIcon, {\n          onClick: this.toggleMuted\n        }, React.createElement(\"svg\", {\n          width: \"30\",\n          height: \"30\",\n          xmlns: \"http://www.w3.org/2000/svg\"\n        }, React.createElement(\"g\", {\n          fill: \"#FFF\"\n        }, React.createElement(\"path\", {\n          d: \"M18 12.864V0l-7.152 7.286H0v13.428h10.848L18 28V12.864z\"\n        }))));\n      } else {\n        return React.createElement(VideoPlayIcon, null);\n      }\n    }\n  }, {\n    key: \"renderVideo\",\n    value: function renderVideo(url) {\n      var _this2 = this;\n\n      var isPlaying = this.state.isPlaying;\n      var isMobile = this.props.isMobile;\n      return React.createElement(VideoContainer, {\n        className: \"VideoContainer\"\n      }, !isPlaying && React.createElement(VideoCover, {\n        className: \"VideoContainer__VideoCover\"\n      }, isMobile && React.createElement(VideoControls, {\n        mini: true,\n        className: \"VideoContainer__VideoControls\"\n      })), React.createElement(\"video\", {\n        playsInline: true,\n        src: url,\n        className: \"VideoContainer__video\",\n        controls: false,\n        ref: function ref(video) {\n          return _this2.video = video;\n        }\n      }), this.renderVideoIcon());\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var showCoverImage = this.state.showCoverImage;\n      var _this$props2 = this.props,\n          unit = _this$props2.unit,\n          campaign = _this$props2.campaign,\n          isMobile = _this$props2.isMobile,\n          renderTime = _this$props2.renderTime;\n\n      var url = _get(unit.assets, \"0.url\", \"\");\n\n      var isVideo = this.isVideo();\n      var imageUrl = isVideo ? url : crop(url, {\n        width: 680,\n        height: 284,\n        isDisplayAd: true\n      });\n      var hoverImageUrl = resize(unit.logo, {\n        width: 680,\n        isDisplayAd: true\n      });\n      var coverUrl = unit.cover_image_url && crop(unit.cover_image_url, {\n        width: 680,\n        height: 284,\n        isDisplayAd: true\n      });\n      return React.createElement(ErrorBoundary, null, React.createElement(Wrapper, {\n        onClick: this.handleClick,\n        onMouseEnter: this.handleMouseEnter,\n        onMouseLeave: this.handleMouseLeave\n      }, React.createElement(Waypoint, {\n        onEnter: this.trackImpression\n      }), React.createElement(DisplayPanelContainer, {\n        className: \"DisplayPanel__DisplayPanelContainer\",\n        imageUrl: imageUrl,\n        isMobile: isMobile,\n        hoverImageUrl: hoverImageUrl,\n        coverUrl: coverUrl,\n        showCoverImage: showCoverImage\n      }, isVideo ? this.renderVideo(url) : React.createElement(Image, {\n        className: \"DisplayPanel__Image\"\n      }), React.createElement(\"div\", null, React.createElement(Headline, null, unit.headline), React.createElement(Body, {\n        dangerouslySetInnerHTML: {\n          __html: unit.body\n        }\n      }), React.createElement(SponsoredBy, null, \"Sponsored by \".concat(campaign.name)))), React.createElement(PixelTracker, {\n        unit: unit,\n        date: renderTime\n      })));\n    }\n  }]);\n\n  return DisplayPanel;\n}(Component), _defineProperty(_class3, \"defaultProps\", {\n  tracking: {\n    trackEvent: function trackEvent(x) {\n      return x;\n    }\n  }\n}), _temp), (_applyDecoratedDescriptor(_class2.prototype, \"trackImpression\", [_dec2], Object.getOwnPropertyDescriptor(_class2.prototype, \"trackImpression\"), _class2.prototype)), _class2)) || _class);\nvar Wrapper = styled.div.withConfig({\n  displayName: \"DisplayPanel__Wrapper\",\n  componentId: \"s1e0gfmg-0\"\n})([\"cursor:pointer;text-decoration:none;color:black;max-width:360px;\", \";\"], breakpoint.sm(_templateObject()));\nvar Image = styled.div.withConfig({\n  displayName: \"DisplayPanel__Image\",\n  componentId: \"s1e0gfmg-1\"\n})([\"margin-bottom:15px;width:100%;height:142px;background-color:black;box-sizing:border-box;\"]);\nvar VideoCover = styled.div.withConfig({\n  displayName: \"DisplayPanel__VideoCover\",\n  componentId: \"s1e0gfmg-2\"\n})([\"margin-bottom:15px;width:100%;height:142px;background-color:black;box-sizing:border-box;position:absolute;display:flex;align-items:center;justify-content:center;\"]);\nvar DisplayPanelContainer = styled.div.withConfig({\n  displayName: \"DisplayPanel__DisplayPanelContainer\",\n  componentId: \"s1e0gfmg-3\"\n})([\"display:flex;flex-direction:column;border:1px solid \", \";padding:20px;max-width:360px;box-sizing:border-box;\", \"{background:url(\", \") no-repeat center center;background-size:cover;\", \";}\", \"{background:url(\", \") no-repeat center center;background-size:cover;\", \";}\", \";\", \";\", \";\"], Colors.grayRegular, Image, function (p) {\n  return p.imageUrl || \"\";\n}, function (p) {\n  return p.showCoverImage && p.hoverImageUrl && \"\\n        background: black url(\".concat(p.hoverImageUrl, \") no-repeat center center;\\n        background-size: contain;\\n        border: 10px solid black;\\n    \");\n}, VideoCover, function (p) {\n  return p.coverUrl || \"\";\n}, function (p) {\n  return p.showCoverImage && !p.isMobile && \"display: none;\";\n}, breakpoint.md(_templateObject2()), breakpoint.sm(_templateObject3()), breakpoint.xs(_templateObject4()));\nvar Headline = styled.div.withConfig({\n  displayName: \"DisplayPanel__Headline\",\n  componentId: \"s1e0gfmg-4\"\n})([\"\", \";line-height:1.23em;margin-bottom:3px;\"], unica(\"s16\", \"medium\"));\nvar Body = styled.div.withConfig({\n  displayName: \"DisplayPanel__Body\",\n  componentId: \"s1e0gfmg-5\"\n})([\"\", \";line-height:1.53em;margin-bottom:20px;a{color:black;}\"], garamond(\"s17\"));\nvar SponsoredBy = styled.div.withConfig({\n  displayName: \"DisplayPanel__SponsoredBy\",\n  componentId: \"s1e0gfmg-6\"\n})([\"\", \";color:\", \";\"], avantgarde(\"s11\"), Colors.grayRegular);\nvar VideoContainer = styled(Image).withConfig({\n  displayName: \"DisplayPanel__VideoContainer\",\n  componentId: \"s1e0gfmg-7\"\n})([\"position:relative;overflow:hidden;display:flex;align-items:center;video{object-fit:cover;object-position:50%;width:100%;height:100%;}\"]);\n\nvar iconPositioning = function iconPositioning(side) {\n  return \"\\n  position: absolute;\\n  bottom: 13px;\\n  \".concat(side, \": 15px;\\n\");\n};\n\nvar VideoPlayIcon = styled.div.withConfig({\n  displayName: \"DisplayPanel__VideoPlayIcon\",\n  componentId: \"s1e0gfmg-8\"\n})([\"color:white;border-top:13px solid transparent;border-bottom:13px solid transparent;border-left:20px solid white;\", \";\"], iconPositioning(\"left\"));\nvar MutedIcon = styled.div.withConfig({\n  displayName: \"DisplayPanel__MutedIcon\",\n  componentId: \"s1e0gfmg-9\"\n})([\"\", \";\"], iconPositioning(\"right\"));\nvar UnmutedIcon = styled.div.withConfig({\n  displayName: \"DisplayPanel__UnmutedIcon\",\n  componentId: \"s1e0gfmg-10\"\n})([\"z-index:3;\", \";right:14px;bottom:12px;\"], iconPositioning(\"right\")); // Set names for tests and DOM\n\nDisplayPanelContainer.displayName = \"DisplayPanelContainer\";\nImage.displayName = \"Image\";\nVideoContainer.displayName = \"VideoContainer\";\nVideoCover.displayName = \"VideoCover\";\nWrapper.displayName = \"Wrapper\";",{"version":3,"sources":["/Users/eve/development/reaction/src/Components/Publishing/Display/DisplayPanel.tsx"],"names":["avantgarde","garamond","unica","React","Component","track","Waypoint","styled","Colors","Events","crop","resize","ErrorBoundary","pMedia","breakpoint","getCurrentUnixTimestamp","VideoControls","PixelTracker","replaceWithCacheBuster","trackImpression","DisplayPanel","page","dispatch","data","postEvent","props","isMuted","isPlaying","showCoverImage","percentComplete","tracking","trackEvent","action","label","percent_complete","campaign_name","campaign","name","unit_layout","secondsComplete","seconds_complete","e","stopPropagation","setState","state","handleClick","bind","handleMouseEnter","handleMouseLeave","video","onended","pauseVideo","removeEventListener","trackProgress","addEventListener","muted","Math","floor","currentTime","duration","percentCompleteInterval","trackDuration","trackSeconds","event","valid","withinMediaArea","some","className","target","includes","preventDefault","alreadyClicked","isMobile","unit","url","isVideo","openUrl","entity_type","window","open","isWithinMediaArea","trackVideoClick","toggleVideo","toggleCoverImage","playVideo","logo","pause","play","assetUrl","toggleMuted","renderVideoIcon","renderTime","assets","imageUrl","width","height","isDisplayAd","hoverImageUrl","coverUrl","cover_image_url","renderVideo","headline","__html","body","x","Wrapper","div","sm","Image","VideoCover","DisplayPanelContainer","grayRegular","p","md","xs","Headline","Body","SponsoredBy","VideoContainer","iconPositioning","side","VideoPlayIcon","MutedIcon","UnmutedIcon","displayName"],"mappings":"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","sourcesContent":["import { avantgarde, garamond, unica } from \"Assets/Fonts\"\nimport { get, memoize } from \"lodash\"\nimport React, { Component, HTMLProps } from \"react\"\nimport track from \"react-tracking\"\nimport Waypoint from \"react-waypoint\"\nimport styled from \"styled-components\"\nimport Colors from \"../../../Assets/Colors\"\nimport Events from \"../../../Utils/Events\"\nimport { crop, resize } from \"../../../Utils/resizer\"\nimport { ErrorBoundary } from \"../../ErrorBoundary\"\nimport { pMedia as breakpoint } from \"../../Helpers\"\nimport { getCurrentUnixTimestamp } from \"../Constants\"\nimport { VideoControls } from \"../Sections/VideoControls\"\nimport { PixelTracker, replaceWithCacheBuster } from \"./ExternalTrackers\"\nimport { trackImpression } from \"./track-once\"\n\nexport interface DisplayPanelProps extends React.HTMLProps<HTMLDivElement> {\n  campaign: any\n  article?: any\n  isMobile?: boolean\n  unit: any\n  tracking?: any\n  renderTime?: number\n}\n\nexport interface DisplayPanelState {\n  isPlaying: boolean\n  isMuted: boolean\n  showCoverImage: boolean\n}\n\ninterface DivUrlProps extends HTMLProps<HTMLDivElement> {\n  coverUrl?: string\n  hoverImageUrl?: string\n  isMobile?: boolean\n  imageUrl?: string\n  showCoverImage?: boolean\n}\n\n@track(\n  { page: \"Article\" },\n  {\n    dispatch: data => Events.postEvent(data),\n  }\n)\nexport class DisplayPanel extends Component<\n  DisplayPanelProps,\n  DisplayPanelState\n> {\n  public video: HTMLVideoElement\n\n  state = {\n    isMuted: true,\n    isPlaying: false,\n    showCoverImage: false,\n  }\n\n  static defaultProps = {\n    tracking: {\n      trackEvent: x => x,\n    },\n  }\n\n  constructor(props) {\n    super(props)\n    this.handleClick = this.handleClick.bind(this)\n    this.handleMouseEnter = this.handleMouseEnter.bind(this)\n    this.handleMouseLeave = this.handleMouseLeave.bind(this)\n    this.trackImpression = this.trackImpression.bind(this)\n  }\n\n  componentDidMount() {\n    if (this.video) {\n      this.video.onended = this.pauseVideo\n    }\n  }\n\n  componentWillUpdate() {\n    if (this.video) {\n      this.video.removeEventListener(\n        \"timeupdate\",\n        this.trackProgress.bind(this)\n      )\n    }\n  }\n\n  componentDidUpdate() {\n    if (this.video) {\n      this.video.addEventListener(\"timeupdate\", this.trackProgress.bind(this))\n      this.video.muted = this.state.isMuted\n    }\n  }\n\n  @trackImpression(() => \"panel\")\n  trackImpression() {\n    // noop\n  }\n\n  // TODO: This could be shared with <CanvasVideo />\n  trackProgress() {\n    const secondsComplete = Math.floor(this.video.currentTime)\n    const percentComplete = Math.floor(\n      (this.video.currentTime / this.video.duration) * 100\n    )\n    const percentCompleteInterval = Math.floor(percentComplete / 25) * 25\n\n    // Track 25% duration intervals\n    if (percentCompleteInterval > 0) {\n      this.trackDuration(percentCompleteInterval)\n    }\n\n    // Track 3 & 10 seconds\n    if (secondsComplete === 3 || secondsComplete === 10) {\n      this.trackSeconds(secondsComplete)\n    }\n  }\n\n  trackDuration = memoize(percentComplete => {\n    this.props.tracking.trackEvent({\n      action: \"Video duration\",\n      label: \"Display ad video duration\",\n      percent_complete: percentComplete,\n      campaign_name: this.props.campaign.name,\n      unit_layout: \"panel\",\n    })\n  })\n\n  trackSeconds = memoize(secondsComplete => {\n    this.props.tracking.trackEvent({\n      action: \"Video seconds\",\n      label: \"Display ad video seconds\",\n      seconds_complete: secondsComplete,\n      campaign_name: this.props.campaign.name,\n      unit_layout: \"panel\",\n    })\n  })\n\n  isWithinMediaArea(event) {\n    const valid = [\n      \"DisplayPanel__Image\",\n      \"VideoContainer\",\n      \"VideoContainer__VideoCover\",\n      \"VideoContainer__VideoControls\",\n      \"VideoContainer__video\",\n      \"PlayButton\",\n      \"PlayButton__PlayButtonCaret\",\n    ]\n    const withinMediaArea = valid.some(className =>\n      event.target.className.includes(className)\n    )\n    return withinMediaArea\n  }\n\n  handleClick(event) {\n    event.preventDefault()\n    const { showCoverImage: alreadyClicked } = this.state\n    const { campaign, isMobile, tracking, unit } = this.props\n    const url = get(unit, \"link.url\", false)\n    const isVideo = this.isVideo()\n\n    const openUrl = () => {\n      tracking.trackEvent({\n        action: \"Click\",\n        label: \"Display ad clickthrough\",\n        entity_type: \"display_ad\",\n        campaign_name: campaign.name,\n        unit_layout: \"panel\",\n      })\n\n      if (url)\n        window.open(\n          replaceWithCacheBuster(url, getCurrentUnixTimestamp()) || \"\",\n          \"_blank\"\n        )\n    }\n\n    if (isMobile) {\n      if (isVideo) {\n        if (this.isWithinMediaArea(event)) {\n          this.trackVideoClick()\n          this.toggleVideo()\n        } else {\n          openUrl()\n        }\n        // Image\n      } else {\n        if (this.isWithinMediaArea(event)) {\n          if (alreadyClicked) {\n            openUrl()\n            this.toggleCoverImage()\n          } else {\n            this.toggleCoverImage()\n          }\n          // Clicked outside of the media area\n        } else {\n          openUrl()\n        }\n      }\n      // Desktop\n    } else {\n      if (isVideo) {\n        this.pauseVideo()\n      }\n      openUrl()\n    }\n  }\n\n  /**\n   * Handle MouseEnter, on desktop\n   */\n  handleMouseEnter() {\n    if (this.props.isMobile) {\n      return false\n    } else {\n      if (this.isVideo()) {\n        this.playVideo()\n\n        this.props.tracking.trackEvent({\n          action: \"MouseEnter\",\n          label: \"Display ad play video\",\n          entity_type: \"display_ad\",\n          campaign_name: this.props.campaign.name,\n          unit_layout: \"panel\",\n        })\n      } else {\n        this.toggleCoverImage()\n      }\n    }\n  }\n\n  /**\n   * Handle MouseLeave, on desktop\n   */\n  handleMouseLeave() {\n    if (this.props.isMobile) {\n      return false\n    } else {\n      if (this.isVideo()) {\n        this.pauseVideo()\n      } else {\n        this.toggleCoverImage()\n      }\n    }\n  }\n\n  toggleCoverImage() {\n    if (this.props.unit.logo) {\n      const showCoverImage = !this.state.showCoverImage\n      this.setState({\n        showCoverImage,\n      })\n    }\n  }\n\n  toggleVideo() {\n    if (this.state.isPlaying) {\n      this.pauseVideo()\n    } else {\n      this.playVideo()\n    }\n  }\n\n  pauseVideo() {\n    if (this.video) {\n      this.video.pause()\n\n      this.setState({\n        isPlaying: false,\n      })\n    }\n  }\n\n  playVideo() {\n    if (this.video) {\n      this.video.play()\n\n      this.setState({\n        isPlaying: true,\n      })\n    }\n  }\n\n  /**\n   * Handle clicks to Video player\n   */\n  trackVideoClick() {\n    this.props.tracking.trackEvent({\n      action: \"Click\",\n      label: \"Display ad play video\",\n      entity_type: \"display_ad\",\n      campaign_name: this.props.campaign.name,\n      unit_layout: \"panel\",\n    })\n  }\n\n  isVideo() {\n    const assetUrl = get(this.props.unit, \"assets.0.url\", \"\")\n    const isVideo = assetUrl.includes(\"mp4\")\n    return isVideo\n  }\n\n  toggleMuted = e => {\n    e.stopPropagation()\n    this.setState({ isMuted: !this.state.isMuted })\n  }\n\n  renderVideoIcon() {\n    const { isPlaying, isMuted } = this.state\n    const { isMobile } = this.props\n\n    if (isMobile) {\n      return null\n    } else if (isPlaying && isMuted) {\n      return (\n        <MutedIcon onClick={this.toggleMuted}>\n          <svg width=\"30\" height=\"30\" xmlns=\"http://www.w3.org/2000/svg\">\n            <g fill=\"#FFF\">\n              <path d=\"M29.514 28L19.13 17.614 9.557 8.043 1.514 0 0 1.514l6.529 6.529H.757V21.47H11.83l7.3 7.286v-8.114L28 29.514zM19.129.757l-7.3 7.286 7.3 7.3z\" />\n            </g>\n          </svg>\n        </MutedIcon>\n      )\n    } else if (isPlaying && !isMuted) {\n      return (\n        <UnmutedIcon onClick={this.toggleMuted}>\n          <svg width=\"30\" height=\"30\" xmlns=\"http://www.w3.org/2000/svg\">\n            <g fill=\"#FFF\">\n              <path d=\"M18 12.864V0l-7.152 7.286H0v13.428h10.848L18 28V12.864z\" />\n            </g>\n          </svg>\n        </UnmutedIcon>\n      )\n    } else {\n      return <VideoPlayIcon />\n    }\n  }\n\n  renderVideo(url) {\n    const { isPlaying } = this.state\n    const { isMobile } = this.props\n\n    return (\n      <VideoContainer className=\"VideoContainer\">\n        {!isPlaying && (\n          <VideoCover className=\"VideoContainer__VideoCover\">\n            {isMobile && (\n              <VideoControls mini className=\"VideoContainer__VideoControls\" />\n            )}\n          </VideoCover>\n        )}\n\n        <video\n          playsInline\n          src={url}\n          className=\"VideoContainer__video\"\n          controls={false}\n          ref={video => (this.video = video)}\n        />\n        {this.renderVideoIcon()}\n      </VideoContainer>\n    )\n  }\n\n  render() {\n    const { showCoverImage } = this.state\n    const { unit, campaign, isMobile, renderTime } = this.props\n    const url = get(unit.assets, \"0.url\", \"\")\n    const isVideo = this.isVideo()\n    const imageUrl = isVideo\n      ? url\n      : crop(url, { width: 680, height: 284, isDisplayAd: true })\n    const hoverImageUrl = resize(unit.logo, { width: 680, isDisplayAd: true })\n    const coverUrl =\n      unit.cover_image_url &&\n      crop(unit.cover_image_url, { width: 680, height: 284, isDisplayAd: true })\n\n    return (\n      <ErrorBoundary>\n        <Wrapper\n          onClick={this.handleClick}\n          onMouseEnter={this.handleMouseEnter}\n          onMouseLeave={this.handleMouseLeave}\n        >\n          <Waypoint onEnter={this.trackImpression} />\n          <DisplayPanelContainer\n            className=\"DisplayPanel__DisplayPanelContainer\"\n            imageUrl={imageUrl}\n            isMobile={isMobile}\n            hoverImageUrl={hoverImageUrl}\n            coverUrl={coverUrl}\n            showCoverImage={showCoverImage}\n          >\n            {isVideo ? (\n              this.renderVideo(url)\n            ) : (\n              <Image className=\"DisplayPanel__Image\" />\n            )}\n\n            <div>\n              <Headline>{unit.headline}</Headline>\n\n              <Body\n                dangerouslySetInnerHTML={{\n                  __html: unit.body,\n                }}\n              />\n\n              <SponsoredBy>{`Sponsored by ${campaign.name}`}</SponsoredBy>\n            </div>\n          </DisplayPanelContainer>\n          <PixelTracker unit={unit} date={renderTime} />\n        </Wrapper>\n      </ErrorBoundary>\n    )\n  }\n}\n\nconst Wrapper = styled.div`\n  cursor: pointer;\n  text-decoration: none;\n  color: black;\n  max-width: 360px;\n\n  ${breakpoint.sm`\n    margin: 0 auto;\n  `};\n`\n\nconst Image = styled.div`\n  margin-bottom: 15px;\n  width: 100%;\n  height: 142px;\n  background-color: black;\n  box-sizing: border-box;\n`\n\nconst VideoCover = styled.div`\n  margin-bottom: 15px;\n  width: 100%;\n  height: 142px;\n  background-color: black;\n  box-sizing: border-box;\n  position: absolute;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`\n\nconst DisplayPanelContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  border: 1px solid ${Colors.grayRegular};\n  padding: 20px;\n  max-width: 360px;\n  box-sizing: border-box;\n\n  ${Image} {\n    background: url(${(p: DivUrlProps) => p.imageUrl || \"\"}) no-repeat center\n      center;\n    background-size: cover;\n\n    ${(p: DivUrlProps) =>\n      p.showCoverImage &&\n      p.hoverImageUrl &&\n      `\n        background: black url(${p.hoverImageUrl}) no-repeat center center;\n        background-size: contain;\n        border: 10px solid black;\n    `};\n  }\n\n  ${VideoCover} {\n    background: url(${(p: DivUrlProps) => p.coverUrl || \"\"}) no-repeat center\n      center;\n    background-size: cover;\n\n    ${(p: DivUrlProps) => p.showCoverImage && !p.isMobile && `display: none;`};\n  }\n\n  ${breakpoint.md`\n    margin: auto;\n  `};\n  ${breakpoint.sm`\n    margin: auto;\n  `};\n  ${breakpoint.xs`\n    margin: auto;\n  `};\n`\n\nconst Headline = styled.div`\n  ${unica(\"s16\", \"medium\")};\n  line-height: 1.23em;\n  margin-bottom: 3px;\n`\n\nconst Body = styled.div`\n  ${garamond(\"s17\")};\n  line-height: 1.53em;\n  margin-bottom: 20px;\n  a {\n    color: black;\n  }\n`\n\nconst SponsoredBy = styled.div`\n  ${avantgarde(\"s11\")};\n  color: ${Colors.grayRegular};\n`\n\nconst VideoContainer = styled(Image)`\n  position: relative;\n  overflow: hidden;\n  display: flex;\n  align-items: center;\n  video {\n    object-fit: cover;\n    object-position: 50%;\n    width: 100%;\n    height: 100%;\n  }\n`\n\nconst iconPositioning = side => `\n  position: absolute;\n  bottom: 13px;\n  ${side}: 15px;\n`\n\nconst VideoPlayIcon = styled.div`\n  color: white;\n  border-top: 13px solid transparent;\n  border-bottom: 13px solid transparent;\n  border-left: 20px solid white;\n  ${iconPositioning(\"left\")};\n`\n\nconst MutedIcon = styled.div`\n  ${iconPositioning(\"right\")};\n`\n\nconst UnmutedIcon = styled.div`\n  z-index: 3;\n  ${iconPositioning(\"right\")};\n  right: 14px;\n  bottom: 12px;\n`\n\n// Set names for tests and DOM\nDisplayPanelContainer.displayName = \"DisplayPanelContainer\"\nImage.displayName = \"Image\"\nVideoContainer.displayName = \"VideoContainer\"\nVideoCover.displayName = \"VideoCover\"\nWrapper.displayName = \"Wrapper\"\n"]}]}