{"remainingRequest":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js??ref--6-1!/Users/eve/development/reaction/src/Components/Publishing/ToolTip/TooltipsDataLoader.tsx","dependencies":[{"path":"/Users/eve/development/reaction/src/Components/Publishing/ToolTip/TooltipsDataLoader.tsx","mtime":1535727457000},{"path":"/Users/eve/development/reaction/.babelrc","mtime":1537112679000},{"path":"/Users/eve/development/reaction/node_modules/cache-loader/dist/cjs.js","mtime":0},{"path":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _keyBy from \"lodash/keyBy\";\n\nvar _graphql;\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport * as Artsy from \"../../../Artsy/SystemContext\";\nimport { getArtsySlugsFromArticle } from \"../Constants\";\nimport PropTypes from \"prop-types\";\nimport React, { Component } from \"react\";\nimport { graphql, QueryRenderer } from \"react-relay\";\nexport var TooltipsDataLoader =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(TooltipsDataLoader, _Component);\n\n  function TooltipsDataLoader() {\n    _classCallCheck(this, TooltipsDataLoader);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(TooltipsDataLoader).apply(this, arguments));\n  }\n\n  _createClass(TooltipsDataLoader, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          article = _this$props.article,\n          children = _this$props.children,\n          user = _this$props.user,\n          relayEnvironment = _this$props.relayEnvironment,\n          shouldFetchData = _this$props.shouldFetchData,\n          onOpenAuthModal = _this$props.onOpenAuthModal;\n\n      var _getArtsySlugsFromArt = getArtsySlugsFromArticle(article),\n          artistSlugs = _getArtsySlugsFromArt.artists,\n          geneSlugs = _getArtsySlugsFromArt.genes;\n\n      if (!shouldFetchData) {\n        return children;\n      }\n\n      return React.createElement(QueryRenderer, {\n        environment: relayEnvironment,\n        query: _graphql || (_graphql = function _graphql() {\n          var node = require(\"../../../__generated__/TooltipsDataLoaderQuery.graphql\");\n\n          if (node.hash && node.hash !== \"a2937409c3f2edc519a6b78d0d2a0a82\") {\n            console.error(\"The definition of 'TooltipsDataLoaderQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data.\");\n          }\n\n          return require(\"../../../__generated__/TooltipsDataLoaderQuery.graphql\");\n        }),\n        variables: {\n          artistSlugs: artistSlugs,\n          geneSlugs: geneSlugs\n        },\n        render: function render(readyState) {\n          var data = {\n            artists: [],\n            genes: []\n          };\n          Object.keys(readyState.props || {}).forEach(function (key) {\n            var col = readyState.props[key];\n            data[key] = _keyBy(col, \"id\");\n          });\n          return React.createElement(TooltipsContextProvider, _extends({}, data, {\n            user: user,\n            onOpenAuthModal: onOpenAuthModal\n          }), children);\n        }\n      });\n    }\n  }]);\n\n  return TooltipsDataLoader;\n}(Component);\n\n_defineProperty(TooltipsDataLoader, \"defaultProps\", {\n  shouldFetchData: true\n});\n\nvar TooltipsContextProvider =\n/*#__PURE__*/\nfunction (_Component2) {\n  _inherits(TooltipsContextProvider, _Component2);\n\n  function TooltipsContextProvider() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, TooltipsContextProvider);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(TooltipsContextProvider)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", {\n      activeToolTip: null,\n      waitForFade: null\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onTriggerToolTip\", function (activeToolTip) {\n      if (activeToolTip !== _this.state.activeToolTip) {\n        if (activeToolTip === null) {\n          setTimeout(function () {\n            _this.setState({\n              waitForFade: null\n            });\n          }, 250);\n        }\n\n        _this.setState({\n          activeToolTip: activeToolTip,\n          waitForFade: _this.state.activeToolTip\n        });\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(TooltipsContextProvider, [{\n    key: \"getChildContext\",\n    value: function getChildContext() {\n      var _this$props2 = this.props,\n          artists = _this$props2.artists,\n          user = _this$props2.user,\n          genes = _this$props2.genes,\n          onOpenAuthModal = _this$props2.onOpenAuthModal;\n      var _this$state = this.state,\n          activeToolTip = _this$state.activeToolTip,\n          waitForFade = _this$state.waitForFade;\n      return {\n        activeToolTip: activeToolTip,\n        user: user,\n        onOpenAuthModal: onOpenAuthModal,\n        onTriggerToolTip: this.onTriggerToolTip,\n        tooltipsData: {\n          artists: artists,\n          genes: genes\n        },\n        waitForFade: waitForFade\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return this.props.children;\n    }\n  }]);\n\n  return TooltipsContextProvider;\n}(Component);\n\n_defineProperty(TooltipsContextProvider, \"childContextTypes\", {\n  activeToolTip: PropTypes.any,\n  user: PropTypes.object,\n  onOpenAuthModal: PropTypes.func,\n  onTriggerToolTip: PropTypes.func,\n  tooltipsData: PropTypes.object,\n  waitForFade: PropTypes.string\n});\n\nexport var TooltipsData = Artsy.withContext(TooltipsDataLoader);",{"version":3,"sources":["/Users/eve/development/reaction/src/Components/Publishing/ToolTip/TooltipsDataLoader.tsx"],"names":["Artsy","getArtsySlugsFromArticle","PropTypes","React","Component","graphql","QueryRenderer","TooltipsDataLoader","props","article","children","user","relayEnvironment","shouldFetchData","onOpenAuthModal","artistSlugs","artists","geneSlugs","genes","readyState","data","Object","keys","forEach","key","col","TooltipsContextProvider","activeToolTip","waitForFade","state","setTimeout","setState","onTriggerToolTip","tooltipsData","any","object","func","string","TooltipsData","withContext"],"mappings":"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","sourcesContent":["import { TooltipsDataLoaderQueryResponse } from \"__generated__/TooltipsDataLoaderQuery.graphql\"\nimport { TooltipsDataLoaderQuery } from \"__generated__/TooltipsDataLoaderQuery.graphql\"\nimport * as Artsy from \"Artsy/SystemContext\"\nimport { getArtsySlugsFromArticle } from \"Components/Publishing/Constants\"\nimport { ArticleData } from \"Components/Publishing/Typings\"\nimport { keyBy } from \"lodash\"\nimport PropTypes from \"prop-types\"\nimport React, { Component } from \"react\"\nimport { graphql, QueryRenderer } from \"react-relay\"\nimport { ArticleProps } from \"../Article\"\n\ninterface Props extends Artsy.ContextProps {\n  article: ArticleData\n  shouldFetchData?: boolean\n  onOpenAuthModal?: ArticleProps[\"onOpenAuthModal\"]\n}\n\nexport class TooltipsDataLoader extends Component<Props> {\n  static defaultProps = {\n    shouldFetchData: true,\n  }\n\n  render() {\n    const {\n      article,\n      children,\n      user,\n      relayEnvironment,\n      shouldFetchData,\n      onOpenAuthModal,\n    } = this.props\n\n    const { artists: artistSlugs, genes: geneSlugs } = getArtsySlugsFromArticle(\n      article\n    )\n\n    if (!shouldFetchData) {\n      return children\n    }\n\n    return (\n      <QueryRenderer<TooltipsDataLoaderQuery>\n        environment={relayEnvironment}\n        query={graphql`\n          query TooltipsDataLoaderQuery(\n            $artistSlugs: [String!]\n            $geneSlugs: [String!]\n          ) {\n            artists(slugs: $artistSlugs) {\n              id\n              _id\n              ...ArtistToolTip_artist\n              ...MarketDataSummary_artist\n              ...FollowArtistButton_artist\n            }\n            genes(slugs: $geneSlugs) {\n              id\n              _id\n              ...GeneToolTip_gene\n              ...FollowGeneButton_gene\n            }\n          }\n        `}\n        variables={{\n          artistSlugs,\n          geneSlugs,\n        }}\n        render={readyState => {\n          const data: TooltipsDataLoaderQueryResponse = {\n            artists: [],\n            genes: [],\n          }\n          Object.keys(readyState.props || {}).forEach(key => {\n            const col = readyState.props[key]\n            data[key] = keyBy(col, \"id\")\n          })\n          return (\n            <TooltipsContextProvider\n              {...data}\n              user={user}\n              onOpenAuthModal={onOpenAuthModal}\n            >\n              {children}\n            </TooltipsContextProvider>\n          )\n        }}\n      />\n    )\n  }\n}\n\nclass TooltipsContextProvider extends Component<any> {\n  static childContextTypes = {\n    activeToolTip: PropTypes.any,\n    user: PropTypes.object,\n    onOpenAuthModal: PropTypes.func,\n    onTriggerToolTip: PropTypes.func,\n    tooltipsData: PropTypes.object,\n    waitForFade: PropTypes.string,\n  }\n\n  state = {\n    activeToolTip: null,\n    waitForFade: null,\n  }\n\n  onTriggerToolTip = activeToolTip => {\n    if (activeToolTip !== this.state.activeToolTip) {\n      if (activeToolTip === null) {\n        setTimeout(() => {\n          this.setState({ waitForFade: null })\n        }, 250)\n      }\n      this.setState({ activeToolTip, waitForFade: this.state.activeToolTip })\n    }\n  }\n\n  getChildContext() {\n    const { artists, user, genes, onOpenAuthModal } = this.props\n    const { activeToolTip, waitForFade } = this.state\n\n    return {\n      activeToolTip,\n      user,\n      onOpenAuthModal,\n      onTriggerToolTip: this.onTriggerToolTip,\n      tooltipsData: {\n        artists,\n        genes,\n      },\n      waitForFade,\n    }\n  }\n\n  render() {\n    return this.props.children\n  }\n}\n\nexport const TooltipsData = Artsy.withContext(TooltipsDataLoader)\n"]}]}