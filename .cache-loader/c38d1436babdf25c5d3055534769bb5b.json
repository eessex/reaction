{"remainingRequest":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js??ref--5-1!/Users/eve/development/reaction/src/Components/Publishing/Display/DisplayPanel.tsx","dependencies":[{"path":"/Users/eve/development/reaction/src/Components/Publishing/Display/DisplayPanel.tsx","mtime":1527877289000},{"path":"/Users/eve/development/reaction/.babelrc","mtime":1527877289000},{"path":"/Users/eve/development/reaction/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/eve/development/reaction/node_modules/babel-loader/lib/index.js","mtime":1509489566000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DisplayPanel = void 0;\n\nvar _lodash = require(\"lodash\");\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _reactWaypoint = _interopRequireDefault(require(\"react-waypoint\"));\n\nvar _styledComponents = _interopRequireDefault(require(\"styled-components\"));\n\nvar _Colors = _interopRequireDefault(require(\"../../../Assets/Colors\"));\n\nvar _Events = _interopRequireDefault(require(\"../../../Utils/Events\"));\n\nvar _resizer = require(\"../../../Utils/resizer\");\n\nvar _track = require(\"../../../Utils/track\");\n\nvar _Helpers = require(\"../../Helpers\");\n\nvar _Fonts = require(\"../../../Assets/Fonts\");\n\nvar _ErrorBoundary = require(\"../../ErrorBoundary\");\n\nvar _VideoControls = require(\"../Sections/VideoControls\");\n\nvar _trackOnce = require(\"./track-once\");\n\nvar _ExternalTrackers = require(\"./ExternalTrackers\");\n\nvar _Constants = require(\"../Constants\");\n\nvar _dec, _dec2, _class, _class2;\n\nvar _templateObject = /*#__PURE__*/ _taggedTemplateLiteral([\"\\n    margin: 0 auto;\\n  \"], [\"\\n    margin: 0 auto;\\n  \"]),\n    _templateObject2 = /*#__PURE__*/ _taggedTemplateLiteral([\"\\n    margin: auto;\\n  \"], [\"\\n    margin: auto;\\n  \"]);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _taggedTemplateLiteral(strings, raw) { return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object['ke' + 'ys'](descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object['define' + 'Property'](target, property, desc); desc = null; } return desc; }\n\nvar DisplayPanel = (_dec = (0, _track.track)({\n  page: \"Article\"\n}, {\n  dispatch: function dispatch(data) {\n    return _Events.default.postEvent(data);\n  }\n}), _dec2 = (0, _trackOnce.trackImpression)(function () {\n  return \"panel\";\n}), _dec(_class = (_class2 =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(DisplayPanel, _Component);\n\n  function DisplayPanel(props) {\n    var _this;\n\n    _classCallCheck(this, DisplayPanel);\n\n    _this = _possibleConstructorReturn(this, (DisplayPanel.__proto__ || Object.getPrototypeOf(DisplayPanel)).call(this, props));\n    Object.defineProperty(_assertThisInitialized(_this), \"video\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_assertThisInitialized(_this), \"state\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: {\n        isMuted: true,\n        isPlaying: false,\n        showCoverImage: false\n      }\n    });\n    Object.defineProperty(_assertThisInitialized(_this), \"trackDuration\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: (0, _lodash.memoize)(function (percentComplete) {\n        _this.props.tracking.trackEvent({\n          action: \"Video duration\",\n          label: \"Display ad video duration\",\n          percent_complete: percentComplete,\n          campaign_name: _this.props.campaign.name,\n          unit_layout: \"panel\"\n        });\n      })\n    });\n    Object.defineProperty(_assertThisInitialized(_this), \"trackSeconds\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: (0, _lodash.memoize)(function (secondsComplete) {\n        _this.props.tracking.trackEvent({\n          action: \"Video seconds\",\n          label: \"Display ad video seconds\",\n          seconds_complete: secondsComplete,\n          campaign_name: _this.props.campaign.name,\n          unit_layout: \"panel\"\n        });\n      })\n    });\n    Object.defineProperty(_assertThisInitialized(_this), \"toggleMuted\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: function value(e) {\n        e.stopPropagation();\n\n        _this.setState({\n          isMuted: !_this.state.isMuted\n        });\n      }\n    });\n    _this.handleClick = _this.handleClick.bind(_assertThisInitialized(_this));\n    _this.handleMouseEnter = _this.handleMouseEnter.bind(_assertThisInitialized(_this));\n    _this.handleMouseLeave = _this.handleMouseLeave.bind(_assertThisInitialized(_this));\n    _this.trackImpression = _this.trackImpression.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(DisplayPanel, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.video) {\n        this.video.onended = this.pauseVideo;\n      }\n    }\n  }, {\n    key: \"componentWillUpdate\",\n    value: function componentWillUpdate() {\n      if (this.video) {\n        this.video.removeEventListener(\"timeupdate\", this.trackProgress.bind(this));\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      if (this.video) {\n        this.video.addEventListener(\"timeupdate\", this.trackProgress.bind(this));\n        this.video.muted = this.state.isMuted;\n      }\n    }\n  }, {\n    key: \"trackImpression\",\n    value: function trackImpression() {} // noop\n    // TODO: This could be shared with <CanvasVideo />\n\n  }, {\n    key: \"trackProgress\",\n    value: function trackProgress() {\n      var secondsComplete = Math.floor(this.video.currentTime);\n      var percentComplete = Math.floor(this.video.currentTime / this.video.duration * 100);\n      var percentCompleteInterval = Math.floor(percentComplete / 25) * 25; // Track 25% duration intervals\n\n      if (percentCompleteInterval > 0) {\n        this.trackDuration(percentCompleteInterval);\n      } // Track 3 & 10 seconds\n\n\n      if (secondsComplete === 3 || secondsComplete === 10) {\n        this.trackSeconds(secondsComplete);\n      }\n    }\n  }, {\n    key: \"isWithinMediaArea\",\n    value: function isWithinMediaArea(event) {\n      var valid = [\"DisplayPanel__Image\", \"VideoContainer\", \"VideoContainer__VideoCover\", \"VideoContainer__VideoControls\", \"VideoContainer__video\", \"PlayButton\", \"PlayButton__PlayButtonCaret\"];\n      var withinMediaArea = valid.some(function (className) {\n        return event.target.className.includes(className);\n      });\n      return withinMediaArea;\n    }\n  }, {\n    key: \"handleClick\",\n    value: function handleClick(event) {\n      event.preventDefault();\n      var alreadyClicked = this.state.showCoverImage;\n      var _props = this.props,\n          campaign = _props.campaign,\n          isMobile = _props.isMobile,\n          tracking = _props.tracking,\n          unit = _props.unit;\n      var url = (0, _lodash.get)(unit, \"link.url\", false);\n      var isVideo = this.isVideo();\n\n      var openUrl = function openUrl() {\n        tracking.trackEvent({\n          action: \"Click\",\n          label: \"Display ad clickthrough\",\n          entity_type: \"display_ad\",\n          campaign_name: campaign.name,\n          unit_layout: \"panel\"\n        });\n        if (url) window.open((0, _ExternalTrackers.replaceWithCacheBuster)(url, (0, _Constants.getCurrentUnixTimestamp)()), \"_blank\");\n      };\n\n      if (isMobile) {\n        if (isVideo) {\n          if (this.isWithinMediaArea(event)) {\n            this.trackVideoClick();\n            this.toggleVideo();\n          } else {\n            openUrl();\n          } // Image\n\n        } else {\n          if (this.isWithinMediaArea(event)) {\n            if (alreadyClicked) {\n              openUrl();\n              this.toggleCoverImage();\n            } else {\n              this.toggleCoverImage();\n            } // Clicked outside of the media area\n\n          } else {\n            openUrl();\n          }\n        } // Desktop\n\n      } else {\n        if (isVideo) {\n          this.pauseVideo();\n        }\n\n        openUrl();\n      }\n    }\n    /**\n     * Handle MouseEnter, on desktop\n     */\n\n  }, {\n    key: \"handleMouseEnter\",\n    value: function handleMouseEnter() {\n      if (this.props.isMobile) {\n        return false;\n      } else {\n        if (this.isVideo()) {\n          this.playVideo();\n          this.props.tracking.trackEvent({\n            action: \"MouseEnter\",\n            label: \"Display ad play video\",\n            entity_type: \"display_ad\",\n            campaign_name: this.props.campaign.name,\n            unit_layout: \"panel\"\n          });\n        } else {\n          this.toggleCoverImage();\n        }\n      }\n    }\n    /**\n     * Handle MouseLeave, on desktop\n     */\n\n  }, {\n    key: \"handleMouseLeave\",\n    value: function handleMouseLeave() {\n      if (this.props.isMobile) {\n        return false;\n      } else {\n        if (this.isVideo()) {\n          this.pauseVideo();\n        } else {\n          this.toggleCoverImage();\n        }\n      }\n    }\n  }, {\n    key: \"toggleCoverImage\",\n    value: function toggleCoverImage() {\n      if (this.props.unit.logo) {\n        var _showCoverImage = !this.state.showCoverImage;\n\n        this.setState({\n          showCoverImage: _showCoverImage\n        });\n      }\n    }\n  }, {\n    key: \"toggleVideo\",\n    value: function toggleVideo() {\n      if (this.state.isPlaying) {\n        this.pauseVideo();\n      } else {\n        this.playVideo();\n      }\n    }\n  }, {\n    key: \"pauseVideo\",\n    value: function pauseVideo() {\n      if (this.video) {\n        this.video.pause();\n        this.setState({\n          isPlaying: false\n        });\n      }\n    }\n  }, {\n    key: \"playVideo\",\n    value: function playVideo() {\n      if (this.video) {\n        this.video.play();\n        this.setState({\n          isPlaying: true\n        });\n      }\n    }\n    /**\n     * Handle clicks to Video player\n     */\n\n  }, {\n    key: \"trackVideoClick\",\n    value: function trackVideoClick() {\n      this.props.tracking.trackEvent({\n        action: \"Click\",\n        label: \"Display ad play video\",\n        entity_type: \"display_ad\",\n        campaign_name: this.props.campaign.name,\n        unit_layout: \"panel\"\n      });\n    }\n  }, {\n    key: \"isVideo\",\n    value: function isVideo() {\n      var assetUrl = (0, _lodash.get)(this.props.unit, \"assets.0.url\", \"\");\n      var isVideo = assetUrl.includes(\"mp4\");\n      return isVideo;\n    }\n  }, {\n    key: \"renderVideoIcon\",\n    value: function renderVideoIcon() {\n      var _state = this.state,\n          isPlaying = _state.isPlaying,\n          isMuted = _state.isMuted;\n      var isMobile = this.props.isMobile;\n\n      if (isMobile) {\n        return null;\n      } else if (isPlaying && isMuted) {\n        return _react.default.createElement(MutedIcon, {\n          onClick: this.toggleMuted\n        }, _react.default.createElement(\"svg\", {\n          width: \"30\",\n          height: \"30\",\n          xmlns: \"http://www.w3.org/2000/svg\"\n        }, _react.default.createElement(\"g\", {\n          fill: \"#FFF\"\n        }, _react.default.createElement(\"path\", {\n          d: \"M29.514 28L19.13 17.614 9.557 8.043 1.514 0 0 1.514l6.529 6.529H.757V21.47H11.83l7.3 7.286v-8.114L28 29.514zM19.129.757l-7.3 7.286 7.3 7.3z\"\n        }))));\n      } else if (isPlaying && !isMuted) {\n        return _react.default.createElement(UnmutedIcon, {\n          onClick: this.toggleMuted\n        }, _react.default.createElement(\"svg\", {\n          width: \"30\",\n          height: \"30\",\n          xmlns: \"http://www.w3.org/2000/svg\"\n        }, _react.default.createElement(\"g\", {\n          fill: \"#FFF\"\n        }, _react.default.createElement(\"path\", {\n          d: \"M18 12.864V0l-7.152 7.286H0v13.428h10.848L18 28V12.864z\"\n        }))));\n      } else {\n        return _react.default.createElement(VideoPlayIcon, null);\n      }\n    }\n  }, {\n    key: \"renderVideo\",\n    value: function renderVideo(url) {\n      var _this2 = this;\n\n      var isPlaying = this.state.isPlaying;\n      var isMobile = this.props.isMobile;\n      return _react.default.createElement(VideoContainer, {\n        className: \"VideoContainer\"\n      }, !isPlaying && _react.default.createElement(VideoCover, {\n        className: \"VideoContainer__VideoCover\"\n      }, isMobile && _react.default.createElement(_VideoControls.VideoControls, {\n        mini: true,\n        className: \"VideoContainer__VideoControls\"\n      })), _react.default.createElement(\"video\", {\n        playsInline: true,\n        src: url,\n        className: \"VideoContainer__video\",\n        controls: false,\n        ref: function ref(video) {\n          return _this2.video = video;\n        }\n      }), this.renderVideoIcon());\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var showCoverImage = this.state.showCoverImage;\n      var _props2 = this.props,\n          unit = _props2.unit,\n          campaign = _props2.campaign,\n          isMobile = _props2.isMobile,\n          renderTime = _props2.renderTime;\n      var url = (0, _lodash.get)(unit.assets, \"0.url\", \"\");\n      var isVideo = this.isVideo();\n      var cover = unit.cover_image_url || \"\";\n      var imageUrl = (0, _resizer.crop)(url, {\n        width: 680,\n        height: 284,\n        isDisplayAd: true\n      });\n      var hoverImageUrl = (0, _resizer.resize)(unit.logo, {\n        width: 680,\n        isDisplayAd: true\n      });\n      var coverUrl = (0, _resizer.crop)(cover, {\n        width: 680,\n        height: 284,\n        isDisplayAd: true\n      });\n      return _react.default.createElement(_ErrorBoundary.ErrorBoundary, null, _react.default.createElement(Wrapper, {\n        onClick: this.handleClick,\n        onMouseEnter: this.handleMouseEnter,\n        onMouseLeave: this.handleMouseLeave\n      }, _react.default.createElement(_reactWaypoint.default, {\n        onEnter: this.trackImpression\n      }), _react.default.createElement(DisplayPanelContainer, {\n        className: \"DisplayPanel__DisplayPanelContainer\",\n        imageUrl: imageUrl,\n        isMobile: isMobile,\n        hoverImageUrl: hoverImageUrl,\n        coverUrl: coverUrl,\n        showCoverImage: showCoverImage\n      }, isVideo ? this.renderVideo(url) : _react.default.createElement(Image, {\n        className: \"DisplayPanel__Image\"\n      }), _react.default.createElement(\"div\", null, _react.default.createElement(Headline, null, unit.headline), _react.default.createElement(Body, {\n        dangerouslySetInnerHTML: {\n          __html: unit.body\n        }\n      }), _react.default.createElement(SponsoredBy, null, \"Sponsored by \".concat(campaign.name)))), _react.default.createElement(_ExternalTrackers.PixelTracker, {\n        unit: unit,\n        date: renderTime\n      })));\n    }\n  }]);\n\n  return DisplayPanel;\n}(_react.Component), (_applyDecoratedDescriptor(_class2.prototype, \"trackImpression\", [_dec2], Object.getOwnPropertyDescriptor(_class2.prototype, \"trackImpression\"), _class2.prototype)), _class2)) || _class);\nexports.DisplayPanel = DisplayPanel;\nObject.defineProperty(DisplayPanel, \"defaultProps\", {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  value: {\n    tracking: {\n      trackEvent: function trackEvent(x) {\n        return x;\n      }\n    }\n  }\n});\n\nvar Wrapper =\n/*#__PURE__*/\n_styledComponents.default.div.withConfig({\n  displayName: \"DisplayPanel__Wrapper\",\n  componentId: \"s1e0gfmg-0\"\n})([\"cursor:pointer;text-decoration:none;color:black;max-width:360px;\", \";\"], _Helpers.pMedia.sm(_templateObject));\n\nvar Image =\n/*#__PURE__*/\n_styledComponents.default.div.withConfig({\n  displayName: \"DisplayPanel__Image\",\n  componentId: \"s1e0gfmg-1\"\n})([\"margin-bottom:15px;width:100%;height:142px;background-color:black;box-sizing:border-box;\"]);\n\nvar VideoCover =\n/*#__PURE__*/\n_styledComponents.default.div.withConfig({\n  displayName: \"DisplayPanel__VideoCover\",\n  componentId: \"s1e0gfmg-2\"\n})([\"margin-bottom:15px;width:100%;height:142px;background-color:black;box-sizing:border-box;position:absolute;display:flex;align-items:center;justify-content:center;\"]);\n\nvar DisplayPanelContainer =\n/*#__PURE__*/\n_styledComponents.default.div.withConfig({\n  displayName: \"DisplayPanel__DisplayPanelContainer\",\n  componentId: \"s1e0gfmg-3\"\n})([\"display:flex;flex-direction:column;border:1px solid \", \";padding:20px;max-width:360px;box-sizing:border-box;\", \"{background:url(\", \") no-repeat center center;background-size:cover;\", \";}\", \"{background:url(\", \") no-repeat center center;background-size:cover;\", \";}\", \";\", \";\", \";\"], _Colors.default.grayRegular, Image, function (p) {\n  return p.imageUrl || \"\";\n}, function (p) {\n  return p.showCoverImage && p.hoverImageUrl && \"\\n        background: black url(\".concat(p.hoverImageUrl, \") no-repeat center center;\\n        background-size: contain;\\n        border: 10px solid black;\\n    \");\n}, VideoCover, function (p) {\n  return p.coverUrl || \"\";\n}, function (p) {\n  return p.showCoverImage && !p.isMobile && \"display: none;\";\n}, _Helpers.pMedia.md(_templateObject2), _Helpers.pMedia.sm(_templateObject2), _Helpers.pMedia.xs(_templateObject2));\n\nvar Headline =\n/*#__PURE__*/\n_styledComponents.default.div.withConfig({\n  displayName: \"DisplayPanel__Headline\",\n  componentId: \"s1e0gfmg-4\"\n})([\"\", \";line-height:1.23em;margin-bottom:3px;\"], (0, _Fonts.unica)(\"s16\", \"medium\"));\n\nvar Body =\n/*#__PURE__*/\n_styledComponents.default.div.withConfig({\n  displayName: \"DisplayPanel__Body\",\n  componentId: \"s1e0gfmg-5\"\n})([\"\", \";line-height:1.53em;margin-bottom:20px;a{color:black;}\"], (0, _Fonts.garamond)(\"s17\"));\n\nvar SponsoredBy =\n/*#__PURE__*/\n_styledComponents.default.div.withConfig({\n  displayName: \"DisplayPanel__SponsoredBy\",\n  componentId: \"s1e0gfmg-6\"\n})([\"\", \";color:\", \";\"], (0, _Fonts.avantgarde)(\"s11\"), _Colors.default.grayRegular);\n\nvar VideoContainer =\n/*#__PURE__*/\n(0, _styledComponents.default)(Image).withConfig({\n  displayName: \"DisplayPanel__VideoContainer\",\n  componentId: \"s1e0gfmg-7\"\n})([\"position:relative;overflow:hidden;display:flex;align-items:center;video{object-fit:cover;object-position:50%;width:100%;height:100%;}\"]);\n\nvar iconPositioning = function iconPositioning(side) {\n  return \"\\n  position: absolute;\\n  bottom: 13px;\\n  \".concat(side, \": 15px;\\n\");\n};\n\nvar VideoPlayIcon =\n/*#__PURE__*/\n_styledComponents.default.div.withConfig({\n  displayName: \"DisplayPanel__VideoPlayIcon\",\n  componentId: \"s1e0gfmg-8\"\n})([\"color:white;border-top:13px solid transparent;border-bottom:13px solid transparent;border-left:20px solid white;\", \";\"], iconPositioning(\"left\"));\n\nvar MutedIcon =\n/*#__PURE__*/\n_styledComponents.default.div.withConfig({\n  displayName: \"DisplayPanel__MutedIcon\",\n  componentId: \"s1e0gfmg-9\"\n})([\"\", \";\"], iconPositioning(\"right\"));\n\nvar UnmutedIcon =\n/*#__PURE__*/\n_styledComponents.default.div.withConfig({\n  displayName: \"DisplayPanel__UnmutedIcon\",\n  componentId: \"s1e0gfmg-10\"\n})([\"z-index:3;\", \";right:14px;bottom:12px;\"], iconPositioning(\"right\")); // Set names for tests and DOM\n\n\nDisplayPanelContainer.displayName = \"DisplayPanelContainer\";\nImage.displayName = \"Image\";\nVideoContainer.displayName = \"VideoContainer\";\nVideoCover.displayName = \"VideoCover\";\nWrapper.displayName = \"Wrapper\";",{"version":3,"sources":["src/Components/Publishing/Display/DisplayPanel.tsx"],"names":["DisplayPanel","page","dispatch","postEvent","data","props","isMuted","isPlaying","showCoverImage","tracking","trackEvent","action","label","percent_complete","percentComplete","campaign_name","campaign","name","unit_layout","seconds_complete","secondsComplete","e","stopPropagation","setState","state","handleClick","bind","handleMouseEnter","handleMouseLeave","trackImpression","video","onended","pauseVideo","removeEventListener","trackProgress","addEventListener","muted","Math","floor","currentTime","duration","percentCompleteInterval","trackDuration","trackSeconds","event","valid","withinMediaArea","some","target","className","includes","preventDefault","alreadyClicked","isMobile","unit","url","isVideo","openUrl","entity_type","window","open","isWithinMediaArea","trackVideoClick","toggleVideo","toggleCoverImage","playVideo","logo","pause","play","assetUrl","toggleMuted","renderVideoIcon","renderTime","assets","cover","cover_image_url","imageUrl","width","height","isDisplayAd","hoverImageUrl","coverUrl","renderVideo","headline","__html","body","x","Wrapper","div","sm","Image","VideoCover","DisplayPanelContainer","grayRegular","p","md","xs","Headline","Body","SponsoredBy","VideoContainer","iconPositioning","side","VideoPlayIcon","MutedIcon","UnmutedIcon","displayName"],"mappings":"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","file":"/Users/eve/development/reaction/src/Components/Publishing/Display/DisplayPanel.tsx","sourceRoot":"/Users/eve/development/reaction","sourcesContent":["import { get, memoize } from \"lodash\"\nimport React, { Component, HTMLProps } from \"react\"\nimport Waypoint from \"react-waypoint\"\nimport styled from \"styled-components\"\nimport Colors from \"../../../Assets/Colors\"\nimport Events from \"../../../Utils/Events\"\nimport { crop, resize } from \"../../../Utils/resizer\"\nimport { track } from \"../../../Utils/track\"\nimport { pMedia as breakpoint } from \"../../Helpers\"\nimport { avantgarde, garamond, unica } from \"Assets/Fonts\"\nimport { ErrorBoundary } from \"../../ErrorBoundary\"\nimport { VideoControls } from \"../Sections/VideoControls\"\nimport { trackImpression } from \"./track-once\"\nimport { PixelTracker, replaceWithCacheBuster } from \"./ExternalTrackers\"\nimport { getCurrentUnixTimestamp } from \"../Constants\"\n\ninterface Props extends React.HTMLProps<HTMLDivElement> {\n  campaign: any\n  article?: any\n  isMobile?: boolean\n  unit: any\n  tracking?: any\n  renderTime?: string\n}\n\ninterface State {\n  isPlaying: boolean\n  isMuted: boolean\n  showCoverImage: boolean\n}\n\ninterface DivUrlProps extends HTMLProps<HTMLDivElement> {\n  coverUrl?: string\n  hoverImageUrl?: string\n  isMobile?: boolean\n  imageUrl?: string\n  showCoverImage?: boolean\n}\n\n@track(\n  { page: \"Article\" },\n  {\n    dispatch: data => Events.postEvent(data),\n  }\n)\nexport class DisplayPanel extends Component<Props, State> {\n  public video: HTMLVideoElement\n\n  state = {\n    isMuted: true,\n    isPlaying: false,\n    showCoverImage: false,\n  }\n\n  static defaultProps = {\n    tracking: {\n      trackEvent: x => x,\n    },\n  }\n\n  constructor(props) {\n    super(props)\n    this.handleClick = this.handleClick.bind(this)\n    this.handleMouseEnter = this.handleMouseEnter.bind(this)\n    this.handleMouseLeave = this.handleMouseLeave.bind(this)\n    this.trackImpression = this.trackImpression.bind(this)\n  }\n\n  componentDidMount() {\n    if (this.video) {\n      this.video.onended = this.pauseVideo\n    }\n  }\n\n  componentWillUpdate() {\n    if (this.video) {\n      this.video.removeEventListener(\n        \"timeupdate\",\n        this.trackProgress.bind(this)\n      )\n    }\n  }\n\n  componentDidUpdate() {\n    if (this.video) {\n      this.video.addEventListener(\"timeupdate\", this.trackProgress.bind(this))\n      this.video.muted = this.state.isMuted\n    }\n  }\n\n  @trackImpression(() => \"panel\")\n  trackImpression() {\n    // noop\n  }\n\n  // TODO: This could be shared with <CanvasVideo />\n  trackProgress() {\n    const secondsComplete = Math.floor(this.video.currentTime)\n    const percentComplete = Math.floor(\n      this.video.currentTime / this.video.duration * 100\n    )\n    const percentCompleteInterval = Math.floor(percentComplete / 25) * 25\n\n    // Track 25% duration intervals\n    if (percentCompleteInterval > 0) {\n      this.trackDuration(percentCompleteInterval)\n    }\n\n    // Track 3 & 10 seconds\n    if (secondsComplete === 3 || secondsComplete === 10) {\n      this.trackSeconds(secondsComplete)\n    }\n  }\n\n  trackDuration = memoize(percentComplete => {\n    this.props.tracking.trackEvent({\n      action: \"Video duration\",\n      label: \"Display ad video duration\",\n      percent_complete: percentComplete,\n      campaign_name: this.props.campaign.name,\n      unit_layout: \"panel\",\n    })\n  })\n\n  trackSeconds = memoize(secondsComplete => {\n    this.props.tracking.trackEvent({\n      action: \"Video seconds\",\n      label: \"Display ad video seconds\",\n      seconds_complete: secondsComplete,\n      campaign_name: this.props.campaign.name,\n      unit_layout: \"panel\",\n    })\n  })\n\n  isWithinMediaArea(event) {\n    const valid = [\n      \"DisplayPanel__Image\",\n      \"VideoContainer\",\n      \"VideoContainer__VideoCover\",\n      \"VideoContainer__VideoControls\",\n      \"VideoContainer__video\",\n      \"PlayButton\",\n      \"PlayButton__PlayButtonCaret\",\n    ]\n    const withinMediaArea = valid.some(className =>\n      event.target.className.includes(className)\n    )\n    return withinMediaArea\n  }\n\n  handleClick(event) {\n    event.preventDefault()\n    const { showCoverImage: alreadyClicked } = this.state\n    const { campaign, isMobile, tracking, unit } = this.props\n    const url = get(unit, \"link.url\", false)\n    const isVideo = this.isVideo()\n\n    const openUrl = () => {\n      tracking.trackEvent({\n        action: \"Click\",\n        label: \"Display ad clickthrough\",\n        entity_type: \"display_ad\",\n        campaign_name: campaign.name,\n        unit_layout: \"panel\",\n      })\n\n      if (url)\n        window.open(\n          replaceWithCacheBuster(url, getCurrentUnixTimestamp()),\n          \"_blank\"\n        )\n    }\n\n    if (isMobile) {\n      if (isVideo) {\n        if (this.isWithinMediaArea(event)) {\n          this.trackVideoClick()\n          this.toggleVideo()\n        } else {\n          openUrl()\n        }\n        // Image\n      } else {\n        if (this.isWithinMediaArea(event)) {\n          if (alreadyClicked) {\n            openUrl()\n            this.toggleCoverImage()\n          } else {\n            this.toggleCoverImage()\n          }\n          // Clicked outside of the media area\n        } else {\n          openUrl()\n        }\n      }\n      // Desktop\n    } else {\n      if (isVideo) {\n        this.pauseVideo()\n      }\n      openUrl()\n    }\n  }\n\n  /**\n   * Handle MouseEnter, on desktop\n   */\n  handleMouseEnter() {\n    if (this.props.isMobile) {\n      return false\n    } else {\n      if (this.isVideo()) {\n        this.playVideo()\n\n        this.props.tracking.trackEvent({\n          action: \"MouseEnter\",\n          label: \"Display ad play video\",\n          entity_type: \"display_ad\",\n          campaign_name: this.props.campaign.name,\n          unit_layout: \"panel\",\n        })\n      } else {\n        this.toggleCoverImage()\n      }\n    }\n  }\n\n  /**\n   * Handle MouseLeave, on desktop\n   */\n  handleMouseLeave() {\n    if (this.props.isMobile) {\n      return false\n    } else {\n      if (this.isVideo()) {\n        this.pauseVideo()\n      } else {\n        this.toggleCoverImage()\n      }\n    }\n  }\n\n  toggleCoverImage() {\n    if (this.props.unit.logo) {\n      const showCoverImage = !this.state.showCoverImage\n      this.setState({\n        showCoverImage,\n      })\n    }\n  }\n\n  toggleVideo() {\n    if (this.state.isPlaying) {\n      this.pauseVideo()\n    } else {\n      this.playVideo()\n    }\n  }\n\n  pauseVideo() {\n    if (this.video) {\n      this.video.pause()\n\n      this.setState({\n        isPlaying: false,\n      })\n    }\n  }\n\n  playVideo() {\n    if (this.video) {\n      this.video.play()\n\n      this.setState({\n        isPlaying: true,\n      })\n    }\n  }\n\n  /**\n   * Handle clicks to Video player\n   */\n  trackVideoClick() {\n    this.props.tracking.trackEvent({\n      action: \"Click\",\n      label: \"Display ad play video\",\n      entity_type: \"display_ad\",\n      campaign_name: this.props.campaign.name,\n      unit_layout: \"panel\",\n    })\n  }\n\n  isVideo() {\n    const assetUrl = get(this.props.unit, \"assets.0.url\", \"\")\n    const isVideo = assetUrl.includes(\"mp4\")\n    return isVideo\n  }\n\n  toggleMuted = e => {\n    e.stopPropagation()\n    this.setState({ isMuted: !this.state.isMuted })\n  }\n\n  renderVideoIcon() {\n    const { isPlaying, isMuted } = this.state\n    const { isMobile } = this.props\n\n    if (isMobile) {\n      return null\n    } else if (isPlaying && isMuted) {\n      return (\n        <MutedIcon onClick={this.toggleMuted}>\n          <svg width=\"30\" height=\"30\" xmlns=\"http://www.w3.org/2000/svg\">\n            <g fill=\"#FFF\">\n              <path d=\"M29.514 28L19.13 17.614 9.557 8.043 1.514 0 0 1.514l6.529 6.529H.757V21.47H11.83l7.3 7.286v-8.114L28 29.514zM19.129.757l-7.3 7.286 7.3 7.3z\" />\n            </g>\n          </svg>\n        </MutedIcon>\n      )\n    } else if (isPlaying && !isMuted) {\n      return (\n        <UnmutedIcon onClick={this.toggleMuted}>\n          <svg width=\"30\" height=\"30\" xmlns=\"http://www.w3.org/2000/svg\">\n            <g fill=\"#FFF\">\n              <path d=\"M18 12.864V0l-7.152 7.286H0v13.428h10.848L18 28V12.864z\" />\n            </g>\n          </svg>\n        </UnmutedIcon>\n      )\n    } else {\n      return <VideoPlayIcon />\n    }\n  }\n\n  renderVideo(url) {\n    const { isPlaying } = this.state\n    const { isMobile } = this.props\n\n    return (\n      <VideoContainer className=\"VideoContainer\">\n        {!isPlaying && (\n          <VideoCover className=\"VideoContainer__VideoCover\">\n            {isMobile && (\n              <VideoControls mini className=\"VideoContainer__VideoControls\" />\n            )}\n          </VideoCover>\n        )}\n\n        <video\n          playsInline\n          src={url}\n          className=\"VideoContainer__video\"\n          controls={false}\n          ref={video => (this.video = video)}\n        />\n        {this.renderVideoIcon()}\n      </VideoContainer>\n    )\n  }\n\n  render() {\n    const { showCoverImage } = this.state\n    const { unit, campaign, isMobile, renderTime } = this.props\n    const url = get(unit.assets, \"0.url\", \"\")\n    const isVideo = this.isVideo()\n    const cover = unit.cover_image_url || \"\"\n    const imageUrl = crop(url, { width: 680, height: 284, isDisplayAd: true })\n    const hoverImageUrl = resize(unit.logo, { width: 680, isDisplayAd: true })\n    const coverUrl = crop(cover, { width: 680, height: 284, isDisplayAd: true })\n\n    return (\n      <ErrorBoundary>\n        <Wrapper\n          onClick={this.handleClick}\n          onMouseEnter={this.handleMouseEnter}\n          onMouseLeave={this.handleMouseLeave}\n        >\n          <Waypoint onEnter={this.trackImpression} />\n          <DisplayPanelContainer\n            className=\"DisplayPanel__DisplayPanelContainer\"\n            imageUrl={imageUrl}\n            isMobile={isMobile}\n            hoverImageUrl={hoverImageUrl}\n            coverUrl={coverUrl}\n            showCoverImage={showCoverImage}\n          >\n            {isVideo ? (\n              this.renderVideo(url)\n            ) : (\n              <Image className=\"DisplayPanel__Image\" />\n            )}\n\n            <div>\n              <Headline>{unit.headline}</Headline>\n\n              <Body\n                dangerouslySetInnerHTML={{\n                  __html: unit.body,\n                }}\n              />\n\n              <SponsoredBy>{`Sponsored by ${campaign.name}`}</SponsoredBy>\n            </div>\n          </DisplayPanelContainer>\n          <PixelTracker unit={unit} date={renderTime} />\n        </Wrapper>\n      </ErrorBoundary>\n    )\n  }\n}\n\nconst Wrapper = styled.div`\n  cursor: pointer;\n  text-decoration: none;\n  color: black;\n  max-width: 360px;\n\n  ${breakpoint.sm`\n    margin: 0 auto;\n  `};\n`\n\nconst Image = styled.div`\n  margin-bottom: 15px;\n  width: 100%;\n  height: 142px;\n  background-color: black;\n  box-sizing: border-box;\n`\n\nconst VideoCover = styled.div`\n  margin-bottom: 15px;\n  width: 100%;\n  height: 142px;\n  background-color: black;\n  box-sizing: border-box;\n  position: absolute;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`\n\nconst DisplayPanelContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  border: 1px solid ${Colors.grayRegular};\n  padding: 20px;\n  max-width: 360px;\n  box-sizing: border-box;\n\n  ${Image} {\n    background: url(${(p: DivUrlProps) => p.imageUrl || \"\"}) no-repeat center\n      center;\n    background-size: cover;\n\n    ${(p: DivUrlProps) =>\n      p.showCoverImage &&\n      p.hoverImageUrl &&\n      `\n        background: black url(${p.hoverImageUrl}) no-repeat center center;\n        background-size: contain;\n        border: 10px solid black;\n    `};\n  }\n\n  ${VideoCover} {\n    background: url(${(p: DivUrlProps) => p.coverUrl || \"\"}) no-repeat center\n      center;\n    background-size: cover;\n\n    ${(p: DivUrlProps) => p.showCoverImage && !p.isMobile && `display: none;`};\n  }\n\n  ${breakpoint.md`\n    margin: auto;\n  `};\n  ${breakpoint.sm`\n    margin: auto;\n  `};\n  ${breakpoint.xs`\n    margin: auto;\n  `};\n`\n\nconst Headline = styled.div`\n  ${unica(\"s16\", \"medium\")};\n  line-height: 1.23em;\n  margin-bottom: 3px;\n`\n\nconst Body = styled.div`\n  ${garamond(\"s17\")};\n  line-height: 1.53em;\n  margin-bottom: 20px;\n  a {\n    color: black;\n  }\n`\n\nconst SponsoredBy = styled.div`\n  ${avantgarde(\"s11\")};\n  color: ${Colors.grayRegular};\n`\n\nconst VideoContainer = styled(Image)`\n  position: relative;\n  overflow: hidden;\n  display: flex;\n  align-items: center;\n  video {\n    object-fit: cover;\n    object-position: 50%;\n    width: 100%;\n    height: 100%;\n  }\n`\n\nconst iconPositioning = side => `\n  position: absolute;\n  bottom: 13px;\n  ${side}: 15px;\n`\n\nconst VideoPlayIcon = styled.div`\n  color: white;\n  border-top: 13px solid transparent;\n  border-bottom: 13px solid transparent;\n  border-left: 20px solid white;\n  ${iconPositioning(\"left\")};\n`\n\nconst MutedIcon = styled.div`\n  ${iconPositioning(\"right\")};\n`\n\nconst UnmutedIcon = styled.div`\n  z-index: 3;\n  ${iconPositioning(\"right\")};\n  right: 14px;\n  bottom: 12px;\n`\n\n// Set names for tests and DOM\nDisplayPanelContainer.displayName = \"DisplayPanelContainer\"\nImage.displayName = \"Image\"\nVideoContainer.displayName = \"VideoContainer\"\nVideoCover.displayName = \"VideoCover\"\nWrapper.displayName = \"Wrapper\"\n"]}]}